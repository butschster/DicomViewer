!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){var a;window,a=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(!w[e]||!x[e])return;for(var n in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--p&&0===b&&_()}(e,n),t&&t(e,n)};var n,a=!0,r="ec8cddb1b6a946adfb56",o=1e4,i={},s=[],l=[];function u(e){var t=M[e];if(!t)return O;var a=function(a){return t.hot.active?(M[a]?-1===M[a].parents.indexOf(e)&&M[a].parents.push(e):(s=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),s=[]),O(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return O[e]},set:function(t){O[e]=t}}};for(var o in O)Object.prototype.hasOwnProperty.call(O,o)&&"e"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===f&&h("prepare"),b++,O.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===f&&(y[e]||C(e),0===b&&0===p&&_())}},a}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:j,apply:E,status:function(e){if(!e)return f;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:i[e]};return n=void 0,t}var d=[],f="idle";function h(e){f=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var g,m,v,p=0,b=0,y={},x={},w={};function T(e){return+e+""===e?+e:e}function j(e){if("idle"!==f)throw new Error("check() is only allowed in idle status");return a=e,h("check"),(t=o,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=O.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(e){return n(e)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return h("idle"),null;x={},y={},w=e.c,v=e.h,h("prepare");var t=new Promise(function(e,t){g={resolve:e,reject:t}});m={};return C("cornerstoneTools"),"prepare"===f&&0===b&&0===p&&_(),t});var t}function C(e){w[e]?(x[e]=!0,p++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=O.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):y[e]=!0}function _(){h("ready");var e=g;if(g=null,e)if(a)Promise.resolve().then(function(){return E(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(T(n));e.resolve(t)}}function E(t){if("ready"!==f)throw new Error("apply() is only allowed in ready status");var n,a,o,l,u;function c(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=M[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],c=M[u];if(c){if(c.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(c.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),d(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var g={},p=[],b={},y=function(){console.warn("[HMR] unexpected require("+j.moduleId+") to disposed module")};for(var x in m)if(Object.prototype.hasOwnProperty.call(m,x)){var j;u=T(x);var C=!1,_=!1,E=!1,I="";switch((j=m[x]?c(u):{type:"disposed",moduleId:x}).chain&&(I="\nUpdate propagation: "+j.chain.join(" -> ")),j.type){case"self-declined":t.onDeclined&&t.onDeclined(j),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+j.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(j),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+j.moduleId+" in "+j.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(j),t.ignoreUnaccepted||(C=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(j),_=!0;break;case"disposed":t.onDisposed&&t.onDisposed(j),E=!0;break;default:throw new Error("Unexception type "+j.type)}if(C)return h("abort"),Promise.reject(C);if(_)for(u in b[u]=m[u],d(p,j.outdatedModules),j.outdatedDependencies)Object.prototype.hasOwnProperty.call(j.outdatedDependencies,u)&&(g[u]||(g[u]=[]),d(g[u],j.outdatedDependencies[u]));E&&(d(p,[j.moduleId]),b[u]=y)}var S,P=[];for(a=0;a<p.length;a++)u=p[a],M[u]&&M[u].hot._selfAccepted&&P.push({module:u,errorHandler:M[u].hot._selfAccepted});h("dispose"),Object.keys(w).forEach(function(e){!1===w[e]&&function(e){delete installedChunks[e]}(e)});for(var k,L,D=p.slice();D.length>0;)if(u=D.pop(),l=M[u]){var A={},R=l.hot._disposeHandlers;for(o=0;o<R.length;o++)(n=R[o])(A);for(i[u]=A,l.hot.active=!1,delete M[u],delete g[u],o=0;o<l.children.length;o++){var H=M[l.children[o]];H&&((S=H.parents.indexOf(u))>=0&&H.parents.splice(S,1))}}for(u in g)if(Object.prototype.hasOwnProperty.call(g,u)&&(l=M[u]))for(L=g[u],o=0;o<L.length;o++)k=L[o],(S=l.children.indexOf(k))>=0&&l.children.splice(S,1);for(u in h("apply"),r=v,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in g)if(Object.prototype.hasOwnProperty.call(g,u)&&(l=M[u])){L=g[u];var U=[];for(a=0;a<L.length;a++)if(k=L[a],n=l.hot._acceptedDependencies[k]){if(-1!==U.indexOf(n))continue;U.push(n)}for(a=0;a<U.length;a++){n=U[a];try{n(L)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:L[a],error:e}),t.ignoreErrored||B||(B=e)}}}for(a=0;a<P.length;a++){var N=P[a];u=N.module,s=[u];try{O(u)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||B||(B=n),B||(B=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||B||(B=e)}}return B?(h("fail"),Promise.reject(B)):(h("idle"),new Promise(function(e){e(p)}))}var M={};function O(t){if(M[t])return M[t].exports;var n=M[t]={i:t,l:!1,exports:{},hot:c(t),parents:(l=s,s=[],l),children:[]};return e[t].call(n.exports,n,n.exports,u(t)),n.l=!0,n.exports}return O.m=e,O.c=M,O.d=function(e,t,n){O.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},O.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},O.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return O.d(t,"a",t),t},O.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},O.p="",O.h=function(){return r},u("./index.js")(O.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,r)}e.exports=function(e){return function(){var t=this,a=arguments;return new Promise(function(r,o){var i=e.apply(t,a);function s(e){n(i,r,o,s,l,"next",e)}function l(e){n(i,r,o,s,l,"throw",e)}s(void 0)})}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?r(e):t}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),r=n("../node_modules/@babel/runtime/helpers/iterableToArray.js"),o=n("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return a(e)||r(e)||o()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=a=function(e){return n(e)}:e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(t)}e.exports=a},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/debug/src/browser.js":function(e,t,n){(function(a){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let a=0,r=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(a++,"%c"===e&&(r=a))}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==a&&"env"in a&&(e=a.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n("../node_modules/debug/src/common.js")(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("../node_modules/process/browser.js"))},"../node_modules/debug/src/common.js":function(e,t,n){e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return a.colors[Math.abs(t)%a.colors.length]}function a(e){let n;function i(...e){if(!i.enabled)return;const t=i,r=Number(new Date),o=r-(n||r);t.diff=o,t.prev=n,t.curr=r,n=r,e[0]=a.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return n;s++;const o=a.formatters[r];if("function"==typeof o){const a=e[s];n=o.call(t,a),e.splice(s,1),s--}return n}),a.formatArgs.call(t,e),(t.log||a.log).apply(t,e)}return i.namespace=e,i.enabled=a.enabled(e),i.useColors=a.useColors(),i.color=t(e),i.destroy=r,i.extend=o,"function"==typeof a.init&&a.init(i),a.instances.push(i),i}function r(){const e=a.instances.indexOf(this);return-1!==e&&(a.instances.splice(e,1),!0)}function o(e,t){const n=a(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){const e=[...a.names.map(i),...a.skips.map(i).map(e=>"-"+e)].join(",");return a.enable(""),e},a.enable=function(e){let t;a.save(e),a.names=[],a.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.substr(1)+"$")):a.names.push(new RegExp("^"+e+"$")));for(t=0;t<a.instances.length;t++){const e=a.instances[t];e.enabled=a.enabled(e.namespace)}},a.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=n("../node_modules/ms/index.js"),Object.keys(e).forEach(t=>{a[t]=e[t]}),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=t,a.enable(a.load()),a}},"../node_modules/ms/index.js":function(e,t){var n=1e3,a=60*n,r=60*a,o=24*r,i=7*o,s=365.25*o;function l(e,t,n,a){var r=t>=1.5*n;return Math.round(e/n)+" "+a+(r?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var l=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*s;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*a;case"seconds":case"second":case"secs":case"sec":case"s":return l*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return l(e,t,o,"day");if(t>=r)return l(e,t,r,"hour");if(t>=a)return l(e,t,a,"minute");if(t>=n)return l(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=r)return Math.round(e/r)+"h";if(t>=a)return Math.round(e/a)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,a,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l,u=[],c=!1,d=-1;function f(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&h())}function h(){if(!c){var e=s(f);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||c||s(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var a=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,o=r&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n("../node_modules/regenerator-runtime/runtime.js"),r)a.regeneratorRuntime=o;else try{delete a.regeneratorRuntime}catch(e){a.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){"use strict";var n,a=Object.prototype,r=a.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u="object"==typeof e,c=t.regeneratorRuntime;if(c)u&&(e.exports=c);else{(c=t.regeneratorRuntime=u?e.exports:{}).wrap=x;var d="suspendedStart",f="suspendedYield",h="executing",g="completed",m={},v={};v[i]=function(){return this};var p=Object.getPrototypeOf,b=p&&p(p(P([])));b&&b!==a&&r.call(b,i)&&(v=b);var y=C.prototype=T.prototype=Object.create(v);j.prototype=y.constructor=C,C.constructor=j,C[l]=j.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===j||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(y),e},c.awrap=function(e){return{__await:e}},_(E.prototype),E.prototype[s]=function(){return this},c.AsyncIterator=E,c.async=function(e,t,n,a){var r=new E(x(e,t,n,a));return c.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},_(y),y[l]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},c.values=P,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:P(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),m}}}function x(e,t,n,a){var r=t&&t.prototype instanceof T?t:T,o=Object.create(r.prototype),i=new S(a||[]);return o._invoke=function(e,t,n){var a=d;return function(r,o){if(a===h)throw new Error("Generator is already running");if(a===g){if("throw"===r)throw o;return k()}for(n.method=r,n.arg=o;;){var i=n.delegate;if(i){var s=M(i,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var l=w(e,t,n);if("normal"===l.type){if(a=n.done?g:f,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=g,n.method="throw",n.arg=l.arg)}}}(e,n,i),o}function w(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function T(){}function j(){}function C(){}function _(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function E(e){var t;this._invoke=function(n,a){function o(){return new Promise(function(t,o){!function t(n,a,o,i){var s=w(e[n],e,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,i)},function(e){t("throw",e,o,i)}):Promise.resolve(u).then(function(e){l.value=e,o(l)},function(e){return t("throw",e,o,i)})}i(s.arg)}(n,a,t,o)})}return t=t?t.then(o,o):o()}}function M(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,M(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=w(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:k}}function k(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/drawLine.js"),r=n("./drawing/drawJoinedLines.js");t.default=function(e,t,n,o,i){var s=Math.atan2(n.y-t.y,n.x-t.x),l={color:o,lineWidth:i};Object(a.default)(e,void 0,t,n,l,"canvas"),l={color:o,lineWidth:i,fillStyle:o};var u=[{x:n.x-10*Math.cos(s-Math.PI/7),y:n.y-10*Math.sin(s-Math.PI/7)},{x:n.x-10*Math.cos(s+Math.PI/7),y:n.y-10*Math.sin(s+Math.PI/7)},n];Object(r.default)(e,void 0,n,u,l,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){"pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")&&(n=a.default.cornerstone.pixelToCanvas(t,n)),Object(r.default)(e,i,function(e){e.arc(n.x,n.y,o,0,2*Math.PI)})}},"./drawing/drawEllipse.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){"pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=a.default.cornerstone.pixelToCanvas(t,o));var s=Math.min(n.x,o.x),l=Math.min(n.y,o.y),u=Math.abs(n.x-o.x),c=Math.abs(n.y-o.y),d=u/2*.5522848,f=c/2*.5522848,h=s+u,g=l+c,m=s+u/2,v=l+c/2;Object(r.default)(e,i,function(e){e.moveTo(s,v),e.bezierCurveTo(s,v-f,m-d,l,m,l),e.bezierCurveTo(m+d,l,h,v-f,h,v),e.bezierCurveTo(h,v+f,m+d,g,m,g),e.bezierCurveTo(m-d,g,s,v+f,s,v),e.closePath()})}},"./drawing/drawHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolStyle.js"),o=n("./stateManagement/toolColors.js"),i=n("./drawing/path.js"),s=n("./store/index.js");t.default=function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.element,c=o.default.getToolColor();e.strokeStyle=l.color||c;for(var d=Object.keys(n),f=function(t){var o=d[t],c=n[o];if(!0===c.drawnIndependently)return"continue";if(!0===l.drawHandlesIfActive&&!c.active)return"continue";var f=c.active?r.default.getActiveWidth():r.default.getToolWidth(),h=l.fill;Object(i.default)(e,{lineWidth:f,fillStyle:h},function(e){var t=a.default.cornerstone.pixelToCanvas(u,c),n=c.radius||l.handleRadius||s.state.handleRadius;e.arc(t.x,t.y,n,0,2*Math.PI)})},h=0;h<d.length;h++)f(h)}},"./drawing/drawJoinedLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=o.map(function(e){return a.default.cornerstone.pixelToCanvas(t,e)})),e.moveTo(n.x,n.y),o.forEach(function(t){var n=t.x,a=t.y;e.lineTo(n,a)})})}},"./drawing/drawLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./externalModules.js"),r=n("./drawing/path.js");function o(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=a.default.cornerstone.pixelToCanvas(t,o)),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y)})}},"./drawing/drawLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(r.default)(e,o,function(e){n.forEach(function(n){var r=n.start,o=n.end;if("pixel"===i){var s=a.default.cornerstone;r=s.pixelToCanvas(t,r),o=s.pixelToCanvas(t,o)}e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)})})}},"./drawing/drawLink.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawLine.js");t.default=function(e,t,n,o,i,s){var l=e.length>0?a.default.cornerstoneMath.point.findClosestPoint(e,t):t,u=[{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],c=a.default.cornerstoneMath.point.findClosestPoint(u,l),d={color:i,lineWidth:s,lineDash:[2,3]};Object(r.default)(o,void 0,l,c,d,"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawTextBox.js"),o=n("./drawing/drawLink.js");t.default=function(e,t,n,i,s,l,u,c,d,f){var h=a.default.cornerstone,g=h.pixelToCanvas(t,n);d&&(g.x+=d);var m={centering:{x:!1,y:f}};if(n.boundingBox=Object(r.default)(e,i,g.x,g.y,u,m),n.hasMoved){var v=l(s).map(function(e){return h.pixelToCanvas(t,e)});Object(o.default)(v,g,n.boundingBox,e,u,c)}}},"./drawing/drawRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){if("pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")){var s=a.default.cornerstone;n=s.pixelToCanvas(t,n),o=s.pixelToCanvas(t,o)}var l=Math.min(n.x,o.x),u=Math.min(n.y,o.y),c=Math.abs(n.x-o.x),d=Math.abs(n.y-o.y);Object(r.default)(e,i,function(e){e.rect(l,u,c,d)})}},"./drawing/drawTextBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"textBoxWidth",function(){return s});var a=n("./stateManagement/textStyle.js"),r=n("./drawing/draw.js"),o=n("./drawing/fillTextLines.js"),i=n("./drawing/fillBox.js");function s(e,t,n){var r=a.default.getFont(),o=e.font;r&&r!==o&&(e.font=r);var i=e.measureText(t).width;return r&&r!==o&&(e.font=o),i+2*n}t.default=function(e,t,n,l,u,c){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var d=a.default.getFontSize(),f=a.default.getBackgroundColor(),h=0;t.forEach(function(t){var n=s(e,t,5);h=Math.max(h,n)});var g={width:h,height:5+t.length*(d+5)};return Object(r.default)(e,function(e){e.strokeStyle=u,c&&c.centering&&!0===c.centering.x&&(n-=g.width/2),c&&c.centering&&!0===c.centering.y&&(l-=g.height/2),g.left=n,g.top=l;var a=c&&!0===c.debug?"#FF0000":f;Object(i.default)(e,g,a),Object(o.default)(e,g,t,u,5)}),g}},"./drawing/fillBox.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){if("pixel"===(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel")){var s=a.default.cornerstone;n=s.pixelToCanvas(t,n),o=s.pixelToCanvas(t,o)}var l=Math.min(n.x,o.x),u=Math.min(n.y,o.y),c=Math.abs(n.x-o.x),d=Math.abs(n.y-o.y);Object(r.default)(e,i,function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(l+c,u,-c,d)})}},"./drawing/fillTextLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/textStyle.js");t.default=function(e,t,n,r,o){var i=a.default.getFontSize();e.font=a.default.getFont(),e.textBaseline="top",e.fillStyle=r,n.forEach(function(n,a){e.fillText(n,t.left+o,t.top+o+a*(i+o))})}},"./drawing/getNewContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t}},"./drawing/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/draw.js");n.d(t,"draw",function(){return a.default});var r=n("./drawing/drawArrow.js");n.d(t,"drawArrow",function(){return r.default});var o=n("./drawing/drawCircle.js");n.d(t,"drawCircle",function(){return o.default});var i=n("./drawing/drawEllipse.js");n.d(t,"drawEllipse",function(){return i.default});var s=n("./drawing/drawHandles.js");n.d(t,"drawHandles",function(){return s.default});var l=n("./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",function(){return l.default});var u=n("./drawing/drawLine.js");n.d(t,"drawLine",function(){return u.default});var c=n("./drawing/drawLines.js");n.d(t,"drawLines",function(){return c.default});var d=n("./drawing/drawLink.js");n.d(t,"drawLink",function(){return d.default});var f=n("./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",function(){return f.default});var h=n("./drawing/drawRect.js");n.d(t,"drawRect",function(){return h.default});var g=n("./drawing/drawTextBox.js");n.d(t,"drawTextBox",function(){return g.default});var m=n("./drawing/fillBox.js");n.d(t,"fillBox",function(){return m.default});var v=n("./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",function(){return v.default});var p=n("./drawing/fillTextLines.js");n.d(t,"fillTextLines",function(){return p.default});var b=n("./drawing/getNewContext.js");n.d(t,"getNewContext",function(){return b.default});var y=n("./drawing/path.js");n.d(t,"path",function(){return y.default});var x=n("./drawing/setShadow.js");n.d(t,"setShadow",function(){return x.default});var w=n("./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",function(){return w.default});var T=n("./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",function(){return T.default})},"./drawing/path.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.color,o=t.lineWidth,i=t.fillStyle,s=t.lineDash;e.beginPath(),e.strokeStyle=r||e.strokeStyle,e.lineWidth=o||void 0===o&&a.default.getToolWidth()||e.lineWidth,s&&e.setLineDash(s),n(e),i&&(e.fillStyle=i,e.fill()),e.stroke(),s&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(a.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(a.default)(t.shadowBlur,0),e.shadowOffsetX=Object(a.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(a.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){if(n.vflip||n.vflip||n.rotation){var a={x:t.width/2+n.translation.x*n.scale,y:t.height/2+n.translation.y*n.scale};e.translate(a.x,a.y),n.rotation&&e.rotate(n.rotation*Math.PI/180),n.vflip&&e.scale(1,-1),n.hflip&&e.scale(-1,1),e.translate(-a.x,-a.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./tools/base/BaseBrushTool.js"),o=n("./eventListeners/onImageRenderedBrushEventHandler.js"),i=n("./externalModules.js"),s=function(e){var t=e.detail.element,n=a.state.tools.filter(function(e){return e.element===t&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});n.filter(function(e){return e instanceof r.default}).length>0&&Object(o.default)(e),n.forEach(function(t){t.renderToolData&&t.renderToolData(e)})};t.default={enable:function(e){e.addEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,s)},disable:function(e){e.removeEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,s)}}},"./eventDispatchers/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",function(){return a.default});var r=n("./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",function(){return r.default});var o=n("./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",function(){return o.default});var i=n("./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",function(){return i.default})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./manipulators/index.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){s.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,i=n.element,l=t.createNewMeasurement(n);l&&(Object(r.addToolState)(i,t.name,l),a.default.cornerstone.updateImage(i),(1===Object.keys(l.handles).length?o.moveHandle:o.moveNewHandle)(n,t.name,l,l.handles.end,t.options,"mouse"))}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"mouseClick",function(){return l}),n.d(t,"mouseDoubleClick",function(){return u}),n.d(t,"mouseUp",function(){return c}),n.d(t,"mouseWheel",function(){return d});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",function(){return r.default});var o=n("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",function(){return o.default});var i=n("./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",function(){return i.default});var s=n("./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",function(){return s.default});var l=a.default.bind(null,"Mouse","mouseClickCallback"),u=a.default.bind(null,"Mouse","doubleClickCallback"),c=a.default.bind(null,"Mouse","mouseUpCallback"),d=a.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./util/findAndMoveHelpers.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=e.detail.element,c=e.detail.currentPoints.canvas,d=Object(s.default)(n,a.getters.mouseTools()),f=d.filter(function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preMouseDownCallback});if(h)if(h.preMouseDownCallback(e))return}if(!a.state.isMultiPartToolActive){var g=Object(l.default)(n,d),m=Object(o.default)(n,g,c,"mouse");if(m.length>0){var v=m[0],p=Object(r.getToolState)(n,v.name),b=Object(i.findHandleDataNearImagePoint)(n,p,v.name,c),y=b.handle,x=b.data;v.handleSelectedCallback(e,x,y,"mouse")}else{var w=d.filter(function(e){var t=Object(r.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,c,"mouse")})});if(w.length>0){var T=w[0],j=Object(r.getToolState)(n,T.name).data.find(function(e){return T.pointNearTool(n,e,c)});T.toolSelectedCallback(e,j,"mouse")}else if(f.length>0){var C=f.find(function(e){return"function"==typeof e.postMouseDownCallback});if(C)if(C.postMouseDownCallback(e))return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),r=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),i=n("./tools/base/BaseAnnotationTool.js"),s=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!r.state.isToolLocked){var t=e.detail,n=t.element,l=Object(o.default)(n,r.getters.mouseTools());if(l=l.filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive}),r.state.isMultiPartToolActive&&(l=Object(s.default)(l)),0!==l.length){var u=l[0];if("function"==typeof u.preMouseDownActivateCallback)if(u.preMouseDownActivateCallback(e))return;r.state.isMultiPartToolActive||(u.addNewMeasurement?u.addNewMeasurement(e,"mouse"):u instanceof i.default&&Object(a.default)(e,u))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t,n=e.detail,i=n.element;if(t=(t=(t=Object(r.default)(i,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive})).filter(function(e){return"function"==typeof e.mouseDragCallback}),a.state.isMultiPartToolActive&&(t=Object(o.default)(t)),0!==t.length)t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/getInteractiveToolsForElement.js"),i=n("./store/getToolsWithDataForElement.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var t,n=e.detail,s=n.element,l=n.currentPoints;r.state.mousePositionImage=l.image;var u=(t=Object(o.default)(s,r.getters.mouseTools())).filter(function(e){return"active"===e.mode&&e.options.isMouseActive}),c=!1;u.length>0&&(c=u.some(function(e){return e.updateOnMouseMove})),t=Object(i.default)(s,t);for(var d=0;d<t.length;d++){var f=t[d];"function"==typeof f.mouseMoveCallback&&(c=f.mouseMoveCallback(e)||c)}!0===c&&a.default.cornerstone.updateImage(s)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/mouseEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.addEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.addEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.addEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.addEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.addEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.addEventListener(a.default.MOUSE_UP,r.mouseUp),e.addEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)},disable:function(e){e.removeEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.removeEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.removeEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.removeEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.removeEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.removeEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.removeEventListener(a.default.MOUSE_UP,r.mouseUp),e.removeEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)}}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./tools/base/BaseBrushTool.js"),o=n("./eventListeners/onNewImageBrushEventHandler.js"),i=n("./externalModules.js"),s=function(e){if(a.state.isToolLocked)return!1;var t=e.detail.element,n=a.state.tools.filter(function(e){return e.element===t&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});if(0===n.length)return!1;n.forEach(function(t){t.newImageCallback&&t.newImageCallback(e)}),n.filter(function(e){return e instanceof r.default}).length>0&&Object(o.default)(e)};t.default={enable:function(e){e.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,s)},disable:function(e){e.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,s)}}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(a.state.isToolLocked)return!1;var i=n.detail.element,s=a.state.tools.filter(function(t){return t.supportedInteractionTypes.includes(e)});if(s=(s=Object(r.default)(i,s,e)).filter(function(e){return"function"==typeof e[t]}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./store/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./manipulators/index.js"),l=n("./stateManagement/toolState.js"),u=n("./util/logger.js"),c=Object(u.getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){c.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,u=n.element,d=t.createNewMeasurement(n);if(d){if(Object(l.addToolState)(u,t.name,d),1===Object.keys(d.handles).length&&n.type===a.default.TAP)return d.active=!1,d.handles.end.active=!1,d.handles.end.highlight=!1,d.invalidated=!0,(o.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(i.default)(n,d.handles)&&Object(l.removeToolState)(u,t.name,d),void r.default.cornerstone.updateImage(u);r.default.cornerstone.updateImage(u),Object(s.moveNewHandle)(n,t.name,d,d.handles.end,t.options,"touch")}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"doubleTap",function(){return l}),n.d(t,"touchDrag",function(){return u}),n.d(t,"touchEnd",function(){return c}),n.d(t,"touchPinch",function(){return d}),n.d(t,"touchPress",function(){return f}),n.d(t,"touchRotate",function(){return h});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",function(){return r.default});var o=n("./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",function(){return o.default});var i=n("./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",function(){return i.default});var s=n("./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",function(){return s.default});var l=a.default.bind(null,"DoubleTap","doubleTapCallback"),u=a.default.bind(null,"Touch","touchDragCallback"),c=a.default.bind(null,"Touch","touchEndCallback"),d=a.default.bind(null,"TouchPinch","touchPinchCallback"),f=a.default.bind(null,"Touch","touchPressCallback"),h=a.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(a.state.isToolLocked)return!1;var t=e.detail,n=t.element,i=t.numPointers,s=a.state.tools.filter(function(e){return e.supportedInteractionTypes.includes("MultiTouch")});if(s=(s=Object(r.default)(n,s,"MultiTouch")).filter(function(e){return"function"==typeof e.multiTouchDragCallback&&i===e.configuration.touchPointers}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){"use strict";function a(e){Object.keys(e).forEach(function(t){e[t].active=!1})}n.r(t),t.default=function(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&a(n.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./eventDispatchers/touchEventHandlers/touchStartActive.js"),o=n("./store/index.js"),i=n("./store/getActiveToolsForElement.js"),s=n("./store/getToolsWithDataForElement.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),d=n("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail.element,f=e.detail.currentPoints.canvas;t=Object(i.default)(n,o.getters.touchTools());var h=(t=Object(s.default)(n,t)).filter(function(e){for(var t=Object(l.getToolState)(n,e.name),a=0;a<t.data.length;a++)if(void 0!==Object(u.default)(n,t.data[a].handles,f,28))return!0;return!1});if(h.length>0){var g=h[0],m=Object(l.getToolState)(n,g.name),v=m.data.find(function(e){return void 0!==Object(u.default)(n,e.handles,f,28)});m.data.active=!0,v.active=!0,a.default.cornerstone.updateImage(n);var p=Object.assign({},{doneMovingCallback:function(){Object(d.default)(m)}},g.options);return Object(c.moveHandle)(e.detail,g.name,m.data,v,p,"touch"),e.stopImmediatePropagation(),void e.preventDefault()}var b=t.filter(function(e){var t=Object(l.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,f)})});if(b.length>0){var y=b[0],x=Object(l.getToolState)(n,y.name),w=x.data.find(function(e){return y.pointNearTool(n,e,f)});w.active=!0,a.default.cornerstone.updateImage(n);var T=Object.assign({},{doneMovingCallback:function(){Object(d.default)(x)}},y.options);return Object(c.moveAllHandles)(e.detail,y.name,w,null,T,"touch"),e.stopImmediatePropagation(),void e.preventDefault()}var j=Object(i.default)(n,o.getters.touchTools());return j.length>0&&j[0].touchStartActiveCallback?j[0].touchStartActiveCallback(e):Object(r.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/findAndMoveHelpers.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./stateManagement/toolState.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=t.element,c=t.startPoints.canvas,d=Object(s.default)(n,a.getters.touchTools()),f=d.filter(function(e){return"active"===e.mode&&e.options.isTouchActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preTouchStartCallback});if(h)if(h.preTouchStartCallback(e))return}if(!a.state.isMultiPartToolActive){var g=Object(l.default)(n,d),m=Object(o.default)(n,g,c,"touch");if(m.length>0){var v=m[0],p=Object(i.getToolState)(n,v.name),b=Object(r.findHandleDataNearImagePoint)(n,p,v.name,c,"touch"),y=b.handle,x=b.data;v.handleSelectedCallback(e,x,y,"touch")}else{var w=g.filter(function(e){var t=Object(i.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,c,"touch")})});if(w.length>0){var T=w[0],j=Object(i.getToolState)(n,T.name).data.find(function(e){return T.pointNearTool(n,e,c)});T.toolSelectedCallback(e,j,"touch")}else if(f.length>0){var C=f.find(function(e){return"function"==typeof e.postTouchStartCallback});if(C)if(C.postTouchStartCallback(e))return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),i=n("./tools/base/BaseAnnotationTool.js");t.default=function(e){if(!a.state.isToolLocked&&!a.state.isMultiPartToolActive){var t=e.detail.element,n=Object(r.default)(t,a.getters.touchTools());if(0!==(n=n.filter(function(e){return e.options.isTouchActive})).length){var s=n[0];s&&s.addNewMeasurement?s.addNewMeasurement(e,"touch"):s instanceof i.default&&Object(o.default)(e,s)}}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/touchEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.TAP,r.tap),e.addEventListener(a.default.TOUCH_START,r.touchStart,{passive:!1}),e.addEventListener(a.default.TOUCH_DRAG,r.touchDrag,{passive:!1}),e.addEventListener(a.default.TOUCH_END,r.touchEnd),e.addEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.addEventListener(a.default.TOUCH_PRESS,r.touchPress),e.addEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.addEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.addEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.addEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)},disable:function(e){e.removeEventListener(a.default.TAP,r.tap),e.removeEventListener(a.default.TOUCH_START,r.touchStart),e.removeEventListener(a.default.TOUCH_DRAG,r.touchDrag),e.removeEventListener(a.default.TOUCH_END,r.touchEnd),e.removeEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.removeEventListener(a.default.TOUCH_PRESS,r.touchPress),e.removeEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.removeEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.removeEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.removeEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)}}},"./eventListeners/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",function(){return a.default});var r=n("./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",function(){return r.default});var o=n("./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",function(){return o.default})},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){"use strict";n.r(t);t.default=function(e){var t=0,n=0,a=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),a=10*t,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||r)&&e.deltaMode&&(1===e.deltaMode?(a*=40,r*=40):(a*=800,r*=800)),a&&!t&&(t=a<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:r}}},"./eventListeners/mouseEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./events.js"),o=n("./externalModules.js"),i=n("./util/copyPoints.js"),s=n("./util/triggerEvent.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("eventListeners:mouseEventListeners"),c=!0,d=200;function f(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function h(){c=!1}function g(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_DOUBLE_CLICK,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var c=Object(i.default)(l);u.log("double-click: %o",f(e));var d={event:e,buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:c,currentPoints:l,deltaPoints:{x:0,y:0},type:a};Object(s.default)(t,a,d)}}function m(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){a=setTimeout(h,d),t.removeEventListener("mousemove",v);var l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var g=Object(i.default)(l),m={event:e,buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:l,deltaPoints:{x:0,y:0},type:r.default.MOUSE_DOWN};Object(s.default)(m.element,r.default.MOUSE_DOWN,m)&&(m.type=r.default.MOUSE_DOWN_ACTIVATE,Object(s.default)(m.element,r.default.MOUSE_DOWN_ACTIVATE,m)),document.addEventListener("mousemove",p),document.addEventListener("mouseup",function e(i){clearTimeout(a);var d=r.default.MOUSE_UP;c&&(d=r.default.MOUSE_CLICK);var h={page:o.default.cornerstoneMath.point.pageToPoint(i),image:o.default.cornerstone.pageToPixel(t,i.pageX,i.pageY),client:{x:i.clientX,y:i.clientY}};h.canvas=o.default.cornerstone.pixelToCanvas(t,h.image);var m={page:o.default.cornerstoneMath.point.subtract(h.page,g.page),image:o.default.cornerstoneMath.point.subtract(h.image,g.image),client:o.default.cornerstoneMath.point.subtract(h.client,g.client),canvas:o.default.cornerstoneMath.point.subtract(h.canvas,g.canvas)};u.log("mouseup: %o",f(i));var b={event:i,buttons:f(i),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:h,deltaPoints:m,type:d};Object(s.default)(b.element,d,b),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",e),t.addEventListener("mousemove",v),c=!0})}function p(e){var a=r.default.MOUSE_DRAG,c={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};c.canvas=o.default.cornerstone.pixelToCanvas(t,c.image);var d={page:o.default.cornerstoneMath.point.subtract(c.page,g.page),image:o.default.cornerstoneMath.point.subtract(c.image,g.image),client:o.default.cornerstoneMath.point.subtract(c.client,g.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,g.canvas)};u.log("mousemove: %o",f(e));var h={buttons:f(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:g,currentPoints:c,deltaPoints:d,type:a,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(s.default)(h.element,a,h),g=Object(i.default)(c)}}function v(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_MOVE,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var u=Object(i.default)(l),c={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};c.canvas=o.default.cornerstone.pixelToCanvas(t,c.image);var d={page:o.default.cornerstoneMath.point.subtract(c.page,u.page),image:o.default.cornerstoneMath.point.subtract(c.image,u.image),client:o.default.cornerstoneMath.point.subtract(c.client,u.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,u.canvas)},f={viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:u,currentPoints:c,deltaPoints:d,type:a};Object(s.default)(t,a,f),u=Object(i.default)(c)}}function p(e){e.removeEventListener("mousedown",m),e.removeEventListener("mousemove",v),e.removeEventListener("dblclick",g)}t.default={enable:function(e){p(e),e.addEventListener("mousedown",m),e.addEventListener("mousemove",v),e.addEventListener("dblclick",g)},disable:p}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./tools/base/BaseBrushTool.js"),l=n("./drawing/index.js");"createImageBitmap"in window||(window.createImageBitmap=function(e){return new Promise(function(t){var n=document.createElement("img");n.addEventListener("load",function(){t(this)});var a=document.createElement("canvas");a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(e,0,0,0,0,a.width,a.height),n.src=a.toDataURL()})});var u=a.default.modules.brush,c=u.state,d=u.getters,f=u.setters;function h(e,t,n){var o=e.detail.element,i=n.toolData,l=n.visibleSegmentations;return!(!i.data[t]||!i.data[t].pixelData)&&(!!l[t]||c.drawColorId===t&&Object(r.default)(o,a.default.state.tools).filter(function(e){return e instanceof s.default}).length>0)}function g(e,t,n){var a=n.toolData,r=n.imageBitmapCache,o=n.visibleSegmentations;r&&r[t]&&function(e,t,n){var a=e.detail,r=Object(l.getNewContext)(a.canvasContext.canvas),o=i.default.cornerstone.pixelToCanvas(a.element,{x:0,y:0}),s=i.default.cornerstone.pixelToCanvas(a.element,{x:a.image.width,y:0}),u=i.default.cornerstone.pixelToCanvas(a.element,{x:a.image.width,y:a.image.height}),d=i.default.cornerstoneMath.point.distance(o,s),f=i.default.cornerstoneMath.point.distance(s,u),h=a.canvasContext.canvas,g=a.viewport;r.imageSmoothingEnabled=!1,r.globalAlpha=function(e){if(e)return c.alpha;return c.hiddenButActiveAlpha}(n),Object(l.transformCanvasContext)(r,h,g);var m={x:g.translation.x*g.scale,y:g.translation.y*g.scale};r.drawImage(t,h.width/2-d/2+m.x,h.height/2-f/2+m.y,d,f),r.globalAlpha=1,Object(l.resetCanvasContextTransform)(r)}(e,r[t],o[t]),a.data[t].invalidated&&function(e,t,n){var a=e.detail,r=a.element,o=i.default.cornerstone.getEnabledElement(r),s=t.data[n].pixelData;if(!s)return;var l=c.colorMapId,u=[[0,0,0,0],i.default.cornerstone.colors.getColormap(l).getColor(n)],d=new ImageData(a.image.width,a.image.height),h={stats:{},minPixelValue:0,getPixelData:function(){return s}};i.default.cornerstone.storedPixelDataToCanvasImageDataColorLUT(h,u,d.data),window.createImageBitmap(d).then(function(e){f.imageBitmapCacheForElement(o.uuid,n,e),t.data[n].invalidated=!1,i.default.cornerstone.updateImage(a.element)})}(e,a,t)}t.default=function(e){var t=e.detail.element,n=s.default.getNumberOfColors(),a=Object(o.getToolState)(t,s.default.getReferencedToolDataName());if(a)for(var r=i.default.cornerstone.getEnabledElement(t).uuid,l={visibleSegmentations:d.visibleSegmentationsForElement(r),imageBitmapCache:d.imageBitmapCacheForElement(r),toolData:a},u=0;u<n;u++)h(e,u,l)&&g(e,u,l)}},"./eventListeners/onNewImageBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js"),r=n("./tools/base/BaseBrushTool.js"),o=n("./externalModules.js");t.default=function(e){var t=e.detail,n=t.element,i=Object(a.getToolState)(n,r.default.getReferencedToolDataName());i||(Object(a.addToolState)(n,r.default.getReferencedToolDataName(),{}),i=Object(a.getToolState)(n,r.default.getReferencedToolDataName()));for(var s=r.default.getNumberOfColors(),l=0;l<s;l++)i.data[l]&&(i.data[l].invalidated=!0);o.default.cornerstone.updateImage(t.element)}},"./eventListeners/preventGhostClick.js":function(e,t,n){"use strict";n.r(t);var a,r,o=2e3,i={mouse:0,touch:1};function s(e,t){var n=Date.now();if(e!==a){if(n-r<=o)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;a=e}r=n}var l=s.bind(null,i.mouse),u=s.bind(null,i.touch);function c(e,t,n){var a=n?l:u;t.forEach(function(t){e.addEventListener(t,a,{passive:!1})})}function d(e,t,n){var a=n?l:u;t.forEach(function(t){e.removeEventListener(t,a)})}var f=["mousedown","mouseup"],h=["touchstart","touchend"];function g(e){d(e,f,i.mouse),d(e,h,i.touch)}t.default={enable:function(e){g(e),c(e,f,i.mouse),c(e,h,i.touch)},disable:g}},"./eventListeners/touchEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r,o,i,s,l,u,c,d,f=n("./events.js"),h=n("./externalModules.js"),g=n("./util/copyPoints.js"),m=n("./eventListeners/preventGhostClick.js"),v=n("./util/triggerEvent.js"),p=n("./toolOptions.js"),b=1,y=0,x=!1,w=!1,T=700,j=5,C="touchInput";function _(e){var t=e.currentTarget||e.srcEvent.currentTarget,n=h.default.cornerstone.getEnabledElement(t);if(n.image){var m,p,C,_;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(w=!1,clearTimeout(u)),e.type){case"tap":w=!1,clearTimeout(u),(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),m=f.default.TAP,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:m,isTouchEvent:!0},Object(v.default)(t,m,s);break;case"doubletap":w=!1,clearTimeout(u),(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),m=f.default.DOUBLE_TAP,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:m,isTouchEvent:!0},Object(v.default)(t,m,s);break;case"pinchstart":w=!1,clearTimeout(u),b=1;break;case"pinchmove":if(w=!1,clearTimeout(u),!0===x){b=e.scale,x=!1;break}p=(e.scale-b)/b,(a={page:e.center,image:h.default.cornerstone.pageToPixel(t,e.center.x,e.center.y)}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),m=f.default.TOUCH_PINCH,s={event:e,startPoints:a,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,direction:e.scale<1?1:-1,scaleChange:p,type:m,isTouchEvent:!0},Object(v.default)(t,m,s),b=e.scale;break;case"touchstart":b=1,clearTimeout(u),clearTimeout(l),l=setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),m=f.default.TOUCH_START,e.touches.length>1&&(m=f.default.MULTI_TOUCH_START),s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:m,isTouchEvent:!0},!0===Object(v.default)(t,m,s)&&(m=f.default.TOUCH_START_ACTIVE,e.touches.length>1&&(m=f.default.MULTI_TOUCH_START_ACTIVE),s.type=m,Object(v.default)(t,m,s)),o=Object(g.default)(a)},50),w=!0,c=0,u=setTimeout(function(){w&&((r={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),m=f.default.TOUCH_PRESS,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:m,isTouchEvent:!0},Object(v.default)(t,m,s))},T);break;case"touchend":b=1,w=!1,clearTimeout(u),setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:h.default.cornerstone.pageToPixel(t,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),m=f.default.TOUCH_END,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:m,isTouchEvent:!0},Object(v.default)(t,m,s)},50);break;case"panmove":C={x:e.deltaX-d.x,y:e.deltaY-d.y},d={x:e.deltaX,y:e.deltaY},(r={page:{x:o.page.x+C.x,y:o.page.y+C.y},image:h.default.cornerstone.pageToPixel(t,o.page.x+C.x,o.page.y+C.y),client:{x:o.client.x+C.x,y:o.client.y+C.y}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),i={page:h.default.cornerstoneMath.point.subtract(r.page,o.page),image:h.default.cornerstoneMath.point.subtract(r.image,o.image),client:h.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:h.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},(c+=Math.sqrt(i.page.x*i.page.x+i.page.y*i.page.y))>j&&(w=!1,clearTimeout(u)),m=f.default.TOUCH_DRAG,e.pointers.length>1&&(m=f.default.MULTI_TOUCH_DRAG),s={viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,numPointers:e.pointers.length,type:m,isTouchEvent:!0},Object(v.default)(t,m,s),o=Object(g.default)(r);break;case"panstart":d={x:e.deltaX,y:e.deltaY},(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),o=Object(g.default)(r);break;case"panend":if(w=!1,clearTimeout(u),!o)return!1;(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),i={page:h.default.cornerstoneMath.point.subtract(r.page,o.page),image:h.default.cornerstoneMath.point.subtract(r.image,o.image),client:h.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:h.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},m=f.default.TOUCH_DRAG_END,s={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,type:m,isTouchEvent:!0},Object(v.default)(t,m,s),2===e.pointers.length-e.changedPointers.length&&(x=!0);break;case"rotatemove":w=!1,clearTimeout(u),_=e.rotation-y,y=e.rotation,m=f.default.TOUCH_ROTATE,s={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,rotation:_,type:m},Object(v.default)(t,m,s)}return!1}}function E(e){m.default.disable(e);["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,_)});var t=Object(p.getToolOptions)(C,e).hammer;t&&t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",_)}var M={enable:function(e){E(e);var t=h.default.Hammer,n={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},a=new t.Manager(e,n),r={pointers:0,direction:t.DIRECTION_ALL,threshold:0},o=new t.Pan(r),i=new t.Pinch({threshold:0}),s=new t.Rotate({threshold:0});i.recognizeWith(o),i.recognizeWith(s),s.recognizeWith(o);var l=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});l.recognizeWith(o),a.add([l,o,s,i]),a.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",_),m.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,_,{passive:!1})});var u=Object(p.getToolOptions)(C,e);u.hammer=a,Object(p.setToolOptions)(C,e,u)},disable:E};t.default=M},"./eventListeners/wheelEventListener.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./util/triggerEvent.js"),i=n("./eventListeners/internals/normalizeWheel.js");function s(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image){e.preventDefault();var s=e.pageX,l=e.pageY,u=r.default.cornerstone.pageToPixel(t,s,l),c=Object(i.default)(e),d=c.spinX,f=c.spinY,h=c.pixelX,g=c.pixelY,m=f<0?-1:1,v={element:t,viewport:r.default.cornerstone.getViewport(t),detail:e,image:n.image,direction:m,spinX:d,spinY:f,pixelX:h,pixelY:g,pageX:s,pageY:l,imageX:u.x,imageY:u.y};Object(o.default)(t,a.default.MOUSE_WHEEL,v)}}function l(e){e.removeEventListener("wheel",s,{passive:!1})}t.default={enable:function(e){l(e),e.addEventListener("wheel",s,{passive:!1})},disable:l}},"./eventListeners/windowResizeHandler.js":function(e,t,n){"use strict";n.r(t),n.d(t,"forceEnabledElementResize",function(){return l});var a,r=n("./store/index.js"),o=n("./externalModules.js"),i=function(){window.removeEventListener("resize",s,!1)};function s(){a||(a=setTimeout(function(){a=null,l()},66))}var l=function(){r.state.enabledElements.forEach(function(e){o.default.cornerstone.resize(e)})};t.default={enable:function(){i(),window.addEventListener("resize",s,!1)},disable:i}},"./events.js":function(e,t,n){"use strict";n.r(t);t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll"}},"./externalModules.js":function(e,t,n){"use strict";n.r(t);var a=window.cornerstone,r=window.cornerstoneMath,o=window.Hammer;t.default={set cornerstone(e){a=e},get cornerstone(){return a},set cornerstoneMath(e){r=e},get cornerstoneMath(){return r},set Hammer(e){o=e},get Hammer(){return o}}},"./import.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js");t.default=function(e){return a.lib[e]}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/index.js");n.d(t,"AngleTool",function(){return a.AngleTool}),n.d(t,"ArrowAnnotateTool",function(){return a.ArrowAnnotateTool}),n.d(t,"BidirectionalTool",function(){return a.BidirectionalTool}),n.d(t,"CobbAngleTool",function(){return a.CobbAngleTool}),n.d(t,"EllipticalRoiTool",function(){return a.EllipticalRoiTool}),n.d(t,"FreehandMouseTool",function(){return a.FreehandMouseTool}),n.d(t,"LengthTool",function(){return a.LengthTool}),n.d(t,"ProbeTool",function(){return a.ProbeTool}),n.d(t,"RectangleRoiTool",function(){return a.RectangleRoiTool}),n.d(t,"TextMarkerTool",function(){return a.TextMarkerTool});var r=n("./tools/brush/index.js");n.d(t,"BrushTool",function(){return r.BrushTool});var o=n("./tools/index.js");n.d(t,"CrosshairsTool",function(){return o.CrosshairsTool}),n.d(t,"DoubleTapFitToWindowTool",function(){return o.DoubleTapFitToWindowTool}),n.d(t,"DragProbeTool",function(){return o.DragProbeTool}),n.d(t,"EraserTool",function(){return o.EraserTool}),n.d(t,"FreehandSculpterMouseTool",function(){return o.FreehandSculpterMouseTool}),n.d(t,"MagnifyTool",function(){return o.MagnifyTool}),n.d(t,"PanMultiTouchTool",function(){return o.PanMultiTouchTool}),n.d(t,"PanTool",function(){return o.PanTool}),n.d(t,"ReferenceLinesTool",function(){return o.ReferenceLinesTool}),n.d(t,"RotateTool",function(){return o.RotateTool}),n.d(t,"RotateTouchTool",function(){return o.RotateTouchTool}),n.d(t,"ScaleOverlayTool",function(){return o.ScaleOverlayTool}),n.d(t,"StackScrollMouseWheelTool",function(){return o.StackScrollMouseWheelTool}),n.d(t,"StackScrollMultiTouchTool",function(){return o.StackScrollMultiTouchTool}),n.d(t,"StackScrollTool",function(){return o.StackScrollTool}),n.d(t,"WwwcRegionTool",function(){return o.WwwcRegionTool}),n.d(t,"WwwcTool",function(){return o.WwwcTool}),n.d(t,"ZoomMouseWheelTool",function(){return o.ZoomMouseWheelTool}),n.d(t,"ZoomTool",function(){return o.ZoomTool}),n.d(t,"ZoomTouchPinchTool",function(){return o.ZoomTouchPinchTool});var i=n("./import.js"),s=n("./init.js");n.d(t,"init",function(){return s.default});var l=n("./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",function(){return l.default});var u=n("./stackTools/stackRenderers.js");n.d(t,"stackRenderers",function(){return u.default});var c=n("./stackTools/playClip.js");n.d(t,"playClip",function(){return c.playClip}),n.d(t,"stopClip",function(){return c.stopClip});var d=n("./store/index.js");n.d(t,"store",function(){return d.default});var f=n("./store/getToolForElement.js");n.d(t,"getToolForElement",function(){return f.default});var h=n("./store/addTool.js");n.d(t,"addTool",function(){return h.addTool}),n.d(t,"addToolForElement",function(){return h.addToolForElement});var g=n("./store/removeTool.js");n.d(t,"removeTool",function(){return g.removeTool}),n.d(t,"removeToolForElement",function(){return g.removeToolForElement});var m=n("./store/setToolOptions.js");n.d(t,"setToolOptions",function(){return m.setToolOptions}),n.d(t,"setToolOptionsForElement",function(){return m.setToolOptionsForElement});var v=n("./store/setToolMode.js");n.d(t,"setToolActive",function(){return v.setToolActive}),n.d(t,"setToolActiveForElement",function(){return v.setToolActiveForElement}),n.d(t,"setToolEnabled",function(){return v.setToolEnabled}),n.d(t,"setToolEnabledForElement",function(){return v.setToolEnabledForElement}),n.d(t,"setToolDisabled",function(){return v.setToolDisabled}),n.d(t,"setToolDisabledForElement",function(){return v.setToolDisabledForElement}),n.d(t,"setToolPassive",function(){return v.setToolPassive}),n.d(t,"setToolPassiveForElement",function(){return v.setToolPassiveForElement});var p=n("./stateManagement/toolState.js");n.d(t,"addToolState",function(){return p.addToolState}),n.d(t,"getToolState",function(){return p.getToolState}),n.d(t,"removeToolState",function(){return p.removeToolState}),n.d(t,"clearToolState",function(){return p.clearToolState}),n.d(t,"setElementToolStateManager",function(){return p.setElementToolStateManager}),n.d(t,"getElementToolStateManager",function(){return p.getElementToolStateManager});var b=n("./stateManagement/textStyle.js");n.d(t,"textStyle",function(){return b.default});var y=n("./stateManagement/toolStyle.js");n.d(t,"toolStyle",function(){return y.default});var x=n("./stateManagement/toolColors.js");n.d(t,"toolColors",function(){return x.default});var w=n("./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",function(){return w.default});var T=n("./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",function(){return T.stackSpecificStateManager}),n.d(t,"newStackSpecificToolStateManager",function(){return T.newStackSpecificToolStateManager}),n.d(t,"addStackStateManager",function(){return T.addStackStateManager});var j=n("./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",function(){return j.default});var C=n("./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",function(){return C.newImageIdSpecificToolStateManager}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return C.globalImageIdSpecificToolStateManager});var _=n("./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return _.newFrameOfReferenceSpecificToolStateManager}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return _.globalFrameOfReferenceSpecificToolStateManager});var E=n("./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",function(){return E.forceEnabledElementResize});var M=n("./orientation/index.js");n.d(t,"orientation",function(){return M.default});var O=n("./util/SaveAs.js");n.d(t,"SaveAs",function(){return O.default});var I=n("./util/logger.js");n.d(t,"enableLogger",function(){return I.enable}),n.d(t,"disableLogger",function(){return I.disable});var S=n("./thirdParty/register.js");n.d(t,"register",function(){return S.default});var P=n("./thirdParty/registerSome.js");n.d(t,"registerSome",function(){return P.default});var k=n("./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",function(){return k.default});var L=n("./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",function(){return L.default});var D=n("./synchronization/Synchronizer.js");n.d(t,"Synchronizer",function(){return D.default});var A=n("./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",function(){return A.default});var R=n("./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",function(){return R.default});var H=n("./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",function(){return H.default});var B=n("./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",function(){return B.default});var U=n("./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",function(){return U.default});var N=n("./requestPool/requestPoolManager.js");n.d(t,"requestPoolManager",function(){return N.default});var F=n("./externalModules.js");n.d(t,"external",function(){return F.default});var z=n("./events.js");n.d(t,"EVENTS",function(){return z.default});var V=n("./version.js");n.d(t,"version",function(){return V.default}),n.d(t,"import",function(){return i.default});var W={AngleTool:a.AngleTool,ArrowAnnotateTool:a.ArrowAnnotateTool,BidirectionalTool:a.BidirectionalTool,CobbAngleTool:a.CobbAngleTool,EllipticalRoiTool:a.EllipticalRoiTool,FreehandMouseTool:a.FreehandMouseTool,LengthTool:a.LengthTool,ProbeTool:a.ProbeTool,RectangleRoiTool:a.RectangleRoiTool,TextMarkerTool:a.TextMarkerTool,BrushTool:r.BrushTool,CrosshairsTool:o.CrosshairsTool,DoubleTapFitToWindowTool:o.DoubleTapFitToWindowTool,DragProbeTool:o.DragProbeTool,EraserTool:o.EraserTool,FreehandSculpterMouseTool:o.FreehandSculpterMouseTool,MagnifyTool:o.MagnifyTool,PanMultiTouchTool:o.PanMultiTouchTool,PanTool:o.PanTool,ReferenceLinesTool:o.ReferenceLinesTool,RotateTool:o.RotateTool,RotateTouchTool:o.RotateTouchTool,ScaleOverlayTool:o.ScaleOverlayTool,StackScrollMouseWheelTool:o.StackScrollMouseWheelTool,StackScrollMultiTouchTool:o.StackScrollMultiTouchTool,StackScrollTool:o.StackScrollTool,WwwcRegionTool:o.WwwcRegionTool,WwwcTool:o.WwwcTool,ZoomMouseWheelTool:o.ZoomMouseWheelTool,ZoomTool:o.ZoomTool,ZoomTouchPinchTool:o.ZoomTouchPinchTool,init:s.default,stackPrefetch:l.default,stackRenderers:u.default,playClip:c.playClip,stopClip:c.stopClip,store:d.default,getToolForElement:f.default,addTool:h.addTool,addToolForElement:h.addToolForElement,removeTool:g.removeTool,removeToolForElement:g.removeToolForElement,setToolOptions:m.setToolOptions,setToolOptionsForElement:m.setToolOptionsForElement,setToolActive:v.setToolActive,setToolActiveForElement:v.setToolActiveForElement,setToolEnabled:v.setToolEnabled,setToolEnabledForElement:v.setToolEnabledForElement,setToolDisabled:v.setToolDisabled,setToolDisabledForElement:v.setToolDisabledForElement,setToolPassive:v.setToolPassive,setToolPassiveForElement:v.setToolPassiveForElement,addToolState:p.addToolState,getToolState:p.getToolState,removeToolState:p.removeToolState,clearToolState:p.clearToolState,setElementToolStateManager:p.setElementToolStateManager,getElementToolStateManager:p.getElementToolStateManager,textStyle:b.default,toolStyle:y.default,toolColors:x.default,toolCoordinates:w.default,stackSpecificStateManager:T.stackSpecificStateManager,newStackSpecificToolStateManager:T.newStackSpecificToolStateManager,addStackStateManager:T.addStackStateManager,loadHandlerManager:j.default,newImageIdSpecificToolStateManager:C.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:C.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:_.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:_.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:E.forceEnabledElementResize,orientation:M.default,SaveAs:O.default,enableLogger:I.enable,disableLogger:I.disable,import:i.default,register:S.default,registerSome:P.default,wwwcSynchronizer:k.default,updateImageSynchronizer:L.default,Synchronizer:D.default,stackScrollSynchronizer:A.default,stackImagePositionSynchronizer:R.default,stackImagePositionOffsetSynchronizer:H.default,stackImageIndexSynchronizer:B.default,panZoomSynchronizer:U.default,requestPoolManager:N.default,external:F.default,EVENTS:z.default,version:V.default};t.default=W},"./init.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/internals/addEnabledElement.js"),i=n("./store/internals/removeEnabledElement.js"),s=n("./eventListeners/windowResizeHandler.js");t.default=function(e){var t;!function(){!function(){var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.removeEventListener(t,o.default),e.events.removeEventListener(n,i.default)}();var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.addEventListener(t,o.default),e.events.addEventListener(n,i.default)}(),t=r.default.modules,Object.keys(t).forEach(function(e){"function"==typeof t[e].onRegisterCallback&&t[e].onRegisterCallback()}),s.default.enable(),r.default.modules.globalConfiguration.state=Object.assign({},r.default.modules.globalConfiguration.state,e)}},"./lib.js":function(e,t,n){"use strict";n.r(t),n.d(t,"lib",function(){return U});var a=n("./tools/base/BaseTool.js"),r=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseBrushTool.js"),i=n("./manipulators/index.js"),s=n("./util/findAndMoveHelpers.js"),l=n("./mixins/index.js"),u=n("./tools/cursors/index.js"),c=n("./drawing/index.js"),d=n("./drawing/drawTextBox.js"),f=n("./drawing/drawArrow.js"),h=n("./drawing/drawLink.js"),g=n("./drawing/drawLinkedTextBox.js"),m=n("./drawing/drawHandles.js"),v=n("./util/getLuminance.js"),p=n("./util/copyPoints.js"),b=n("./util/calculateSUV.js"),y=n("./util/setContextToDisplayFontSize.js"),x=n("./util/scrollToIndex.js"),w=n("./util/scroll.js"),T=n("./util/roundToDecimal.js"),j=n("./util/pointProjector.js"),C=n("./util/lineSegDistance.js"),_=n("./util/pointInsideBoundingBox.js"),E=n("./util/makeUnselectable.js"),M=n("./util/getRGBPixels.js"),O=n("./util/getMaxSimultaneousRequests.js"),I=n("./util/angleBetweenPoints.js"),S=n("./util/getKeyFromKeyCode.js"),P=n("./util/numbersWithCommas.js"),k=n("./tools/cursors/MouseCursor.js"),L=n("./util/ellipse/index.js"),D=n("./util/freehand/index.js"),A=n("./util/brush/index.js"),R=n("./util/zoom/index.js"),H=n("./util/triggerEvent.js"),B=n("./util/convertToVector3.js"),U={"base/BaseTool":a.default,"base/BaseAnnotationTool":r.default,"base/BaseBrushTool":o.default,"tools/cursors/MouseCursor":k.default,"tools/cursors":u,"manipulators/anyHandlesOutsideImage":i.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":i.getHandleNearImagePoint,"manipulators/handleActivator":i.handleActivator,"manipulators/moveAllHandles":i.moveAllHandles,"manipulators/moveHandle":i.moveHandle,"manipulators/moveNewHandle":i.moveNewHandle,"manipulators/moveHandleNearImagePoint":s.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":s.findHandleDataNearImagePoint,"manipulators/moveAnnotation":s.moveAnnotation,"mixins/activeOrDisabledBinaryTool":l.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":l.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":c.getNewContext,"drawing/draw":c.draw,"drawing/path":c.path,"drawing/setShadow":c.setShadow,"drawing/drawLine":c.drawLine,"drawing/drawLines":c.drawLines,"drawing/drawJoinedLines":c.drawJoinedLines,"drawing/drawCircle":c.drawCircle,"drawing/drawEllipse":c.drawEllipse,"drawing/drawRect":c.drawRect,"drawing/fillOutsideRect":c.fillOutsideRect,"drawing/drawTextBox":d.default,"drawing/drawArrow":f.default,"drawing/fillBox":c.fillBox,"drawing/fillTextLines":c.fillTextLines,"drawing/drawLink":h.default,"drawing/drawLinkedTextBox":g.default,"drawing/drawHandles":m.default,"drawing/textBoxWidth":d.textBoxWidth,"util/getLuminance":v.default,"util/copyPoints":p.default,"util/calculateSUV":b.default,"util/setContextToDisplayFontSize":y.default,"util/scrollToIndex":x.default,"util/scroll":w.default,"util/roundToDecimal":T.default,"util/projectPatientPointToImagePlane":j.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":j.imagePointToPatientPoint,"util/planePlaneIntersection":j.planePlaneIntersection,"util/pointInsideBoundingBox":_.default,"util/makeUnselectable":E.default,"util/getRGBPixels":M.default,"util/getDefaultSimultaneousRequests":O.getDefaultSimultaneousRequests,"util/getMaxSimultaneousRequests":O.getMaxSimultaneousRequests,"util/getBrowserInfo":O.getBrowserInfo,"util/isMobileDevice":O.isMobileDevice,"util/angleBetweenPoints":I.default,"util/getKeyFromKeyCode":S.default,"util/numbersWithCommas":P.default,"util/lineSegDistance":C.default,"util/triggerEvent":H.default,"util/convertToVectro3":B.default,"util/ellipseUtils":L.default,"util/freehandUtils":D.default,"util/brushUtils":A.default,"util/zoomUtils":R.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=e.image,r={left:0,top:0,width:n.width,height:n.height},o=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===a.default.cornerstoneMath.point.insideRect(n,r)&&(o=!0)}),o}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./util/pointInsideBoundingBox.js"),s=function(e,t,n,a){if(e.hasOwnProperty("pointNearHandle")){if(e.pointNearHandle(t,e,n))return!0}else if(!0===e.hasBoundingBox){if(Object(i.default)(e,n))return!0}else{var r=o.default.cornerstone.pixelToCanvas(t,e);if(o.default.cornerstoneMath.point.distance(r,n)<=a)return!0}return!1};t.default=function e(t,n,a,o){var i;if(n){if(Array.isArray(n))for(var l=Object.keys(n),u=0;u<l.length;u++){var c=n[l[u]];if(c.hasOwnProperty("x")&&c.hasOwnProperty("y")&&s(c,t,a,o)){i=c;break}}else if("object"===r()(n))for(var d=Object.keys(n),f=0;f<d.length;f++){var h=d[f];if(Array.isArray(n[h])){if(i=e(t,n[h],a,o))break}else{var g=n[h];if(s(g,t,a,o)){i=g;break}}}return i}}},"./manipulators/handleActivator.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n,r){r||(r=6);var o=function(e){var t;return Object.keys(e).forEach(function(n){var a=e[n];!0!==a.active||(t=a)}),t}(t),i=Object(a.default)(e,t,n,r);return o!==i&&(void 0!==i&&(i.active=!0),void 0!==o&&(o.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",function(){return a.default});var r=n("./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",function(){return r.default});var o=n("./manipulators/handleActivator.js");n.d(t,"handleActivator",function(){return o.default});var i=n("./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",function(){return i.default});var s=n("./manipulators/moveHandle.js");n.d(t,"moveHandle",function(){return s.default});var l=n("./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",function(){return l.default})},"./manipulators/moveAllHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),c={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},d={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};t.default=function(e,t,n,f){var h=e.element,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";g=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},g);var v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,i=o.detail,u=i.element,c=i.image,d=o.detail.deltaPoints.image,f=d.x,h=d.y;t.active=!0,t.invalidated=!0;for(var g=Object.keys(t.handles),m=0;m<g.length;m++){var v=g[m],p=t.handles[v];!0!==p.movesIndependently&&p.hasOwnProperty("x")&&p.hasOwnProperty("y")&&(p.x+=f,p.y+=h,n.preventHandleOutsideImage&&Object(l.clipToBox)(p,c))}r.default.cornerstone.updateImage(u);var b=a.default.MEASUREMENT_MODIFIED,y={toolName:e,element:u,measurementData:t};Object(s.default)(u,b,y),o.preventDefault(),o.stopPropagation()}.bind(this,t,n,g),p=function e(a){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=s.dragHandler,f=s.upOrEndHandler,h=arguments.length>5?arguments[5]:void 0,g=h.detail,m=h.detail.element;t.active=!1,t.invalidated=!0,u.state.isToolLocked=!1,c[a].forEach(function(e){m.removeEventListener(e,l)}),d[a].forEach(function(e){m.removeEventListener(e,f)}),n.deleteIfHandleOutsideImage&&Object(o.default)(g,t.handles)&&Object(i.removeToolState)(m,e,t);"function"==typeof n.doneMovingCallback&&n.doneMovingCallback();r.default.cornerstone.updateImage(m)}(t,n,g,m,{dragHandler:v,upOrEndHandler:e},a)};n.active=!0,u.state.isToolLocked=!0,c[m].forEach(function(e){h.addEventListener(e,v)}),d[m].forEach(function(e){h.addEventListener(e,p)})}},"./manipulators/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),c={value:!1},d={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},f={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};t.default=function(e,t,n,h){var g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";g=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},g);var v=e.element,p=function(e,t,n,o,i,u){var d=u.detail,f=d.image,h=d.currentPoints,g=d.element,m=h.page,v=r.default.cornerstone.pageToPixel(g,m.x,"touch"===i?m.y+-57:m.y);c.value=!1,n.active=!0,n.hasMoved=!0,n.x=v.x,n.y=v.y,t.invalidated=!0,o.preventHandleOutsideImage&&Object(l.clipToBox)(n,f);r.default.cornerstone.updateImage(g);var p=a.default.MEASUREMENT_MODIFIED,b={toolName:e,element:g,measurementData:t};Object(s.default)(g,p,b)}.bind(this,t,n,h,g,m),b=function s(l){!function(e,t,n,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},h=arguments.length>5?arguments[5]:void 0,g=arguments.length>6?arguments[6]:void 0,m=g.dragHandler,v=g.upOrEndHandler,p=arguments.length>7?arguments[7]:void 0,b=t.currentPoints.image,y=p.detail.element;s.active=!1,n.active=!1,n.invalidated=!0,u.state.isToolLocked=!1,c.value=!1,d[h].forEach(function(e){y.removeEventListener(e,m)}),f[h].forEach(function(e){y.removeEventListener(e,v)}),l.deleteIfHandleOutsideImage&&Object(o.default)(t,n.handles)&&Object(i.removeToolState)(y,e,n);p.type===a.default.TOUCH_PRESS&&(p.detail.handlePressed=n,s.x=b.x,s.y=b.y);"function"==typeof l.doneMovingCallback&&l.doneMovingCallback();r.default.cornerstone.updateImage(y)}(t,e,n,h,g,m,{dragHandler:p,upOrEndHandler:s},l)};if(h.active=!0,n.active=!0,u.state.isToolLocked=!0,d[m].forEach(function(e){v.addEventListener(e,p)}),f[m].forEach(function(e){v.addEventListener(e,b)}),"touch"===m){c.value=!0;var y=r.default.cornerstone.getEnabledElement(v),x={x:e.currentPoints.page.x,y:e.currentPoints.page.y+-57},w=r.default.cornerstone.pageToPixel(v,x.x,x.y);!function e(t,n,a,o){if(!n.value)return;var i=Math.abs(t.y-o.y);var s=i/10;if(i<1)return t.y=o.y,void(n.value=!1);t.y>o.y?t.y-=s:t.y<o.y&&(t.y+=s);r.default.cornerstone.updateImage(a.element);r.default.cornerstone.requestAnimationFrame(function(){e(t,n,a,o)})}(h,c,y,w)}}},"./manipulators/moveNewHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),c={mouse:[a.default.MOUSE_MOVE,a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},d={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_PINCH,a.default.TAP]};function f(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,h,g){var m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse";g=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},g);var v=e.element;n.active=!0,h.active=!0,u.state.isToolLocked=!0;var p=function(e,t,n,o,i,u){var c=u.detail,d=c.currentPoints,f=c.image,h=c.element,g=d.page,m=r.default.cornerstone.pageToPixel(h,"touch"===i?g.x+-57:g.x,"touch"===i?g.y+-57:g.y);t.invalidated=!0,n.active=!0,n.x=m.x,n.y=m.y,o&&o.preventHandleOutsideImage&&Object(l.clipToBox)(n,f);r.default.cornerstone.updateImage(h);var v=a.default.MEASUREMENT_MODIFIED,p={toolName:e,element:h,measurementData:t};Object(s.default)(h,v,p)}.bind(this,t,n,h,g,m),b=function e(s){!function(e,t,n,s,h,g,m){var v=g.moveHandler,p=g.moveEndHandler,b=m.detail,y=b.element,x=b.currentPoints.page,w=r.default.cornerstone.pageToPixel(y,"touch"===h?x.x+-57:x.x,"touch"===h?x.y+-57:x.y);if(t.active=!1,t.invalidated=!0,n.active=!1,n.x=w.x,n.y=w.y,u.state.isToolLocked=!1,c[h].forEach(function(e){y.removeEventListener(e,v)}),d[h].forEach(function(e){y.removeEventListener(e,p)}),y.removeEventListener(a.default.TOUCH_START,f),m.type===a.default.TOUCH_PINCH||m.type===a.default.TOUCH_PRESS)return n.active=!1,r.default.cornerstone.updateImage(y),void("function"==typeof s.doneMovingCallback&&s.doneMovingCallback());s.preventHandleOutsideImage&&Object(l.clipToBox)(n,m.detail.image);s.deleteIfHandleOutsideImage&&Object(o.default)(m.detail,t.handles)&&Object(i.removeToolState)(y,e,t);"function"==typeof s.doneMovingCallback&&s.doneMovingCallback();r.default.cornerstone.updateImage(y)}(t,n,h,g,m,{moveHandler:p,moveEndHandler:e},s)};c[m].forEach(function(e){v.addEventListener(e,p)}),d[m].forEach(function(e){v.addEventListener(e,b)}),v.addEventListener(a.default.TOUCH_START,f)}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},enabledCallback:function(e){Object(a.setToolActiveForElement)(e,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},activeCallback:function(e){Object(a.setToolEnabledForElement)(e,this.name)}}},"./mixins/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./mixins/activeOrDisabledBinaryTool.js"),r=n("./mixins/enabledOrDisabledBinaryTool.js");t.default={activeOrDisabledBinaryTool:a.default,enabledOrDisabledBinaryTool:r.default}},"./orientation/getOrientationString.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");t.default=function(e){for(var t=Object(r.default)(e),n="",o=t.x<0?"R":"L",i=t.y<0?"A":"P",s=t.z<0?"F":"H",l=new a.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=0;u<3;u++)if(l.x>1e-4&&l.x>l.y&&l.x>l.z)n+=o,l.x=0;else if(l.y>1e-4&&l.y>l.x&&l.y>l.z)n+=i,l.y=0;else{if(!(l.z>1e-4&&l.z>l.x&&l.z>l.y))break;n+=s,l.z=0}return n}},"./orientation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./orientation/getOrientationString.js"),r=n("./orientation/invertOrientationString.js"),o={getOrientationString:a.default,invertOrientationString:r.default};t.default=o},"./orientation/invertOrientationString.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.replace("H","f");return t=(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./requestPool/requestPoolManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/getMaxSimultaneousRequests.js"),o={interaction:[],thumbnail:[],prefetch:[]},i={interaction:0,thumbnail:0,prefetch:0},s={interaction:6,thumbnail:6,prefetch:5},l=!1,u=20;function c(){l&&setTimeout(function(){f()},u)}function d(e){var t=a.default.cornerstone,n=e.type;i[n]++,l=!0;var r=e.imageId,o=e.doneCallback,s=e.failCallback,u=t.imageCache.getImageLoadObject(r);if(u)u.promise.then(function(e){i[n]--,o(e),c()},function(e){i[n]--,s(e),c()});else{var d=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e);(!0===e.preventCache?t.loadImage(r,{priority:d,type:e.type}):t.loadAndCacheImage(r,{priority:d,type:e.type})).then(function(e){i[n]--,o(e),c()},function(e){i[n]--,s(e),c()})}}function f(){var e=Object(r.getMaxSimultaneousRequests)();s={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(i.interaction+i.thumbnail+i.prefetch),n=0;n<t;n++){var a=h();a&&d(a)}}function h(){return o.interaction.length&&i.interaction<s.interaction?o.interaction.shift():o.thumbnail.length&&i.thumbnail<s.thumbnail?o.thumbnail.shift():o.prefetch.length&&i.prefetch<s.prefetch?o.prefetch.shift():(o.interaction.length||o.thumbnail.length||o.prefetch.length||(l=!1),!1)}t.default={addRequest:function(e,t,n,r,i,s,u){if(!o.hasOwnProperty(n))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var c={type:n,imageId:t,preventCache:r,doneCallback:i,failCallback:s},d=a.default.cornerstone.imageCache.getImageLoadObject(t);d?d.promise.then(function(e){i(e)},function(e){s(e)}):(u?o[n].unshift(c):o[n].push(c),l=!0)}},clearRequestStack:function(e){if(!o.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");o[e]=[]},startGrabbing:f,getRequestPool:function(){return o}}},"./stackTools/fusionRenderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./externalModules.js"),l=n("./stateManagement/toolState.js"),u=function(){function e(){r()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return i()(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=Object(l.getToolState)(e,"stack").data);var a=s.default.cornerstone,r=t[0],o=r.imageIds[this.currentImageIdIndex],i=t.slice(1,t.length);a.loadAndCacheImage(o).then(function(t){var s=n.layerIds[0];s?a.setLayerImage(e,t,s):(s=a.addLayer(e,t,r.options),n.layerIds.push(s)),a.displayImage(e,t),i.forEach(function(t,r){var i=n.findImageFn(t.imageIds,o),l=r+1,u=n.layerIds[l];u||(u=a.addLayer(e,void 0,t.options),n.layerIds.push(u)),i?a.loadAndCacheImage(i).then(function(t){a.setLayerImage(e,t,u),a.updateImage(e)}):(a.setLayerImage(e,void 0,u),a.setActiveLayer(e,s),a.updateImage(e))})})}}]),e}()},"./stackTools/playClip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"playClip",function(){return c}),n.d(t,"stopClip",function(){return d});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l="playClip";function u(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function c(e,t){var n,c;if(void 0===e)throw new Error("playClip: element must not be undefined");var d=Object(i.getToolState)(e,"stack");if(d&&d.data&&d.data.length){var f,h=r.default.cornerstone;if(d.data.length>1){var g=Object(i.getToolState)(e,"stackRenderer");g&&g.data&&g.data.length&&(f=g.data[0])}var m=d.data[0],v=Object(i.getToolState)(e,l);v&&v.data&&v.data.length?u(n=v.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(i.addToolState)(e,l,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===m.imageIds.length&&(c=function(e,t){var n,a,r,o=0,i=e.length,s=[];for(s.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)r=Number(e[n])/t|0,s.push(r),1===n?a=r:r!==a&&(s.isTimeVarying=!0),o+=r;return s.length>0&&(r=s.isTimeVarying?o/s.length|0:s[0],s.push(r)),s}(n.frameTimeVector,n.speed));var p=function(){var t,r,i,l=m.currentImageIdIndex,c=m.imageIds.length;if(n.reverse?l--:l++,!n.loop&&(l<0||l>=c))return u(n),void function(e){var t={element:e};Object(s.default)(e,a.default.CLIP_STOPPED,t)}(e);l>=c&&(l=0),l<0&&(l=c-1),l!==m.currentImageIdIndex&&(t=o.default.getStartLoadHandler(),r=o.default.getEndLoadHandler(),i=o.default.getErrorLoadingHandler(),t&&t(e),(!0===m.preventCache?h.loadImage(m.imageIds[l]):h.loadAndCacheImage(m.imageIds[l])).then(function(t){try{m.currentImageIdIndex=l,f?(f.currentImageIdIndex=l,f.render(e,d.data)):h.displayImage(e,t),r&&r(e,t)}catch(e){return}},function(t){var n=m.imageIds[l];i&&i(e,n,t)}))};c&&c.length>0&&c.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,c[m.currentImageIdIndex]),p()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(p,1e3/Math.abs(n.framesPerSecond)))}}function d(e){var t=Object(i.getToolState)(e,l);t&&t.data&&t.data.length&&u(t.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./externalModules.js"),o=n("./requestPool/requestPoolManager.js"),i=n("./stateManagement/loadHandlerManager.js"),s=n("./stateManagement/toolState.js"),l=n("./util/getMaxSimultaneousRequests.js"),u=n("./util/logger.js"),c=Object(u.getLogger)("stackTools:stackPrefetch"),d="stackPrefetch",f="prefetch",h={maxImagesToPrefetch:1/0},g=10;function m(e,t){e=Math.round(e)||0;var n=[],a=(t=Math.round(t)||0)-e+1;if(a<=0)return n;for(;a--;)n[a]=t--;return n}var v=function(e){return Math.max.apply(null,e)},p=function(e){return Math.min.apply(null,e)};function b(e){var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0],a=Object(s.getToolState)(e,d);if(a){var l=a.data[0]||{};if(l.indicesToRequest&&l.indicesToRequest.length||(l.enabled=!1),!1!==l.enabled)if(a.data[0].indicesToRequest.sort(function(e,t){return e-t}),l.indicesToRequest.slice().forEach(function(e){var t=n.imageIds[e];t&&(r.default.cornerstone.imageCache.getImageLoadObject(t)&&O(e))}),l.indicesToRequest.length){o.default.clearRequestStack(f);for(var u,g,m,b,y,x,w=(u=l.indicesToRequest,g=n.currentImageIdIndex,m=[],b=[],u.forEach(function(e){e<g?m.push(e):e>g&&b.push(e)}),{low:u.indexOf(v(m)),high:u.indexOf(p(b))}),T=i.default.getErrorLoadingHandler(),j=w.low,C=w.high;j>=0||C<l.indicesToRequest.length;){var _=n.currentImageIdIndex,E=!(_-l.indicesToRequest[j]>h.maxImagesToPrefetch)&&j>=0,M=!(l.indicesToRequest[C]-_>h.maxImagesToPrefetch)&&C<l.indicesToRequest.length;if(!M&&!E)break;E&&(x=l.indicesToRequest[j--],y=n.imageIds[x],o.default.addRequest(e,y,f,!1,I,S)),M&&(x=l.indicesToRequest[C++],y=n.imageIds[x],o.default.addRequest(e,y,f,!1,I,S))}o.default.startGrabbing()}}}function O(e){var t=l.indicesToRequest.indexOf(e);t>-1&&l.indicesToRequest.splice(t,1)}function I(e){c.log("prefetch done: %s",e.imageId),O(n.imageIds.indexOf(e.imageId))}function S(t){c.log("prefetch errored: %o",t),T&&T(e,y,t,"stackPrefetch")}}function y(e){return function(t){var n,a=t.detail;try{n=Object(s.getToolState)(e,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var r=n.data[0].imageIds.indexOf(a.imageId);if(!(r<0)){var o=Object(s.getToolState)(e,d);o&&o.data&&o.data.length&&o.data[0].indicesToRequest.push(r)}}}}function x(e){clearTimeout(a),a=setTimeout(function(){var t=e.target;try{b(t)}catch(e){return}},g)}var w={enable:function(e){Object(s.getToolState)(e,d).data=[];var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0!==n.preventCache){var a={indicesToRequest:m(0,n.imageIds.length-1),enabled:!0,direction:1},o=a.indicesToRequest.indexOf(n.currentImageIdIndex);a.indicesToRequest.splice(o,1),Object(s.addToolState)(e,d,a),b(e),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,x),e.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,x);var i=y(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i),r.default.cornerstone.events.addEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i)}else c.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(a),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,x);var t=y(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,t);var n=Object(s.getToolState)(e,d);n&&n.data.length&&(n.data[0].enabled=!1,o.default.clearRequestStack(f))},getConfiguration:function(){return h},setConfiguration:function(e){h=e,e.maxSimultaneousRequests&&Object(l.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}};t.default=w},"./stackTools/stackRenderers.js":function(e,t,n){"use strict";n.r(t);var a=n("./stackTools/fusionRenderer.js"),r={};r.FusionRenderer=a.default,t.default=r},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){"use strict";function a(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}},add:function(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(a)},remove:function(t,n,a){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n)){for(var o=r[n],i=-1,s=0;s<o.data.length;s++)o.data[s]===a&&(i=s);-1!==i&&o.data.splice(i,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return a}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return r});var r=a()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"newImageIdSpecificToolStateManager",function(){return r}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return o});var a=n("./externalModules.js");function r(){var e={};return{get:function(t,n){var r=a.default.cornerstone.getEnabledElement(t);if(r.image&&!1!==e.hasOwnProperty(r.image.imageId)){var o=e[r.image.imageId];if(!1!==o.hasOwnProperty(n))return o[n]}},add:function(t,n,r){var o=a.default.cornerstone.getEnabledElement(t);if(o.image){!1===e.hasOwnProperty(o.image.imageId)&&(e[o.image.imageId]={});var i=e[o.image.imageId];!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n].data.push(r)}},clear:function(t){var n=a.default.cornerstone.getEnabledElement(t);n.image&&!1!==e.hasOwnProperty(n.image.imageId)&&delete e[n.image.imageId]},saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var o=r()},"./stateManagement/loadHandlerManager.js":function(e,t,n){"use strict";var a,r,o;n.r(t);var i={setStartLoadHandler:function(e){a=e},getStartLoadHandler:function(){return a},setEndLoadHandler:function(e){r=e},getEndLoadHandler:function(){return r},setErrorLoadingHandler:function(e){o=e},getErrorLoadingHandler:function(){return o}};t.default=i},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"stackSpecificStateManager",function(){return l}),n.d(t,"newStackSpecificToolStateManager",function(){return o}),n.d(t,"addStackStateManager",function(){return s});var a=n("./stateManagement/imageIdSpecificStateManager.js"),r=n("./stateManagement/toolState.js");function o(e,t){var n={};return{get:function(a,r){return e.indexOf(r)>=0?(!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r]):t.get(a,r)},add:function(a,r,o){if(!(e.indexOf(r)>=0))return t.add(a,r,o);!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r].data.push(o)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}var i=[];function s(e,t){var n=Object(r.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var s=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(s=s.concat(t));var l=o(s,n);i.push(l),Object(r.setElementToolStateManager)(e,l)}var l={newStackSpecificToolStateManager:o,addStackStateManager:s}},"./stateManagement/textStyle.js":function(e,t,n){"use strict";n.r(t);var a=15,r="".concat(a,"px Arial"),o="transparent";var i={setFont:function(e){r=e},getFont:function(){return r},setFontSize:function(e){a=e},getFontSize:function(){return a},setBackgroundColor:function(e){o=e},getBackgroundColor:function(){return o}};t.default=i},"./stateManagement/toolColors.js":function(e,t,n){"use strict";n.r(t);var a="white",r="greenyellow",o="transparent";var i={setFillColor:function(e){o=e},getFillColor:function(){return o},setToolColor:function(e){a=e},getToolColor:function(){return a},setActiveColor:function(e){r=e},getActiveColor:function(){return r},getColorIfActive:function(e){return e.color?e.color:e.active?r:a}};t.default=i},"./stateManagement/toolCoordinates.js":function(e,t,n){"use strict";var a;n.r(t);var r={setCoords:function(e){a=e.currentPoints.canvas},getCoords:function(){return a}};t.default=r},"./stateManagement/toolState.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addToolState",function(){return l}),n.d(t,"getToolState",function(){return u}),n.d(t,"removeToolState",function(){return c}),n.d(t,"clearToolState",function(){return d}),n.d(t,"setElementToolStateManager",function(){return f}),n.d(t,"getElementToolStateManager",function(){return s});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/imageIdSpecificStateManager.js"),i=n("./util/triggerEvent.js");function s(e){var t=r.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=o.globalImageIdSpecificToolStateManager),t.toolStateManager}function l(e,t,n){s(e).add(e,t,n);var r=a.default.MEASUREMENT_ADDED,o={toolType:t,element:e,measurementData:n};Object(i.default)(e,r,o)}function u(e,t){return s(e).get(e,t)}function c(e,t,n){for(var r=s(e).get(e,t),o=-1,l=0;l<r.data.length;l++)r.data[l]===n&&(o=l);if(-1!==o){r.data.splice(o,1);var u=a.default.MEASUREMENT_REMOVED,c={toolType:t,element:e,measurementData:n};Object(i.default)(e,u,c)}}function d(e,t){var n=s(e).get(e,t);void 0!==n&&(n.data=[])}function f(e,t){r.default.cornerstone.getEnabledElement(e).toolStateManager=t}},"./stateManagement/toolStyle.js":function(e,t,n){"use strict";n.r(t);var a=1,r=2;var o={setToolWidth:function(e){a=e},getToolWidth:function(){return a},setActiveWidth:function(e){r=e},getActiveWidth:function(){return r}};t.default=o},"./store/addTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addTool",function(){return l}),n.d(t,"addToolForElement",function(){return s});var a=n("./store/index.js"),r=n("./store/getToolForElement.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("addTool"),s=function(e,t,n){var o=new t(n);Object(r.default)(e,o.name)?i.warn("%s has already been added to the target element",o.name):(o.element=e,a.default.state.tools.push(o))},l=function(e,t){u(e,t),a.default.state.enabledElements.forEach(function(n){s(n,e,t)})},u=function(e,t){if(a.default.modules.globalConfiguration.state.globalToolSyncEnabled){var n=new e(t);void 0!==a.default.state.globalTools[n.name]?i.warn("%s has already been added globally",n.name):a.default.state.globalTools[n.name]={tool:e,configuration:t,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter(function(e){return!(e.isMultiPartTool||e instanceof a.default||e instanceof r.default)})}},"./store/getActiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return t.filter(function(t){return t.element===e&&"active"===t.mode&&(void 0===n||t.options["is".concat(n,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return t.filter(function(t){return t.element===e&&("active"===t.mode||"passive"===t.mode)})}},"./store/getToolForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js");t.default=function(e,t){return a.state.tools.find(function(n){return n.element===e&&n.name===t})}},"./store/getToolsWithDataForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js");t.default=function(e,t){return t.filter(function(t){var n=Object(a.getToolState)(e,t.name);return n&&n.data.length>0})}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n){var i="mouse"===(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse")?a.state.clickProximity:a.state.touchProximity;return t.filter(function(t){for(var a=Object(r.getToolState)(e,t.name),s=0;s<a.data.length;s++)if(void 0!==Object(o.default)(e,a.data[s].handles,n,i))return!0;return!1})}},"./store/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",function(){return s}),n.d(t,"getters",function(){return l}),n.d(t,"setters",function(){return u}),n.d(t,"modules",function(){return c});var a=n("./store/modules/brushModule.js"),r=n("./store/modules/cursorModule.js"),o=n("./store/modules/globalConfigurationModule.js"),i=n("./externalModules.js"),s={globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,svgCursorUrl:null},l={mouseTools:function(){return s.tools.filter(function(e){return e.supportedInteractionTypes.includes("Mouse")})},touchTools:function(){return s.tools.filter(function(e){return e.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function(e){return s.enabledElements.find(function(t){return i.default.cornerstone.getEnabledElement(t).uuid===e})}},u={},c={brush:a.default,cursor:r.default,globalConfiguration:o.default};t.default={modules:c,state:s,getters:l}},"./store/internals/addEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/addTool.js"),i=n("./store/setToolMode.js"),s=n("./store/index.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("internals:addEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;r.imageRenderedEventDispatcher.enable(t),r.newImageEventDispatcher.enable(t),s.default.modules.globalConfiguration.state.mouseEnabled&&(a.mouseEventListeners.enable(t),a.wheelEventListener.enable(t),r.mouseToolEventDispatcher.enable(t)),s.default.modules.globalConfiguration.state.touchEnabled&&(a.touchEventListeners.enable(t),r.touchToolEventDispatcher.enable(t)),c(t)};var c=function(e){s.default.state.enabledElements.push(e),s.default.modules&&function(e){var t=s.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].enabledElementCallback&&t[n].enabledElementCallback(e)})}(e),function(e){if(!s.default.modules.globalConfiguration.state.globalToolSyncEnabled)return;Object.keys(s.default.state.globalTools).forEach(function(t){var n=s.default.state.globalTools[t],a=n.tool,r=n.configuration;Object(o.addToolForElement)(e,a,r)})}(e),function(e){if(!s.default.modules.globalConfiguration.state.globalToolSyncEnabled)return;var t={active:i.setToolActiveForElement,passive:i.setToolPassiveForElement,enabled:i.setToolEnabledForElement,disabled:i.setToolDisabledForElement};s.default.state.globalToolChangeHistory.forEach(function(n){var a=n.args.slice(0);a.unshift(e),t[n.mode].apply(null,a)})}(e)}},"./store/internals/removeEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/index.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("internals:removeEnabledElement");t.default=function(e){s.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element;r.imageRenderedEventDispatcher.disable(t),r.newImageEventDispatcher.disable(t),o.default.modules.globalConfiguration.state.mouseEnabled&&(a.mouseEventListeners.disable(t),a.wheelEventListener.disable(t),r.mouseToolEventDispatcher.disable(t)),o.default.modules.globalConfiguration.state.touchEnabled&&(a.touchEventListeners.disable(t),r.touchToolEventDispatcher.disable(t)),l(t),u(t)};var l=function(e){o.default.state.tools=o.default.state.tools.filter(function(t){return t.element!==e})},u=function(e){o.default.modules&&function(e){var t=o.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].removeEnabledElementCallback&&t[n].removeEnabledElementCallback(e)})}(e);var t=o.default.state.enabledElements.findIndex(function(t){return t===e});t>-1?o.default.state.enabledElements.splice(t,1):s.warn("unable to remove element")}},"./store/isToolActive.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/getToolForElement.js");t.default=function(e,t){return"active"===Object(a.default)(e,t).mode}},"./store/modules/brushModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r={drawColorId:0,radius:10,minRadius:1,maxRadius:50,alpha:.4,renderBrushIfHiddenButActive:!0,hiddenButActiveAlpha:.2,colorMapId:"BrushColorMap",visibleSegmentations:{},imageBitmapCache:{},segmentationMetadata:{}},o={radius:function(e){r.radius=Math.min(Math.max(e,r.minRadius),r.maxRadius)},brushColorMap:function(e){var t=a.default.cornerstone.colors.getColormap(r.colorMapId);t.setNumberOfColors(e.length);for(var n=0;n<e.length;n++)t.setColor(n,e[n])},elementVisible:function(e){if(a.default.cornerstone){var t=a.default.cornerstone.getEnabledElement(e).uuid,n=a.default.cornerstone.colors.getColormap(r.colorMapId).getNumberOfColors();r.visibleSegmentations[t]=[];for(var o=0;o<n;o++)r.visibleSegmentations[t].push(!0)}},brushVisibilityForElement:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r.visibleSegmentations[e]||(r.imageBitmapCache[e]=[]),r.visibleSegmentations[e][t]=n},imageBitmapCacheForElement:function(e,t,n){r.imageBitmapCache[e]||(r.imageBitmapCache[e]=[]),r.imageBitmapCache[e][t]=n},clearImageBitmapCacheForElement:function(e){r.imageBitmapCache[e]=[]},metadata:function(e,t,n){r.segmentationMetadata[e]||(r.segmentationMetadata[e]=[]),r.segmentationMetadata[e][t]=n}},i={imageBitmapCacheForElement:function(e){return r.imageBitmapCache[e]?r.imageBitmapCache[e]:null},visibleSegmentationsForElement:function(e){return r.visibleSegmentations[e]?r.visibleSegmentations[e]:null},metadata:function(e,t){if(r.segmentationMetadata[e])return void 0!==t?r.segmentationMetadata[e][t]:r.segmentationMetadata[e]}};t.default={state:r,onRegisterCallback:function(){!function(){var e=a.default.cornerstone.colors.getColormap(r.colorMapId);e.setNumberOfColors(19);for(var t=0;t<19;t++)t<s.length?e.setColor(t,s[t]):e.setColor(t,u())}()},enabledElementCallback:function(e){o.elementVisible(e)},getters:i,setters:o};var s=[[230,25,75,255],[60,180,175,255],[255,225,25,255],[0,130,200,255],[245,130,48,255],[145,30,180,255],[70,240,240,255],[240,50,230,255],[210,245,60,255],[250,190,190,255],[0,128,128,255],[230,190,255,255],[170,110,40,255],[255,250,200,255],[128,0,0,255],[170,255,195,255],[128,128,0,255],[255,215,180,255],[0,0,128,255]],l=0;function u(){for(var e=function(){var e=[l];l<s.length-1?(l++,e.push(l)):(l=0,e.push(l));return e}(),t=Math.random(),n=[],a=0;a<4;a++)n.push(Math.floor(t*s[e[0]][a]+(1-t)*s[e[1]][a]));return n}},"./store/modules/cursorModule.js":function(e,t,n){"use strict";n.r(t);var a={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '},r={defaultOptions:function(e){Object.assign(a,e)}},o={defaultOptions:function(){return a}};t.default={getters:o,setters:r}},"./store/modules/globalConfigurationModule.js":function(e,t,n){"use strict";n.r(t);t.default={state:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1},setters:{}}},"./store/removeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"removeTool",function(){return o}),n.d(t,"removeToolForElement",function(){return r});var a=n("./store/index.js"),r=function(e,t){var n=a.default.state.tools.findIndex(function(n){return n.element===e&&n.name===t});n>=0&&a.default.state.tools.splice(n,1)},o=function(e){i(e),a.default.state.enabledElements.forEach(function(t){r(t,e)})},i=function(e){a.default.modules.globalConfiguration.state.globalToolSyncEnabled&&a.default.state.globalTools[e]&&delete a.default.state.globalTools[e]}},"./store/setToolCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolCursor",function(){return o}),n.d(t,"resetToolCursor",function(){return i}),n.d(t,"hideToolCursor",function(){return s});var a=n("./store/index.js"),r=a.modules.globalConfiguration;function o(e,t){if(r.state.showSVGCursors){var n=t.getIconWithPointerSVG(),o=t.mousePoint,i=window.URL.createObjectURL(n);e.style.cursor="url('".concat(i,"') ").concat(o,", auto"),a.state.svgCursorUrl=i}}function i(e){l(e,"initial")}function s(e){r.state.showSVGCursors&&l(e,"none")}function l(e,t){a.state.svgCursorUrl&&window.URL.revokeObjectURL(a.state.svgCursorUrl),a.state.svgCursorUrl=null,e.style.cursor=t}},"./store/setToolMode.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolActive",function(){return f}),n.d(t,"setToolActiveForElement",function(){return d}),n.d(t,"setToolDisabled",function(){return g}),n.d(t,"setToolDisabledForElement",function(){return h}),n.d(t,"setToolEnabled",function(){return v}),n.d(t,"setToolEnabledForElement",function(){return m}),n.d(t,"setToolPassive",function(){return b}),n.d(t,"setToolPassiveForElement",function(){return p});var a=n("./events.js"),r=n("./util/triggerEvent.js"),o=n("./store/getToolForElement.js"),i=n("./store/index.js"),s=n("./store/setToolCursor.js"),l=n("./util/logger.js"),u=i.default.modules.globalConfiguration,c=Object(l.getLogger)("store:setToolMode"),d=function(e,t,n,a){void 0===a&&Array.isArray(n)&&(a=n,n=null);var r=Object(o.default)(e,t);r&&(function(e,t,n,a){t.supportedInteractionTypes.forEach(function(r){if(void 0===a||a.includes(r)){var o=j[r];o?o(t,e,n):c.warn("Unable to resolve input conflicts for type %s",r)}}),i.default.state.tools.filter(function(t){return t.element===e&&"active"===t.mode&&t.supportedInteractionTypes.length>0}).forEach(function(t){var n=!1;t.supportedInteractionTypes.forEach(function(e){t.options["is".concat(e,"Active")]&&(n=!0)}),n||(c.log("Setting tool %s's to PASSIVE",t.name),p(e,t.name))})}(e,r,n,a),r.supportedInteractionTypes.forEach(function(e){void 0===a||a.includes(e)?n["is".concat(e,"Active")]=!0:n["is".concat(e,"Active")]=!1}),u.state.showSVGCursors&&r.supportedInteractionTypes.includes("Mouse")&&function(e,t,n){var a;a="number"==typeof t?[t]:t.mouseButtonMask;a.includes(1)&&(n.svgCursor?Object(s.setToolCursor)(n.element,n.svgCursor):n.hideDefaultCursor?Object(s.hideToolCursor)(e):Object(s.resetToolCursor)(e))}(e,n,r)),y("active",null,e,t,n)};var f=function(e,t,n){T("active",e,t,n),i.default.state.enabledElements.forEach(function(a){d(a,e,t,n)})},h=y.bind(null,"disabled",null),g=x.bind(null,"disabled",null),m=y.bind(null,"enabled",null),v=x.bind(null,"enabled",null),p=y.bind(null,"passive",a.default.TOOL_DEACTIVATED),b=x.bind(null,"passive",a.default.TOOL_DEACTIVATED);function y(e,t,n,a,i){var s=Object(o.default)(n,a);if(s){if(i=C(i),Array.isArray(i.mouseButtonMask)&&0!==i.mouseButtonMask.length&&Array.isArray(s.options.mouseButtonMask)&&(i.mouseButtonMask=i.mouseButtonMask.concat(s.options.mouseButtonMask).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[])),s.mode=e,s.mergeOptions(i),s["".concat(e,"Callback")]&&s["".concat(e,"Callback")](n,i),t){var l={options:i,toolName:a,type:t};Object(r.default)(n,t,l)}}else c.warn('Unable to find tool "%s" for enabledElement',a)}function x(e,t,n,a){T(e,n,a),i.default.state.enabledElements.forEach(function(r){y(e,t,r,n,a)})}function w(e,t,n,a){var r="is".concat(e,"Active"),o=i.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options[r]});o&&(c.log("Setting tool %s's %s to false",o.name,r),o.options[r]=!1)}function T(e,t,n,a){if(i.default.modules.globalConfiguration.state.globalToolSyncEnabled){var r={mode:e,args:[t,n]};a&&r.push(a),i.default.state.globalToolChangeHistory.push(r);i.default.state.globalToolChangeHistory.length>50&&i.default.state.globalToolChangeHistory.shift();var o=i.default.state.globalTools[t];if("active"===e){var s=function(e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var a=[],r=i.default.state.globalTools[e];if(r){var o=new r.tool(r.configuration);o.supportedInteractionTypes.forEach(function(e){if(void 0===n||n.includes(e))if("Mouse"===e){var r=C(t).mouseButtonMask;Array.isArray(r)&&r.length>0?r.forEach(function(t){return a.push("".concat(e,"-").concat(t))}):Array.isArray(r)&&0===r.length&&a.push("".concat(e,"-DELETE"))}else"MultiTouch"===e?a.push("".concat(e,"-").concat(o.configuration.touchPointers)):a.push(e)})}return a}(t,n,a);Object.keys(i.default.state.globalTools).forEach(function(e){var t=i.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter(function(e){return!s.includes(e)})}),s.some(function(e){return e.includes("Mouse-DELETE")})&&(o.activeBindings=o.activeBindings.filter(function(e){return!e.includes("Mouse")}),s=s.filter(function(e){return!e.includes("Mouse")})),o.activeBindings=o.activeBindings.concat(s)}else o.activeBindings=[]}}var j={Mouse:function(e,t,n){var a=C(n).mouseButtonMask;if(Array.isArray(a)&&a.length>0){var r=i.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some(function(e){return a.includes(e)})});r&&(r.options.mouseButtonMask=r.options.mouseButtonMask.filter(function(e){return!a.includes(e)}),0===r.options.mouseButtonMask.length&&(r.options.isMouseActive=!1))}},MouseWheel:w.bind(void 0,"MouseWheel"),Touch:function(e,t,n){var a=i.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive}),r=i.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers});a&&(c.log("Setting tool %s's isTouchActive to false",a.name),a.options.isTouchActive=!1),r&&(c.log("Setting tool %s's isTouchActive to false",r.name),r.options.isMultiTouchActive=!1)},TouchPinch:w.bind(void 0,"TouchPinch"),TouchRotate:w.bind(void 0,"TouchRotate"),DoubleTap:w.bind(void 0,"DoubleTap"),MultiTouch:function(e,t,n){var a,r=i.default.state.tools.find(function(n){return n.element===t&&"active"===n.mode&&!0===n.options.isMultiTouchActive&&n.configuration.touchPointers===e.configuration.touchPointers});1===e.configuration.touchPointers&&(a=i.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive})),r&&(c.log("Setting tool %s's isMultiTouchActive to false",r.name),r.options.isMultiTouchActive=!1),a&&(c.log("Setting tool %s's isTouchActive to false",a.name),a.options.isTouchActive=!1)}};function C(e){if(e!==Object(e)||Array.isArray(e))if("number"==typeof e){var t=[];t.push(e),e={mouseButtonMask:0===e?[]:t}}else null===e?e={mouseButtonMask:[]}:(c.log("No options provided when changing tool mode"),e={});else if(0===e.mouseButtonMask||null===e.mouseButtonMask)e.mouseButtonMask=[];else if("number"==typeof e.mouseButtonMask){var n=[];n.push(e.mouseButtonMask),e.mouseButtonMask=n}return e}},"./store/setToolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolOptions",function(){return i}),n.d(t,"setToolOptionsForElement",function(){return o});var a=n("./store/index.js"),r=n("./store/getToolForElement.js"),o=function(e,t,n){var a=Object(r.default)(e,t);a&&a.mergeOptions(n)},i=function(e,t){a.state.enabledElements.forEach(function(e){o(e,t)})}},"./synchronization/Synchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js"),o=n("./toolOptions.js");function i(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}t.default=function(e,t){var n=a.default.cornerstone,s=this,l=[],u=[],c=!1,d={},f=t;function h(e,t){var n=!s.enabled,a=!l.length||!u.length;n||a||(c=!0,u.forEach(function(n){var a=u.indexOf(n);if(-1!==a){var r=d.imageIds.targetElements[a],o=l.indexOf(e);if(-1!==o){var i,c=d.imageIds.sourceElements[o];c===r?i=0:void 0!==d.distances[c]&&(i=d.distances[c][r]),f(s,e,n,t,i)}}}),c=!1)}function g(e){var t=e.detail;!0!==c&&h(e.currentTarget,t)}function m(e){var t=e.detail.element;s.remove(t),Object(o.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){f=e},this.getHandler=function(){return f},this.getDistances=function(){l.length&&u.length&&(d.distances={},d.imageIds={sourceElements:[],targetElements:[]},l.forEach(function(e){var t=n.getEnabledElement(e);if(t&&t.image){var a=t.image.imageId,o=n.metaData.get("imagePlaneModule",a);if(o&&o.imagePositionPatient){var i=Object(r.default)(o.imagePositionPatient);d.hasOwnProperty(t)||(d.distances[a]={},d.imageIds.sourceElements.push(a),u.forEach(function(t){var o=n.getEnabledElement(t);if(o&&o.image){var s=o.image.imageId;if(d.imageIds.targetElements.push(s),e!==t&&a!==s&&!d.distances[a].hasOwnProperty(s)){var l=n.metaData.get("imagePlaneModule",s);if(l&&l.imagePositionPatient){var u=Object(r.default)(l.imagePositionPatient);d.distances[a][s]=u.clone().sub(i)}}}}),Object.keys(d.distances[a]).length||delete d.distances[a])}}}))},this.addSource=function(t){-1===l.indexOf(t)&&(l.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,g)}),s.getDistances(),s.updateDisableHandlers())},this.addTarget=function(e){-1===u.indexOf(e)&&(u.push(e),s.getDistances(),f(s,e,e,0),s.updateDisableHandlers())},this.add=function(e){s.addSource(e),s.addTarget(e)},this.removeSource=function(t){var n=l.indexOf(t);-1!==n&&(l.splice(n,1),e.split(" ").forEach(function(e){t.removeEventListener(e,g)}),s.getDistances(),h(t),s.updateDisableHandlers())},this.removeTarget=function(e){var t=u.indexOf(e);-1!==t&&(u.splice(t,1),s.getDistances(),f(s,e,e,0),s.updateDisableHandlers())},this.remove=function(e){s.removeTarget(e),s.removeSource(e)},this.getSourceElements=function(){return l},this.getTargetElements=function(){return u},this.displayImage=function(e,t,a){c=!0,n.displayImage(e,t,a),c=!1},this.setViewport=function(e,t){c=!0,n.setViewport(e,t),c=!1},this.updateDisableHandlers=function(){i(l.concat(u)).forEach(function(e){e.removeEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,m),e.addEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,m)})},this.destroy=function(){i(l.concat(u)).forEach(function(e){s.remove(e)})}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.scale===o.scale&&i.translation.x===o.translation.x&&i.translation.y===o.translation.y||(i.scale=o.scale,i.translation.x=o.translation.x,i.translation.y=o.translation.y,e.setViewport(n,i))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=Object(r.getToolState)(n,"stack").data[0],c=l.currentImageIdIndex;if((c=Object(i.default)(c,0,u.imageIds.length-1))!==u.currentImageIdIndex){var d=o.default.getStartLoadHandler(),f=o.default.getEndLoadHandler(),h=o.default.getErrorLoadingHandler();d&&d(n),(!0===u.preventCache?s.loadImage(u.imageIds[c]):s.loadAndCacheImage(u.imageIds[c])).then(function(t){var a=s.getViewport(n);u.currentImageIdIndex=c,e.displayImage(n,t,a),f&&f(n,t)},function(e){var t=u.imageIds[c];h&&h(n,t,e)})}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n,s,l){if(n!==t){var u=a.default.cornerstone,c=Object(r.getToolState)(t,"stack").data[0],d=c.imageIds[c.currentImageIdIndex],f=u.metaData.get("imagePlaneModule",d);if(void 0!==f&&void 0!==f.imagePositionPatient){var h=Object(i.default)(f.imagePositionPatient),g=Object(r.getToolState)(n,"stack").data[0],m=Number.MAX_VALUE,v=-1;if(l){var p=h.clone().add(l);if(g.imageIds.forEach(function(e,t){var n=u.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient),r=p.distanceToSquared(a);r<m&&(m=r,v=t)}}),v!==g.currentImageIdIndex&&-1!==v){var b=o.default.getStartLoadHandler(),y=o.default.getEndLoadHandler(),x=o.default.getErrorLoadingHandler();g.currentImageIdIndex=v;var w=g.imageIds[v];b&&b(n),(!0===g.preventCache?u.loadImage(w):u.loadAndCacheImage(w)).then(function(t){var a=u.getViewport(n);g.currentImageIdIndex===v&&(e.displayImage(n,t,a),y&&y(n,t))},function(e){var t=g.imageIds[v];x&&x(n,t,e)})}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=l.imageIds[l.currentImageIdIndex],c=s.metaData.get("imagePlaneModule",u);if(void 0!==c&&void 0!==c.imagePositionPatient){var d=Object(i.default)(c.imagePositionPatient),f=Object(r.getToolState)(n,"stack").data[0],h=Number.MAX_VALUE,g=-1;if(f.imageIds.forEach(function(e,t){var n=s.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient).distanceToSquared(d);a<h&&(h=a,g=t)}}),g!==f.currentImageIdIndex){var m=o.default.getStartLoadHandler(),v=o.default.getEndLoadHandler(),p=o.default.getErrorLoadingHandler();f.currentImageIdIndex=g;var b=f.imageIds[g];if(m&&m(n),-1!==g)(!0===f.preventCache?s.loadImage(b):s.loadAndCacheImage(b)).then(function(t){var a=s.getViewport(n);f.currentImageIdIndex===g&&(e.displayImage(n,t,a),v&&v(n,t))},function(e){var t=f.imageIds[g];p&&p(n,t,e)})}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n,s){if(t!==n&&s&&s.direction){var l=a.default.cornerstone,u=Object(r.getToolState)(n,"stack").data[0],c=u.currentImageIdIndex+s.direction;if(c=Object(i.default)(c,0,u.imageIds.length-1),u.currentImageIdIndex!==c){var d=o.default.getStartLoadHandler(),f=o.default.getEndLoadHandler(),h=o.default.getErrorLoadingHandler();u.currentImageIdIndex=c;var g=u.imageIds[c];d&&d(n),(!0===u.preventCache?l.loadImage(g):l.loadAndCacheImage(g)).then(function(t){var a=l.getViewport(n);u.currentImageIdIndex===c&&(e.displayImage(n,t,a),f&&f(n,t))},function(e){var t=u.imageIds[c];h&&h(n,t,e)})}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){n!==t&&a.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.voi.windowWidth===o.voi.windowWidth&&i.voi.windowCenter===o.voi.windowCenter&&i.invert===o.invert||(i.voi.windowWidth=o.voi.windowWidth,i.voi.windowCenter=o.voi.windowCenter,i.invert=o.invert,e.setViewport(n,i))}}},"./thirdParty/register.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./thirdParty/registerModule.js"),i=n("./thirdParty/registerMixin.js"),s=n("./thirdParty/registerItem.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("thirdParty:register");t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(function(e,t,n){if(!e)return u.warn("The type must be given in order to register."),!1;if(!t)return u.warn("The %s must have a name in order to register.",e),!1;if("object"!==r()(n)&&"function"!=typeof n)return u.warn("The %s is a %s, it should be an Object or a function.",n,r()(n)),!1;return!0}(e,t,n))switch(e){case"module":Object(o.default)(t,n,a);break;case"mixin":Object(i.default)(t,n,a);break;default:Object(s.default)(e,t,n,a)}}},"./thirdParty/registerItem.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerType");t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="".concat(e,"/").concat(t),s=function(e){return void 0!==a.lib[e]}(i);!s||r?(s&&o.warn("Overwriting %s",i),a.lib[i]=n):o.warn("%s is already registered",i)}},"./thirdParty/registerMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./mixins/index.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("thirdParty:registerMixin");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=function(e){return void 0!==r.default[e]}(e);!o||n?(o&&i.warn("Overwriting mixins/%s",e),r.default[e]=t,a.lib["mixins/".concat(e)]=r.default[e]):i.warn("mixins/%s is already registered",e)}},"./thirdParty/registerModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerModule");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e){return void 0!==a.modules[e]}(e);!r||n?(r&&o.warn("Overwriting module %s",e),a.modules[e]=t):o.warn("A module with the name %s is already registered",e)}},"./thirdParty/registerSome.js":function(e,t,n){"use strict";n.r(t);var a=n("./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){var n=e.type,r=e.name,o=e.item;Object(a.default)(n,r,o,t)})}},"./toolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getToolOptions",function(){return r}),n.d(t,"setToolOptions",function(){return o}),n.d(t,"clearToolOptions",function(){return i}),n.d(t,"clearToolOptionsByToolType",function(){return s}),n.d(t,"clearToolOptionsByElement",function(){return l});var a={};function r(e,t){if(!a[e])return{};var n=a[e].find(function(e){return e.element===t});return n?n.options:{}}function o(e,t,n){if(a[e]){var r=a[e].findIndex(function(e){return e.element===t});if(-1===r)a[e].push({element:t,options:n});else{var o=a[e][r].options||{};a[e][r].options=Object.assign(o,n)}}else a[e]=[{element:t,options:n}]}function i(e,t){var n=a[e];n&&(a[e]=n.filter(function(e){return e.element!==t}))}function s(e){delete a[e]}function l(e){for(var t in a)a[t]=a[t].filter(function(t){return t.element!==e})}},"./tools/CrosshairsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return j});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./tools/base/BaseTool.js"),v=n("./externalModules.js"),p=n("./stateManagement/loadHandlerManager.js"),b=n("./stateManagement/toolState.js"),y=(n("./stateManagement/toolColors.js"),n("./util/pointProjector.js")),x=n("./util/convertToVector3.js"),w=n("./toolOptions.js"),T=n("./tools/cursors/index.js"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.crosshairsCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.mouseDownCallback=e._chooseLocation.bind(f()(e)),e.mouseDragCallback=e._chooseLocation.bind(f()(e)),e.touchDragCallback=e._chooseLocation.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_chooseLocation",value:function(e){var t=e.detail,n=t.element;e.stopImmediatePropagation();var a=Object(b.getToolState)(n,this.name);if(a){var r=n,o=v.default.cornerstone.getEnabledElement(r).image.imageId,i=v.default.cornerstone.metaData.get("imagePlaneModule",o);if(i){var s=t.currentPoints.image,l=Object(y.imagePointToPatientPoint)(s,i);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,a=Object(b.getToolState)(e,"stack");if(void 0!==a){var o=a.data[0];if(o.imageIds.forEach(function(e,a){var r=v.default.cornerstone.metaData.get("imagePlaneModule",e);if(r&&r.imagePositionPatient&&r.rowCosines&&r.columnCosines){var o=Object(x.default)(r.imagePositionPatient),i=Object(x.default)(r.rowCosines),s=Object(x.default)(r.columnCosines).clone().cross(i.clone()),u=Math.abs(s.clone().dot(o)-s.clone().dot(l));u<t&&(t=u,n=a)}}),n!==o.currentImageIdIndex&&-1!==n&&void 0!==o.imageIds[n]){var i=p.default.getStartLoadHandler(),s=p.default.getEndLoadHandler(),u=p.default.getErrorLoadingHandler();i&&i(e),(!0===o.preventCache?v.default.cornerstone.loadImage(o.imageIds[n]):v.default.cornerstone.loadAndCacheImage(o.imageIds[n])).then(function(t){var a=v.default.cornerstone.getViewport(e);o.currentImageIdIndex=n,v.default.cornerstone.displayImage(e,t,a),s&&s(e,t)},function(t){var a=o.imageIds[n];u&&u(e,a,t)})}}}})}}}},{key:"activeCallback",value:function(e,t){var n=t.mouseButtonMask,a=t.synchronizationContext;Object(w.setToolOptions)(this.name,e,{mouseButtonMask:n}),Object(b.clearToolState)(e,this.name),Object(b.addToolState)(e,this.name,{synchronizationContext:a})}}]),t}(m.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"doubleTapCallback",value:function(e){var t=e.detail;h.default.cornerstone.fitToWindow(t.element)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./util/getRGBPixels.js"),x=n("./util/calculateSUV.js"),w=n("./drawing/index.js"),T=n("./drawing/drawTextBox.js"),j=n("./tools/cursors/index.js"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"DragProbe",strategies:{default:_,minimal:E},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:j.probeCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).touchDragCallback=e._movingEventCallback.bind(f()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(f()(e)),e.mouseDragCallback=e._movingEventCallback.bind(f()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(f()(e)),e.initialConfiguration=o,e.dragEventData={},e}return g()(t,e),i()(t,[{key:"_movingEventCallback",value:function(e){var t=e.detail,n=t.element;this.dragEventData=t,m.default.cornerstone.updateImage(n)}},{key:"_endMovingEventCallback",value:function(e){var t=e.detail.element;this.dragEventData={},m.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function(e){this.dragEventData.currentPoints&&e&&e.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(e.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(e))}}]),t}(v.default),_=function(e,t){var n=m.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=Object(w.getNewContext)(s.canvas),u=b.default.getActiveColor(),c=p.default.getFontSize(),d=Math.round(i.image.x),f=Math.round(i.image.y);d<0||f<0||d>=o.columns||f>=o.rows||Object(w.draw)(l,function(e){Object(w.setShadow)(e,t);var a,s,l="".concat(d,", ").concat(f);if(o.color)a=Object(y.default)(r,d,f,1,1),s="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]," A: ").concat(a[3]);else{var h=(a=n.getStoredPixels(r,d,f,1,1))[0],g=h*o.slope+o.intercept,m=Object(x.default)(o,h);s="SP: ".concat(h," MO: ").concat(parseFloat(g.toFixed(3))),m&&(s+=" SUV: ".concat(parseFloat(m.toFixed(3))))}var v={x:i.canvas.x+5,y:i.canvas.y-5};Object(T.default)(e,s,v.x,v.y+c+5,u),Object(T.default)(e,l,v.x,v.y,u)})},E=function(e,t){var n=m.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=a.isTouchEvent,u=Object(w.getNewContext)(s.canvas),c=b.default.getActiveColor(),d=i.page.y-p.default.getFontSize()/2;l&&(d=i.page.y-4*p.default.getFontSize());var f=n.pageToPixel(r,i.page.x,d);f.x<0||f.y<0||f.x>=o.columns||f.y>=o.rows||Object(w.draw)(u,function(e){Object(w.setShadow)(e,t);var a,i=n.metaData.get("generalSeriesModule",o.imageId),s=i&&i.modality,u="";if(o.color)a=Object(y.default)(r,f.x,f.y,1,1),u="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]);else{var d=(a=n.getStoredPixels(r,f.x,f.y,1,1))[0],h=d*o.slope+o.intercept,g=parseFloat(h.toFixed(2));if("CT"===s)u+="HU: ".concat(g);else if("PT"===s){u+=g;var m=Object(x.default)(o,d);m&&(u+=" SUV: ".concat(parseFloat(m.toFixed(2))))}else u+=g}var v=n.pixelToCanvas(r,f),b={x:12,y:-(p.default.getFontSize()+10)/2},j=Object(T.textBoxWidth)(e,u,5);l&&(b={x:-j/2,y:-p.default.getFontSize()-10-12}),Object(w.drawCircle)(e,r,v,6,{color:c},"canvas"),Object(T.default)(e,u,v.x+b.x,v.y+b.y,c)})}},"./tools/EraserTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./stateManagement/toolState.js"),b=n("./store/index.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:y.eraserCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.preMouseDownCallback=e._deleteAllNearbyTools.bind(f()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_deleteAllNearbyTools",value:function(e){var t=e.detail.currentPoints.canvas,n=e.detail.element;b.state.tools.forEach(function(e){var a=Object(p.getToolState)(n,e.name);a&&a.data.forEach(function(a){"function"==typeof e.pointNearTool&&e.pointNearTool(n,a,t)&&(Object(p.removeToolState)(n,e.name,a),m.default.cornerstone.updateImage(n))})});return!0}}]),t}(v.default)},"./tools/FreehandSculpterMouseTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return O});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./events.js"),v=n("./externalModules.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/drawHandles.js"),y=n("./store/index.js"),x=n("./stateManagement/toolState.js"),w=n("./util/clip.js"),T=n("./store/getToolForElement.js"),j=n("./tools/base/BaseTool.js"),C=n("./store/setToolCursor.js"),_=n("./tools/cursors/index.js"),E=n("./util/freehand/index.js"),M=E.default.FreehandHandleData,O=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"FreehandSculpterMouse",referencedToolName:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:p.default.getActiveColor(),hoverColor:p.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2},svgCursor:_.freehandSculpterMouseCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.initialConfiguration=o,e.referencedToolName=o.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(f()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(f()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=e.detail;if(null===this.configuration.currentTool)return!1;var n=t.element,a=this.configuration;if(!Object(x.getToolState)(n,this.referencedToolName).data[a.currentTool])return!1;if(this._active){var r=t.canvasContext.canvas.getContext("2d"),o={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(b.default)(r,t,this.configuration.mouseLocation.handles,o)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(e)}},{key:"doubleClickCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"doubleTapCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),v.default.cornerstone.updateImage(t.element)}},{key:"preTouchStartCallback",value:function(e){return this._initialiseSculpting(e),!0}},{key:"preMouseDownCallback",value:function(e){if(this.options.mouseButtonMask.includes(e.detail.buttons))return this._initialiseSculpting(e),!0}},{key:"activeMouseDragCallback",value:function(e){var t=this.configuration;if(this._active){var n=e.detail,a=Object(x.getToolState)(n.element,this.referencedToolName);if(a){var r=a.data[t.currentTool].handles.points;this._getMouseLocation(n),this._sculpt(n,r),v.default.cornerstone.updateImage(n.element)}}}},{key:"activeMouseUpCallback",value:function(e){this._activeEnd(e)}},{key:"activeTouchEndCallback",value:function(e){this._activeEnd(e),this._deselectAllTools(e),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(e){var t=e.detail,n=t.element,a=this.configuration;this._active=!1,y.state.isMultiPartToolActive=!1,this._getMouseLocation(t),this._invalidateToolData(t),a.mouseUpRender=!0,this._deactivateSculpt(n),v.default.cornerstone.updateImage(t.element),function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}(e)}},{key:"_renderHoverCursor",value:function(e){var t,n=e.detail,a=n.element,r=n.canvasContext.canvas.getContext("2d"),o=Object(x.getToolState)(a,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(t=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):t=y.state.mousePositionImage;var i=Object(T.default)(a,this.referencedToolName).distanceFromPointCanvas(a,o,t);if(this.configuration.mouseLocation.handles.start.x=t.x,this.configuration.mouseLocation.handles.start.y=t.y,this.configuration.limitRadiusOutsideRegion){var s=i;i=this._limitCursorRadiusCanvas(n,i),s>this.configuration.hoverCursorFadeDistance*i&&(r.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var l={fill:null,color:this.configuration.hoverColor,handleRadius:i};Object(b.default)(r,n,this.configuration.mouseLocation.handles,l),this.configuration.limitRadiusOutsideRegion&&(r.globalAlpha=1)}},{key:"newImageCallback",value:function(e){this._deselectAllTools(e)}},{key:"enabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"passiveCallback",value:function(e){this._deselectAllTools(e)}},{key:"disabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"_selectFreehandTool",value:function(e){var t=this.configuration,n=e.element,a=this._getClosestFreehandToolOnElement(n,e);void 0!==a&&(t.currentTool=a,Object(C.hideToolCursor)(n))}},{key:"_activateFreehandTool",value:function(e,t){var n=Object(x.getToolState)(e,this.referencedToolName).data;this.configuration.currentTool=t;for(var a=0;a<n.length;a++)n[a].active=a===t}},{key:"_initialiseSculpting",value:function(e){var t=e.detail,n=this.configuration,a=t.element;null===n.currentTool&&(this._selectFreehandTool(t),null===n.currentTool)||(this._active=!0,y.state.isMultiPartToolActive=!0,this._configureToolSize(t),this._getMouseLocation(t),this._activateFreehandTool(a,n.currentTool),this._activateSculpt(a),v.default.cornerstone.updateImage(t.element))}},{key:"_sculpt",value:function(e,t){var n=this.configuration;this._sculptData={element:e.element,image:e.image,mousePoint:e.currentPoints.image,points:t,toolSize:this._toolSizeImage,minSpacing:n.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*n.minSpacing)};var a=this._pushHandles();void 0!==a.first&&(this._insertNewHandles(a),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var e=this._sculptData,t=e.points,n=e.mousePoint,a=e.toolSize,r={},o=0;o<t.length;o++){var i=v.default.cornerstoneMath.point.distance(t[o],n);i>a||(this._pushOneHandle(o,i),void 0===r.first?(r.first=o,r.last=o):r.last=o)}return r}},{key:"_pushOneHandle",value:function(e,t){var n=this._sculptData,a=n.points,r=n.mousePoint,o=n.toolSize,i=n.image,s=a[e],l=(s.x-r.x)/t,u=(s.y-r.y)/t,c={x:r.x+o*l,y:r.y+o*u};Object(w.clipToBox)(c,i),s.x=c.x,s.y=c.y;var d=this.constructor._getPreviousHandleIndex(e,a.length);a[d].lines.pop(),a[d].lines.push(s)}},{key:"_insertNewHandles",value:function(e){for(var t=this._findNewHandleIndicies(e),n=0,a=0;a<t.length;a++){var r=t[a]+1+n;this._insertHandleRadially(r),n++}}},{key:"_findNewHandleIndicies",value:function(e){for(var t=this._sculptData,n=t.points,a=t.maxSpacing,r=[],o=e.first;o<=e.last;o++)this._checkSpacing(o,n,r,a);var i=this.constructor._getNextHandleIndex(e.last,n.length);if(i!==e.first){this._checkSpacing(i,n,r,a);var s=this.constructor._getPreviousHandleIndex(e.first,n.length);s!==i&&this._checkSpacing(s,n,r,a)}return r}},{key:"_checkSpacing",value:function(e,t,n,a){var r=this.constructor._getNextHandleIndex(e,t.length);v.default.cornerstoneMath.point.distance(t[e],t[r])>a&&n.push(e)}},{key:"_insertHandleRadially",value:function(e){var t=this._sculptData.points,n=e-1,a=this.constructor._getNextHandleIndexBeforeInsert(e,t.length),r=this._getInsertPosition(e,n,a),o=new M(r);t.splice(e,0,o),t[n].lines.pop(),t[n].lines.push(t[e]),E.default.addLine(t,e)}},{key:"_consolidateHandles",value:function(){if(!(this._sculptData.points.length<=3)){var e=this._findCloseHandlePairs();this._mergeCloseHandles(e)}}},{key:"_findCloseHandlePairs",value:function(){for(var e=this._sculptData,t=e.points,n=e.minSpacing,a=[],r=t.length,o=0;o<r;o++){var i=this.constructor._getNextHandleIndex(o,t.length);if(v.default.cornerstoneMath.point.distance(t[o],t[i])<n){var s=[o,i];a.push(s),0===o&&(r-=1),o++}}return a}},{key:"_mergeCloseHandles",value:function(e){for(var t=0,n=0;n<e.length;n++){var a=this.constructor._getCorrectedPair(e[n],t);this._combineHandles(a),t++}var r=this._findCloseHandlePairs();r.length&&this._mergeCloseHandles(r)}},{key:"_combineHandles",value:function(e){var t=this._sculptData,n=t.points,a=t.image,r={x:(n[e[0]].x+n[e[1]].x)/2,y:(n[e[0]].y+n[e[1]].y)/2};Object(w.clipToBox)(r,a),n[e[0]].x=r.x,n[e[0]].y=r.y;var o=this.constructor._getNextHandleIndex(e[1],n.length);n[e[0]].lines.pop(),n[e[0]].lines.push(n[o]),n.splice(e[1],1)}},{key:"_configureToolSize",value:function(e){var t=e.element,n=this.configuration,a=n.currentTool,r=e.currentPoints.image,o=Object(x.getToolState)(t,this.referencedToolName).data[a],i=Object(T.default)(t,this.referencedToolName),s=i.distanceFromPoint(t,o,r),l=i.distanceFromPointCanvas(t,o,r);n.limitRadiusOutsideRegion&&(s=this._limitCursorRadiusImage(e,s),l=this._limitCursorRadiusCanvas(e,l)),this._toolSizeImage=s,this._toolSizeCanvas=l}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(w.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_activateSculpt",value:function(e){this._deactivateSculpt(e),e.addEventListener(m.default.MOUSE_UP,this.activeMouseUpCallback),e.addEventListener(m.default.MOUSE_CLICK,this.activeMouseUpCallback),e.addEventListener(m.default.MOUSE_DRAG,this.activeMouseDragCallback),e.addEventListener(m.default.TOUCH_END,this.activeTouchEndCallback),e.addEventListener(m.default.TOUCH_TAP,this.activeTouchEndCallback),e.addEventListener(m.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_deactivateSculpt",value:function(e){e.removeEventListener(m.default.MOUSE_UP,this.activeMouseUpCallback),e.removeEventListener(m.default.MOUSE_CLICK,this.activeMouseUpCallback),e.removeEventListener(m.default.MOUSE_DRAG,this.activeMouseDragCallback),e.removeEventListener(m.default.TOUCH_END,this.activeTouchEndCallback),e.removeEventListener(m.default.TOUCH_TAP,this.activeTouchEndCallback),e.removeEventListener(m.default.TOUCH_DRAG,this.activeMouseDragCallback),v.default.cornerstone.updateImage(e)}},{key:"_invalidateToolData",value:function(e){var t=this.configuration,n=e.element;Object(x.getToolState)(n,this.referencedToolName).data[t.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function(e){var t=this.configuration,n=Object(x.getToolState)(this.element,this.referencedToolName);if(t.currentTool=null,n)for(var a=0;a<n.data.length;a++)n.data[a].active=!1;Object(C.setToolCursor)(this.element,this.svgCursor),v.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(e,t){return this._limitCursorRadius(e,t,!0)}},{key:"_limitCursorRadiusImage",value:function(e,t){return this._limitCursorRadius(e,t,!1)}},{key:"_limitCursorRadius",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.element,r=e.image,o=this.configuration,i=Object(x.getToolState)(a,this.referencedToolName).data[o.currentTool],s=1;if(n){var l=v.default.cornerstone.pixelToCanvas(a,{x:0,y:0}),u=v.default.cornerstone.pixelToCanvas(a,{x:r.width,y:r.height});s=(u.x-l.x)*(u.y-l.y)/(r.width*r.height)}var c=i.area*s,d=Math.pow(c/Math.PI,.5);return Math.min(t,d)}},{key:"_getClosestFreehandToolOnElement",value:function(e,t){var n=Object(T.default)(e,this.referencedToolName),a=Object(x.getToolState)(e,this.referencedToolName);if(a){for(var r=a.data,o=t.currentPoints.image,i={distance:1/0,toolIndex:null},s=0;s<r.length;s++){var l=n.distanceFromPoint(e,r[s],o);-1!==l&&(l<i.distance&&(i.distance=l,i.toolIndex=s))}return i.toolIndex}}},{key:"_getInsertPosition",value:function(e,t,n){var a,r=this._sculptData,o=r.points,i=r.toolSize,s=r.mousePoint,l=r.image,u={x:(o[t].x+o[n].x)/2,y:(o[t].y+o[n].y)/2},c=v.default.cornerstoneMath.point.distance(s,u);if(c<i){var d={x:(u.x-s.x)/c,y:(u.y-s.y)/c};a={x:s.x+i*d.x,y:s.y+i*d.y}}else a=u;return Object(w.clipToBox)(a,l),a}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=e}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=e}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=e,v.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");e=Math.max(Math.min(e,1),0),this.configuration.hoverCursorFadeAlpha=e,v.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");e=Math.max(e,1),this.configuration.hoverCursorFadeDistance=e,v.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(e,t){var n=[e[0]-t,e[1]-t];return n[1]<0&&(n[1]=0),n}},{key:"_getNextHandleIndex",value:function(e,t){return e===t-1?0:e+1}},{key:"_getPreviousHandleIndex",value:function(e,t){return 0===e?t-1:e-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(e,t){return e===t?0:e}}]),t}(j.default)},"./tools/MagnifyTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./drawing/index.js"),p=n("./tools/base/BaseTool.js"),b=n("./store/setToolCursor.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:y.magnifyCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(f()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(f()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(f()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(f()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(f()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(f()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(f()(e)),e.newImageCallback=e._drawMagnificationTool.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_addMagnifyingGlass",value:function(e){var t=this;this._removeZoomElement(),this._drawZoomedElement(e),window.requestAnimationFrame(function(){return t._drawMagnificationTool(e)}),Object(b.hideToolCursor)(e.detail.element),e.preventDefault(),e.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(e){this._drawMagnificationTool(e),e.preventDefault(),e.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(e){var t=e.detail.element;Object(b.setToolCursor)(this.element,this.svgCursor),t.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(e){var t=e.detail.element,n=t.querySelector(".magnifyTool");if(n||this._createMagnificationCanvas(t),void 0!==this.zoomCanvas){var a=t.querySelector("canvas:not(.magnifyTool)"),r=Object(v.getNewContext)(n),o=m.default.cornerstone.pixelToCanvas(e.detail.element,e.detail.currentPoints.image),i=Math.min(this.configuration.magnifySize,a.width,a.height),s=this.configuration.magnificationLevel;n.width=i,n.height=i,o.x=Math.max(o.x,.5*i/s),o.x=Math.min(o.x,a.width-.5*i/s),o.y=Math.max(o.y,.5*i/s),o.y=Math.min(o.y,a.height-.5*i/s);var l={x:o.x*s-.5*i,y:o.y*s-.5*i};l.x=Math.max(l.x,0),l.y=Math.max(l.y,0),r.drawImage(this.zoomCanvas,l.x,l.y,i,i,0,0,i,i);var u=e.detail.isTouchEvent?120:0,c={top:Math.max(o.y-.5*i-u,0),left:Math.max(o.x-.5*i,0)},d=n.getBoundingClientRect();c.top=Math.min(c.top,a.height-d.height),c.left=Math.min(c.left,a.width-d.width),n.style.top="".concat(c.top,"px"),n.style.left="".concat(c.left,"px"),n.style.display="block"}}},{key:"_drawZoomedElement",value:function(e){var t=e.detail.element,n=e.detail.enabledElement;void 0===n&&(n=m.default.cornerstone.getEnabledElement(t));var a=this.configuration.magnificationLevel,r=n.canvas,o=n.image;this.zoomElement=document.createElement("div"),this.zoomElement.width=r.width*a,this.zoomElement.height=r.height*a,m.default.cornerstone.enable(this.zoomElement,n.options);var i=m.default.cornerstone.getEnabledElement(this.zoomElement),s=m.default.cornerstone.getViewport(n.element);this.zoomCanvas=i.canvas,this.zoomCanvas.width=r.width*a,this.zoomCanvas.height=r.height*a,i.viewport=Object.assign({},s),s.scale*=a,m.default.cornerstone.displayImage(this.zoomElement,o),m.default.cornerstone.setViewport(this.zoomElement,s)}},{key:"_removeZoomElement",value:function(){void 0!==this.zoomElement&&(m.default.cornerstone.disable(this.zoomCanvas),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool"),t.width=this.configuration.magnifySize,t.height=this.configuration.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}},{key:"_destroyMagnificationCanvas",value:function(e){var t=e.detail.element,n=t.querySelector(".magnifyTool");n&&t.removeChild(n)}}]),t}(p.default)},"./tools/PanMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e.multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;if(t.numPointers===this.configuration.touchPointers){var r=this._getTranslation(t);this._applyTranslation(a,r),m.default.cornerstone.setViewport(n,a)}}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return b});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:p.panCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.touchDragCallback=e._dragCallback.bind(f()(e)),e.mouseDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=this._getTranslation(t);this._applyTranslation(a,r),m.default.cornerstone.setViewport(n,a)}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(v.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/regenerator/index.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=n.n(h),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(m),p=n("./externalModules.js"),b=n("./tools/base/BaseTool.js"),y=n("./drawing/index.js"),x=n("./tools/referenceLines/renderActiveReferenceLine.js"),w=n("./util/wait.js"),T=n("./util/logger.js"),j=Object(T.getLogger)("tools:ReferenceLinesTool"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l()(this,t);var a={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:x.default}},r=Object.assign(a,n);return(e=f()(this,g()(t).call(this,r))).initialConfiguration=r,e.renderer=null,e.synchronizationContext=null,e}return v()(t,e),c()(t,[{key:"enabledCallback",value:function(){var e=i()(r.a.mark(function e(t){var n,a,o,i=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},a=n.synchronizationContext,o=this.configuration.renderer,e.next=4,Object(w.waitForEnabledElementImageToLoad)(t);case 4:if(e.sent&&o&&a){e.next=8;break}return j.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),e.abrupt("return");case 8:this.renderer=o,this.synchronizationContext=a,this.forceImageUpdate(t);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){p.default.cornerstone.getEnabledElement(e).image&&p.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail;if(this.renderer&&this.synchronizationContext){var a=this.synchronizationContext.getSourceElements(),r=Object(y.getNewContext)(n.canvasContext.canvas);p.default.cornerstone.setToPixelCoordinateSystem(n.enabledElement,r),a.forEach(function(a){a!==e.currentTarget&&t.renderer(r,n,e.currentTarget,a)})}}}]),t}(b.default)},"./tools/RotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./util/angleBetweenPoints.js"),v=n("./tools/cursors/index.js"),p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Rotate",strategies:{default:b,horizontal:y,vertical:x},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:v.rotateCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){this.dragCallback(e)}},{key:"mouseDragCallback",value:function(e){this.dragCallback(e)}},{key:"postMouseDownCallback",value:function(e){this.initialRotation=e.detail.viewport.rotation}},{key:"dragCallback",value:function(e){e.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(e,this.configuration),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(g.default),b=function(e){var t=e.detail,n=t.element,a=t.viewport,r=a.initialRotation,o=n.getBoundingClientRect(n),i=n.clientWidth,s=n.clientHeight,l={x:t.startPoints.client.x,y:t.startPoints.client.y},u=a.scale,c=a.translation,d={x:o.left+i/2+c.x*u,y:o.top+s/2+c.y*u},f={x:t.currentPoints.client.x,y:t.currentPoints.client.y},h=Object(m.default)(d,l,f);h.direction<0&&(h.angle=-h.angle),a.rotation=r+h.angle},y=function(e){var t=e.detail,n=t.viewport,a=t.deltaPoints;n.rotation+=a.page.x/n.scale},x=function(e){var t=e.detail,n=t.viewport,a=t.deltaPoints;n.rotation+=a.page.y/n.scale}},"./tools/RotateTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"touchRotateCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=t.rotation;a.rotation+=r,h.default.cornerstone.setViewport(n,a)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./drawing/index.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./util/logger.js"),y=Object(b.getLogger)("tools:ScaleOverlayTool"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){h.default.cornerstone.getEnabledElement(e).image&&h.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(m.getNewContext)(t.canvasContext.canvas),a=t.image,r=t.viewport,o=t.element,i=a.rowPixelSpacing,s=a.columnPixelSpacing,l=h.default.cornerstone.metaData.get("imagePlaneModule",a.imageId);if(l&&(i=l.rowPixelSpacing||l.rowImagePixelSpacing,s=l.columnPixelSpacing||l.colImagePixelSpacing),i&&s){var u={width:n.canvas.width,height:n.canvas.height},c=10/i*r.scale,d=10/s*r.scale,f=w(u,.25,.05),g=w(u,.05,.15);if(u.width&&u.height&&f&&g){var b=p.default.getToolColor(),x=v.default.getToolWidth(),C=Object.assign({},{hscaleBounds:f,vscaleBounds:g,verticalMinorTick:c,horizontalMinorTick:d,verticalLine:{start:{x:g.bottomRight.x,y:g.topLeft.y},end:{x:g.bottomRight.x,y:g.bottomRight.y}},horizontalLine:{start:{x:f.topLeft.x,y:f.bottomRight.y},end:{x:f.bottomRight.x,y:f.bottomRight.y}},color:b,lineWidth:x},this.configuration);Object(m.draw)(n,function(e){Object(m.setShadow)(e,C),Object(m.drawLine)(e,o,C.verticalLine.start,C.verticalLine.end,{color:b,lineWidth:x},"canvas"),T(e,o,C),Object(m.drawLine)(e,o,C.horizontalLine.start,C.horizontalLine.end,{color:b,lineWidth:x},"canvas"),j(e,o,C)})}}else y.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"))}}]),t}(g.default),w=function(e,t,n){var a=t*Math.min(1e3,e.width),r=n*Math.min(1e3,e.height),o={left:a,top:r,width:e.width-2*a,height:e.height-2*r};return{topLeft:{x:o.left,y:o.top},bottomRight:{x:o.left+o.width,y:o.top+o.height}}},T=function(e,t,n){for(var a=0;n.verticalLine.start.y+a*n.verticalMinorTick<=n.vscaleBounds.bottomRight.y;){var r=n.color,o=n.lineWidth,i={x:n.verticalLine.start.x,y:n.verticalLine.start.y+a*n.verticalMinorTick},s={x:0,y:n.verticalLine.start.y+a*n.verticalMinorTick};s.x=a%5==0?n.verticalLine.start.x-n.majorTickLength:n.verticalLine.start.x-n.minorTickLength,Object(m.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}},j=function(e,t,n){for(var a=0;n.horizontalLine.start.x+a*n.horizontalMinorTick<=n.hscaleBounds.bottomRight.x;){var r=n.color,o=n.lineWidth,i={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:n.horizontalLine.start.y},s={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:0};s.y=a%5==0?n.horizontalLine.start.y-n.majorTickLength:n.horizontalLine.start.y-n.minorTickLength,Object(m.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./tools/base/BaseTool.js"),g=n("./util/scroll.js"),m=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.direction,a=t.element,r=this.configuration,o=r.loop,i=r.allowSkipping,s=r.invert?-n:n;Object(g.default)(a,s,o,i)}}]),t}(h.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return y});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e.multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail;if(t.numPointers===this.configuration.touchPointers){var n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(!l)return;if(Math.abs(u)>=l){var c=Math.round(u/l);Object(v.default)(n,c,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(n.imageIds.length,8))}}}]),t}(m.default)},"./tools/StackScrollTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./tools/base/BaseTool.js"),v=n("./util/scroll.js"),p=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:y.stackScrollCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.mouseDragCallback=e._dragCallback.bind(f()(e)),e.touchDragCallback=e._dragCallback.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(l){if(Math.abs(u)>=l){var c=Math.round(u/l);Object(v.default)(n,c,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(p.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(n.imageIds.length,8))}}}]),t}(m.default)},"./tools/WwwcRegionTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./tools/base/BaseTool.js"),p=n("./drawing/index.js"),b=n("./util/clip.js"),y=n("./util/getLuminance.js"),x=n("./stateManagement/toolColors.js"),w=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:w.wwwcRegionCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(f()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.touchEndCallback=e._applyStrategy.bind(f()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(f()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(f()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseUpCallback=e._applyStrategy.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=x.default.getColorIfActive({active:!0}),o=Object(p.getNewContext)(n.canvasContext.canvas);Object(p.draw)(o,function(e){Object(p.drawRect)(e,a,t.handles.start,t.handles.end,{color:r})})}},{key:"_startOutliningRegion",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;return j(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),m.default.cornerstone.updateImage(t),!0}},{key:"_setHandlesAndUpdate",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;this.handles.end=n,m.default.cornerstone.updateImage(t)}},{key:"_applyStrategy",value:function(e){j(this.handles.start)||j(this.handles.end)||(e.detail.handles=this.handles,C(e,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),t}(v.default),j=function(e){return 0===Object.keys(e).length&&e.constructor===Object},C=function(e,t){var n=e.detail,a=n.image,r=n.element,o=e.detail.handles,i=o.start,s=o.end,l=Math.min(i.x,s.x),u=Math.min(i.y,s.y),c=Math.abs(i.x-s.x),d=Math.abs(i.y-s.y);l=Object(b.default)(l,0,a.width),u=Object(b.default)(u,0,a.height),c=Math.floor(Math.min(c,Math.abs(a.width-l))),d=Math.floor(Math.min(d,Math.abs(a.height-u)));var f=Object(y.default)(r,l,u,c,d),h=_(f,a.minPixelValue,a.maxPixelValue),g=n.viewport;void 0===t.minWindowWidth&&(t.minWindowWidth=10),g.voi.windowWidth=Math.max(Math.abs(h.max-h.min),t.minWindowWidth),g.voi.windowCenter=h.mean,m.default.cornerstone.setViewport(r,g),m.default.cornerstone.updateImage(r)},_=function(e,t,n){var a=e.length,r=n,o=t,i=0;if(a<2)return{min:r,max:o,mean:(t+n)/2};for(var s=0;s<a;s++){var l=e[s];r=Math.min(r,l),o=Math.max(o,l),i+=l}return{min:r,max:o,mean:i/a}}},"./tools/WwwcTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./tools/cursors/index.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Wwwc",strategies:{basicLevelingStrategy:p},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:m.wwwcCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"mouseDragCallback",value:function(e){this.applyActiveStrategy(e),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}},{key:"touchDragCallback",value:function(e){e.stopImmediatePropagation(),this.applyActiveStrategy(e),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(g.default);function p(e,t){var n=t.orientation,a=e.detail,r=(a.image.maxPixelValue*a.image.slope+a.image.intercept-(a.image.minPixelValue*a.image.slope+a.image.intercept))/1024,o=a.deltaPoints.page.x*r,i=a.deltaPoints.page.y*r;0===n?(a.viewport.voi.windowWidth+=o,a.viewport.voi.windowCenter+=i):(a.viewport.voi.windowWidth+=i,a.viewport.voi.windowCenter+=o)}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./util/zoom/index.js"),v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=t.spinY,o=this.configuration,i=o.invert,s=o.maxScale,l=o.minScale,u=i?r/4:-r/4,c=Object(m.changeViewportScale)(a,u,{maxScale:s,minScale:l});h.default.cornerstone.setViewport(n,c)}}]),t}(g.default)},"./tools/ZoomTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./util/clip.js"),v=n("./util/zoom/index.js"),p=n("./tools/cursors/index.js"),b=v.default.correctShift,y=v.default.changeViewportScale,x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Zoom",strategies:{default:T,translate:j,zoomToCenter:C},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:p.zoomCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){w.call(this,e)}},{key:"mouseDragCallback",value:function(e){w.call(this,e)}}]),t}(g.default),w=function(e){if(!e.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(e,this.configuration),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)};function T(e,t){var n=t.invert,a=t.maxScale,r=t.minScale,o=e.detail.deltaPoints.page.y,i=n?-o/100:o/100,s=e.detail,l=s.element,u=s.viewport,c=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],d=c[0],f=c[1],g=c[2],m=c[3],v=y(u,i,{maxScale:a,minScale:r});h.default.cornerstone.setViewport(l,v);var p=h.default.cornerstone.pageToPixel(l,d,f),x={x:g-p.x,y:m-p.y};x=b(x,v),u.translation.x-=x.x,u.translation.y-=x.y}function j(e,t){var n=t.invert,a=t.preventZoomOutsideImage,r=t.maxScale,o=t.minScale,i=e.detail.deltaPoints.page.y,s=n?-i/100:i/100,l=e.detail.image,u=e.detail.viewport,c=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],d=c[0],f=c[1],h=y(u,s,{maxScale:r,minScale:o}),g={x:0,y:0};if(s<0)h.scale<3&&(Math.abs(h.translation.x)<.01?h.translation.x=0:g.x=h.translation.x/8,Math.abs(h.translation.y)<.01?h.translation.y=0:g.y=h.translation.y/8);else{a&&Object(m.clipToBox)(e.detail.startPoints.image,l);var v={x:l.width/2-d,y:l.height/2-f};v=b(v,h);var p={x:h.translation.x-v.x,y:h.translation.y-v.y};Math.abs(p.x)<.01?h.translation.x=v.x:g.x=p.x/8,Math.abs(p.y)<.01?h.translation.y=v.y:g.y=p.y/8}h.translation.x-=g.x,h.translation.y-=g.y}function C(e,t){var n=t.invert,a=t.maxScale,r=t.minScale,o=e.detail.deltaPoints.page.y,i=n?-o/100:o/100,s=e.detail.viewport;y(s,i,{maxScale:a,minScale:r})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseTool.js"),m=n("./util/zoom/index.js").default.correctShift,v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a=Object.assign({name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}},n);return(e=l()(this,c()(t).call(this,a))).initialConfiguration=a,e}return f()(t,e),i()(t,[{key:"touchPinchCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=t.scaleChange,o=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],i=o[0],s=o[1],l=o[2],u=o[3],c=this.configuration,d=c.maxScale,f=c.minScale;a.scale+=r*a.scale,d&&a.scale>d?a.scale=d:f&&a.scale<f&&(a.scale=f),h.default.cornerstone.setViewport(n,a);var g=h.default.cornerstone.pageToPixel(n,i,s),v={x:l-g.x,y:u-g.y};v=m(v,a),a.translation.x-=v.x,a.translation.y-=v.y,h.default.cornerstone.setViewport(n,a)}}]),t}(g.default)},"./tools/annotation/AngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/index.js"),y=n("./drawing/index.js"),x=n("./drawing/drawLinkedTextBox.js"),w=n("./drawing/drawTextBox.js"),T=n("./drawing/drawHandles.js"),j=n("./util/lineSegDistance.js"),C=n("./util/roundToDecimal.js"),_=n("./tools/cursors/index.js"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_.angleCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&(Object(j.default)(e,t.handles.start,t.handles.middle,n)<25||Object(j.default)(e,t.handles.middle,t.handles.end,n)<25)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.enabledElement,r=this.configuration,o=r.handleRadius,i=r.drawHandlesOnHover,s=Object(m.getToolState)(e.currentTarget,this.name);if(s)for(var l=Object(y.getNewContext)(n.canvasContext.canvas),u=v.default.getToolWidth(),c=function(e){var r=s.data[e];if(!1===r.visible)return"continue";Object(y.draw)(l,function(e){Object(y.setShadow)(e,t.configuration);var s=p.default.getColorIfActive(r),l=h.default.cornerstone.pixelToCanvas(n.element,r.handles.start),c=h.default.cornerstone.pixelToCanvas(n.element,r.handles.middle);Object(y.drawJoinedLines)(e,n.element,r.handles.start,[r.handles.middle,r.handles.end],{color:s});var d={color:s,handleRadius:o,drawHandlesIfActive:i};Object(T.default)(e,n,r.handles,d);var g=n.image.columnPixelSpacing||1,m=n.image.rowPixelSpacing||1,v={x:(r.handles.middle.x-r.handles.start.x)*g,y:(r.handles.middle.y-r.handles.start.y)*m},b={x:(r.handles.end.x-r.handles.middle.x)*g,y:(r.handles.end.y-r.handles.middle.y)*m},j={x:(r.handles.end.x-r.handles.start.x)*g,y:(r.handles.end.y-r.handles.start.y)*m},_=M(v),E=M(b),O=M(j),I=Math.acos((Math.pow(_,2)+Math.pow(E,2)-Math.pow(O,2))/(2*_*E));if(I*=180/Math.PI,r.rAngle=Object(C.default)(I,2),r.rAngle){var S,P=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+a}(r,n.image.rowPixelSpacing,n.image.columnPixelSpacing);if(!r.handles.textBox.hasMoved){S={x:c.x,y:c.y};var k=Object(w.textBoxWidth)(e,P,5);c.x<l.x?S.x-=15+k+10:S.x+=15;var L=h.default.cornerstone.internal.getTransform(a);L.invert();var D=L.transformPoint(S.x,S.y);r.handles.textBox.x=D.x,r.handles.textBox.y=D.y}Object(x.default)(e,n.element,r.handles.textBox,P,r.handles,f,s,u,0,!0)}})},d=0;d<s.data.length;d++)c(d);function f(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,e.preventDefault(),e.stopPropagation();var a=e.detail,r=this.createNewMeasurement(a),o=e.detail.element;Object(m.addToolState)(o,this.name,r),h.default.cornerstone.updateImage(o);var i=Object.assign({},{doneMovingCallback:function(){r.active=!1,n.preventNewMeasurement=!1,h.default.cornerstone.updateImage(o)}},this.options),s=Object.assign({},{doneMovingCallback:function(){r.active=!1,r.handles.end.active=!0,h.default.cornerstone.updateImage(o),Object(b.moveNewHandle)(a,n.name,r,r.handles.end,i,t)}},this.options);Object(b.moveNewHandle)(a,this.name,r,r.handles.middle,s,t)}}}]),t}(g.default);function M(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return O});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/textStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./manipulators/index.js"),y=n("./util/pointInsideBoundingBox.js"),x=n("./util/lineSegDistance.js"),w=n("./stateManagement/toolState.js"),T=n("./drawing/drawLinkedTextBox.js"),j=n("./drawing/index.js"),C=n("./drawing/drawArrow.js"),_=n("./drawing/drawHandles.js"),E=n("./drawing/drawTextBox.js"),M=n("./tools/cursors/index.js"),O=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:I,changeTextCallback:S,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},svgCursor:M.arrowAnnotateCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&Object(x.default)(e,t.handles.start,t.handles.end,n)<25}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=n.enabledElement,o=this.configuration,i=o.handleRadius,s=o.drawHandlesOnHover,l=Object(w.getToolState)(a,this.name);if(l)for(var u=e.detail.canvasContext.canvas,c=Object(j.getNewContext)(u),d=m.default.getToolWidth(),f=function(n){var o=l.data[n];if(!1===o.visible)return"continue";Object(j.draw)(c,function(n){Object(j.setShadow)(n,t.configuration);var l=p.default.getColorIfActive(o),u=h.default.cornerstone.pixelToCanvas(a,o.handles.start),c=h.default.cornerstone.pixelToCanvas(a,o.handles.end);t.configuration.arrowFirst?Object(C.default)(n,c,u,l,d):Object(C.default)(n,u,c,l,d);var f={color:l,handleRadius:i,drawHandlesIfActive:s};t.configuration.drawHandles&&Object(_.default)(n,e.detail,o.handles,f);var g=function(e){return e.text}(o);if(g&&""!==g){var m=Object(E.textBoxWidth)(n,g,5),y=v.default.getFontSize()+10,x=Math.max(m,y)/2+5;if(c.x<u.x&&(x=-x),!o.handles.textBox.hasMoved){var w;w=t.configuration.arrowFirst?{x:c.x-m/2+x,y:c.y-y/2}:{x:u.x-m/2-x,y:u.y-y/2};var M=h.default.cornerstone.internal.getTransform(r);M.invert();var O=M.transformPoint(w.x,w.y);o.handles.textBox.x=O.x,o.handles.textBox.y=O.y}Object(T.default)(n,a,o.handles.textBox,g,o.handles,b,l,d,0,!1)}})},g=0;g<l.data.length;g++)f(g);function b(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this,a=e.detail.element,r=this.createNewMeasurement(e);Object(w.addToolState)(a,this.name,r),h.default.cornerstone.updateImage(a);var o=Object.assign({},{doneMovingCallback:function(){void 0===r.text&&n.configuration.getTextCallback(function(e){e?r.text=e:Object(w.removeToolState)(a,n.name,r),r.active=!1,h.default.cornerstone.updateImage(a)}),h.default.cornerstone.updateImage(a)}},this.options);Object(b.moveNewHandle)(e.detail,this.name,r,r.handles.end,o,t)}},{key:"doubleClickCallback",value:function(e){if(Array.isArray(this.options.mouseButtonMask)&&this.options.mouseButtonMask.includes(e.detail.buttons))return this._updateTextForNearbyAnnotation(e)}},{key:"touchPressCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"_updateTextForNearbyAnnotation",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.canvas,a=Object(w.getToolState)(t,this.name);if(!a)return!1;for(var r=0;r<a.data.length;r++){var o=a.data[r];if(this.pointNearTool(t,o,n)||Object(y.default)(o.handles.textBox,n))return o.active=!0,h.default.cornerstone.updateImage(t),this.configuration.changeTextCallback(o,e.detail,this._doneChangingTextCallback.bind(this,t,o)),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(e,t,n,a){!0===a?Object(w.removeToolState)(e,this.name,t):t.text=n,t.active=!1,h.default.cornerstone.updateImage(e)}}]),t}(g.default);function I(e){e(prompt("Enter your annotation:"))}function S(e,t,n){n(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./tools/base/BaseAnnotationTool.js"),g=n("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),m=n("./tools/annotation/bidirectionalTool/pointNearTool.js"),v=n("./tools/annotation/bidirectionalTool/renderToolData.js"),p=n("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),b=n("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),y=n("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),x=n("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),w=n("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),T=(n("./stateManagement/toolColors.js"),n("./tools/cursors/index.js")),j=function(e,t,n){return n()},C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:j,getMeasurementLocationCallback:j,textBox:"",shadow:"",drawHandlesOnHover:!0,additionalData:[]},svgCursor:T.bidirectionalCursor},o=Object.assign(a.configuration,n),s=Object.assign(a,{configuration:o});return(e=i()(this,l()(t).call(this,s))).createNewMeasurement=g.default.bind(c()(e)),e.pointNearTool=m.default.bind(c()(e)),e.renderToolData=v.default.bind(c()(e)),e.addNewMeasurement=p.default.bind(c()(e)),e._moveCallback=b.default.bind(c()(e)),e.handleSelectedCallback=y.default.bind(c()(e)),e.handleSelectedMouseCallback=x.default.bind(c()(e)),e.handleSelectedTouchCallback=w.default.bind(c()(e)),e}return f()(t,e),t}(h.default)},"./tools/annotation/CobbAngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return M});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/textStyle.js"),v=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./manipulators/index.js"),x=n("./drawing/index.js"),w=n("./drawing/drawHandles.js"),T=n("./drawing/drawLinkedTextBox.js"),j=n("./util/lineSegDistance.js"),C=n("./util/roundToDecimal.js"),_=n("./events.js"),E=n("./tools/cursors/index.js"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.cobbAngleCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.hasIncomplete=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,complete:!1,value:"",handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:e.currentPoints.image.x+1,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&(!this.hasIncomplete&&(Object(j.default)(e,t.handles.start,t.handles.end,n)<25||Object(j.default)(e,t.handles.start2,t.handles.end2,n)<25))}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=Object(v.getToolState)(e.currentTarget,this.name);if(i)for(var s=Object(x.getNewContext)(n.canvasContext.canvas),l=p.default.getToolWidth(),u=m.default.getFont(),c=function(e){var a=i.data[e];if(!1===a.visible)return"continue";Object(x.draw)(s,function(e){Object(x.setShadow)(e,t.configuration);var i=b.default.getColorIfActive(a);Object(x.drawLine)(e,n.element,a.handles.start,a.handles.end,{color:i}),a.complete&&Object(x.drawLine)(e,n.element,a.handles.start2,a.handles.end2,{color:i});var s={color:i,handleRadius:r,drawHandlesIfActive:o};Object(w.default)(e,n,a.handles,s),e.fillStyle=i;var c=a.value;if(!a.handles.textBox.hasMoved){var d={x:(a.handles.start.x+a.handles.end.x)/2,y:(a.handles.start.y+a.handles.end.y)/2-10};e.font=u,a.handles.textBox.x=d.x,a.handles.textBox.y=d.y}Object(T.default)(e,n.element,a.handles.textBox,c,a.handles,f,i,l,0,!0)})},d=0;d<i.data.length;d++)c(d);function f(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function(e){var t=Object(v.getToolState)(e,this.name);if(void 0!==t)for(var n=0;n<t.data.length;n++)if(!1===t.data[n].complete)return t.data[n]}},{key:"addNewMeasurement",value:function(e,t){e.preventDefault(),e.stopPropagation();var n,a,r=e.detail,o=e.detail.element,i=this.getIncomplete(o);i?((n=i).complete=!0,n.handles.start2={x:r.currentPoints.image.x,y:r.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},n.handles.end2={x:r.currentPoints.image.x,y:r.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},a=n.handles.end2,this.hasIncomplete=!1):(n=this.createNewMeasurement(r),Object(v.addToolState)(o,this.name,n),a=n.handles.end),h.default.cornerstone.updateImage(o),Object(y.moveNewHandle)(r,this.name,n,a,this.options,t)}},{key:"onMeasureModified",value:function(e){var t=h.default.cornerstone.getEnabledElement(e.detail.element).image;if(e.detail.toolName===this.name){var n=e.detail.measurementData;n.value=function(e,t){var n=t.columnPixelSpacing||1,a=t.rowPixelSpacing||1,r=(Math.ceil(e.handles.start.x)-Math.ceil(e.handles.end.x))*n,o=(Math.ceil(e.handles.start.y)-Math.ceil(e.handles.end.y))*a,i=(Math.ceil(e.handles.start2.x)-Math.ceil(e.handles.end2.x))*n,s=(Math.ceil(e.handles.start2.y)-Math.ceil(e.handles.end2.y))*a,l=Math.acos(Math.abs((r*i+o*s)/(Math.sqrt(r*r+o*o)*Math.sqrt(i*i+s*s))));l*=180/Math.PI;var u=Object(C.default)(l,2);if(!Number.isNaN(e.rAngle))return function(e,t,n){var a=t&&n?"":" (isotropic)";return e.toString()+String.fromCharCode(parseInt("00B0",16))+a}(u,t.rowPixelSpacing,t.columnPixelSpacing);return""}(n,t)}}},{key:"activeCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(e){e.removeEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(e){e.removeEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(g.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./util/calculateSUV.js"),x=n("./util/ellipse/index.js"),w=n("./util/numbersWithCommas.js"),T=n("./util/throttle.js"),j=n("./tools/cursors/index.js"),C=n("./util/logger.js"),_=Object(C.getLogger)("tools:annotation:EllipticalRoiTool"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:j.ellipticalRoiCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};_.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||_.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var o="mouse"===a?15:25,i=h.default.cornerstone.pixelToCanvas(e,t.handles.start),s=h.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x)+o/2,top:Math.min(i.y,s.y)+o/2,width:Math.abs(i.x-s.x)-o,height:Math.abs(i.y-s.y)-o},u={left:Math.min(i.x,s.x)-o/2,top:Math.min(i.y,s.y)-o/2,width:Math.abs(i.x-s.x)+o,height:Math.abs(i.y-s.y)+o},c=Object(x.pointInEllipse)(l,n);return!(!Object(x.pointInEllipse)(u,n)||c)}},{key:"renderToolData",value:function(e){var t=this,n=Object(m.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=v.default.getToolWidth(),s=this.configuration,l=s.handleRadius,u=s.drawHandlesOnHover,c=Object(b.getNewContext)(a.canvasContext.canvas),d=h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{},f=h.default.cornerstone.metaData.get("imagePlaneModule",r.imageId),g=d.modality,y=f&&f.rowPixelSpacing&&f.columnPixelSpacing,x={rowPixelSpacing:(f=f||{}).rowPixelSpacing||1,columnPixelSpacing:f.columnPixelSpacing||1};Object(b.draw)(c,function(e){for(var s=0;s<n.data.length;s++){var c=n.data[s];if(!1!==c.visible){var d=p.default.getColorIfActive(c),f={color:d,handleRadius:l,drawHandlesIfActive:u};Object(b.setShadow)(e,t.configuration),Object(b.drawEllipse)(e,o,c.handles.start,c.handles.end,{color:d}),Object(b.drawHandles)(e,a,c.handles,f),!0===c.invalidated&&(c.cachedStats?M(r,o,c,g,x):O(r,o,c,g,x)),c.handles.textBox.hasMoved||(c.handles.textBox.x=Math.max(c.handles.start.x,c.handles.end.x),c.handles.textBox.y=(c.handles.start.y+c.handles.end.y)/2);var h=I(e,r.color,c.cachedStats,g,y,t.configuration);Object(b.drawLinkedTextBox)(e,o,c.handles.textBox,h,c.handles,function(e){return t=e.start,n=e.end,a=S(t,n),r=a.left,o=a.top,i=a.width,s=a.height,[{x:r+i/2,y:o},{x:r,y:o+s/2},{x:r+i/2,y:o+s},{x:r+i,y:o+s/2}];var t,n,a,r,o,i,s},d,i,0,!0)}}})}}}]),t}(g.default),M=Object(T.default)(O,110);function O(e,t,n,a,r){var o=function(e,t,n,a,r){var o,i=S(n.start,n.end),s=h.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),l=Object(x.calculateEllipseStatistics)(s,i);"PT"===a&&(o={mean:Object(y.default)(e,l.mean,!0)||0,stdDev:Object(y.default)(e,l.stdDev,!0)||0});return{area:Math.PI*(i.width*(r.columnPixelSpacing||1)/2)*(i.height*(r.rowPixelSpacing||1)/2)||0,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,r=n.mean,o=n.stdDev,i=n.min,s=n.max,l=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=d.showMinMax||!1,h=!1!==d.showHounsfieldUnits,g=[],m=[];if(!t){var v=l&&0!==l.mean,p="CT"===u&&h?" HU":"",b="Mean: ".concat(Object(w.default)(r.toFixed(2))).concat(p),y="Std Dev: ".concat(Object(w.default)(o.toFixed(2))).concat(p);if(v){for(var x="".concat(" SUV: ").concat(Object(w.default)(l.mean.toFixed(2))),T="".concat(" SUV: ").concat(Object(w.default)(l.stdDev.toFixed(2))),j=Math.floor(e.measureText("".concat(y,"     ")).width);e.measureText(b).width<j;)b+=" ";m.push("".concat(b).concat(x)),m.push("".concat(y,"     ").concat(T))}else m.push("".concat(b,"     ").concat(y));if(f){for(var C="Min: ".concat(i).concat(p),_="Max: ".concat(s).concat(p),E=v?Math.floor(e.measureText("".concat(y,"     ")).width):Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(C).width<E;)C+=" ";m.push("".concat(C).concat(_))}}return g.push(function(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(w.default)(e.toFixed(2))).concat(n)}(a,c)),m.forEach(function(e){return g.push(e)}),g}function S(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandMouseTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return z});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),g=n.n(h),m=n("../node_modules/@babel/runtime/helpers/inherits.js"),v=n.n(m),p=n("./events.js"),b=n("./externalModules.js"),y=n("./tools/base/BaseAnnotationTool.js"),x=n("./stateManagement/toolState.js"),w=n("./stateManagement/toolStyle.js"),T=n("./stateManagement/toolColors.js"),j=n("./store/index.js"),C=n("./util/findAndMoveHelpers.js"),_=n("./util/pointInsideBoundingBox.js"),E=n("./util/calculateSUV.js"),M=n("./util/numbersWithCommas.js"),O=n("./drawing/index.js"),I=n("./drawing/drawLinkedTextBox.js"),S=n("./drawing/drawHandles.js"),P=n("./util/clip.js"),k=n("./store/setToolCursor.js"),L=n("./tools/cursors/index.js"),D=n("./util/freehand/index.js"),A=n("./util/logger.js"),R=Object(A.getLogger)("tools:annotation:FreehandMouseTool"),H=D.default.insertOrDelete,B=D.default.freehandArea,U=D.default.calculateFreehandStatistics,N=D.default.freehandIntersect,F=D.default.FreehandHandleData,z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t);var a={name:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1},svgCursor:L.freehandMouseCursor},r=Object.assign(a,n);return(e=c()(this,f()(t).call(this,r))).initialConfiguration=r,e.isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(g()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(g()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(g()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(g()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(g()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(g()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(g()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(g()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(g()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(g()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(g()(e)),e}return v()(t,e),l()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return t.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},t}R.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.points;if(!a)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!(!a||!1===t.visible)&&void 0!==this._pointNearHandle(e,t,n)}},{key:"distanceFromPoint",value:function(e,t,n){for(var a=1/0,r=0;r<t.handles.points.length;r++){var o=b.default.cornerstoneMath.point.distance(t.handles.points[r],n);a=Math.min(a,o)}return a===1/0?-1:a}},{key:"distanceFromPointCanvas",value:function(e,t,n){var a=1/0;if(!t)return-1;for(var r=b.default.cornerstone.pixelToCanvas(e,n),o=t.handles.points,i=0;i<o.length;i++){var s=b.default.cornerstone.pixelToCanvas(e,o[i]),l=b.default.cornerstoneMath.point.distance(s,r);a=Math.min(a,l)}return a===1/0?-1:a}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=Object(x.getToolState)(e.currentTarget,this.name);if(a)for(var o=n.image,i=n.element,s=this.configuration,l=b.default.cornerstone.metaData.get("generalSeriesModule",o.imageId),u=l?l.modality:null,c=Object(O.getNewContext)(n.canvasContext.canvas),d=w.default.getToolWidth(),f=function(e){var l=a.data[e];if(!1===l.visible)return"continue";Object(O.draw)(c,function(e){var a,c=T.default.getColorIfActive(l);if(l.active?l.handles.invalidHandlePlacement?(c=s.invalidColor,a=s.invalidColor):(c=T.default.getColorIfActive(l),a=T.default.getFillColor()):a=T.default.getToolColor(),l.handles.points.length)for(var f=0;f<l.handles.points.length;f++){var h=r()(l.handles.points[f].lines);f!==l.handles.points.length-1||l.polyBoundingBox||h.push(s.mouseLocation.handles.start),Object(O.drawJoinedLines)(e,n.element,l.handles.points[f],h,{color:c})}var m,v,p,y={color:c,fill:a};if((s.alwaysShowHandles||l.active&&l.polyBoundingBox)&&(y.handleRadius=s.activeHandleRadius,Object(S.default)(e,n,l.handles.points,y)),l.canComplete){y.handleRadius=s.completeHandleRadius;var x=l.handles.points[0];Object(S.default)(e,n,[x],y)}if(l.active&&!l.polyBoundingBox){y.handleRadius=s.activeHandleRadius,Object(S.default)(e,n,s.mouseLocation.handles,y);var w=l.handles.points[0];Object(S.default)(e,n,[w],y)}if(!1===l.invalidated)v=l.meanStdDev,p=l.meanStdDevSUV,m=l.area;else if(!l.active){for(var j=l.handles.points,C={left:j[0].x,right:j[0].x,bottom:j[0].y,top:j[0].x},_=0;_<j.length;_++)C.left=Math.min(C.left,j[_].x),C.right=Math.max(C.right,j[_].x),C.bottom=Math.min(C.bottom,j[_].y),C.top=Math.max(C.top,j[_].y);var P={left:C.left,top:C.bottom,width:Math.abs(C.right-C.left),height:Math.abs(C.top-C.bottom)};if(l.polyBoundingBox=P,!o.color){var k=b.default.cornerstone.getPixels(i,P.left,P.top,P.width,P.height);v=U.call(t,k,P,l.handles.points),"PT"===u&&(p={mean:Object(E.default)(o,(v.mean-o.intercept)/o.slope),stdDev:Object(E.default)(o,(v.stdDev-o.intercept)/o.slope)}),v&&!isNaN(v.mean)&&(l.meanStdDev=v,l.meanStdDevSUV=p)}var L=(o.columnPixelSpacing||1)*(o.rowPixelSpacing||1);m=B(l.handles.points,L),isNaN(m)||(l.area=m),l.invalidated=!1}if(l.polyBoundingBox&&!l.handles.textBox.freehand){l.handles.textBox.hasMoved||(l.handles.textBox.x=l.polyBoundingBox.left+l.polyBoundingBox.width,l.handles.textBox.y=l.polyBoundingBox.top+l.polyBoundingBox.height/2);var D=function(e){var t=e.meanStdDev,n=e.meanStdDevSUV,a=e.area,r=[];if(t&&void 0!==t.mean){var i="";"CT"===u&&(i=" HU");var s="Mean: ".concat(Object(M.default)(t.mean.toFixed(2))).concat(i),l="StdDev: ".concat(Object(M.default)(t.stdDev.toFixed(2))).concat(i);if(n&&void 0!==n.mean){s+=" SUV: "+Object(M.default)(n.mean.toFixed(2)),l+=" SUV: "+Object(M.default)(n.stdDev.toFixed(2))}r.push(s),r.push(l)}if(a){var c=" mm".concat(String.fromCharCode(178));o.rowPixelSpacing&&o.columnPixelSpacing||(c=" pixels".concat(String.fromCharCode(178)));var d="Area: ".concat(Object(M.default)(a.toFixed(2))).concat(c);r.push(d)}return r}.call(t,l);Object(I.default)(e,i,l.handles.textBox,D,l.handles.points,g,c,d,0,!0)}})},h=0;h<a.data.length;h++)f(h);function g(e){return e}}},{key:"addNewMeasurement",value:function(e){var t=e.detail;this._startDrawing(e),this._addPoint(t),V(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=this._pointNearHandleAllTools(t);return!!t.event.ctrlKey&&(void 0!==n&&n.handleNearby.hasBoundingBox||H.call(this,e,n),V(e),!0)}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",r=e.detail,o=r.element,i=Object(x.getToolState)(r.element,this.name);if(n.hasBoundingBox)Object(C.moveHandleNearImagePoint)(e,this,t,n,a);else{var s=this.configuration;s.dragOrigin={x:n.x,y:n.y};for(var l=0;l<i.data.length;l++)for(var u=i.data[l].handles.points,c=0;c<u.length;c++)u[c]===n&&(s.currentHandle=c,s.currentTool=l);this._modifying=!0,this._activateModify(o),V(e)}}},{key:"_drawingMouseMoveCallback",value:function(e){var t=e.detail,n=t.element,a=Object(x.getToolState)(t.element,this.name),r=this.configuration,o=r.currentTool,i=a.data[o],s=t.currentPoints.canvas;this._getMouseLocation(t),this._checkInvalidHandleLocation(i,t);var l=this._pointNearHandle(n,i,s),u=i.handles.points;void 0!==l&&!l.hasBoundingBox&&l<u.length-1&&(r.mouseLocation.handles.start.x=u[l].x,r.mouseLocation.handles.start.y=u[l].y),b.default.cornerstone.updateImage(t.element)}},{key:"_drawingMouseDragCallback",value:function(e){this.options.mouseButtonMask.includes(e.detail.buttons)&&this._drawingDrag(e)}},{key:"_drawingTouchDragCallback",value:function(e){this._drawingDrag(e)}},{key:"_drawingDrag",value:function(e){var t=e.detail,n=Object(x.getToolState)(t.element,this.name),a=this.configuration.currentTool,r=n.data[a];this._getMouseLocation(t),this._checkInvalidHandleLocation(r,t),this._addPointPencilMode(t,r.handles.points),this._dragging=!0,b.default.cornerstone.updateImage(t.element)}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail;if(this._dragging){this._dragging=!1;var n=t.element,a=this.configuration,r=a.currentTool,o=Object(x.getToolState)(t.element,this.name).data[r];if(!N.end(o.handles.points)&&o.canComplete){var i=a.currentHandle;this._endDrawing(n,i)}V(e)}}},{key:"_drawingMouseDownCallback",value:function(e){var t=e.detail;if(this.options.mouseButtonMask.includes(t.buttons)){var n=t.element,a=t.currentPoints.canvas,r=this.configuration,o=r.currentTool,i=Object(x.getToolState)(t.element,this.name).data[o],s=this._pointNearHandle(n,i,a);if(!N.end(i.handles.points)&&i.canComplete){var l=r.currentHandle;this._endDrawing(n,l)}else void 0===s&&this._addPoint(t);V(e)}}},{key:"_drawingTouchStartCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=this.configuration,o=r.currentTool,i=Object(x.getToolState)(t.element,this.name).data[o],s=this._pointNearHandle(n,i,a);if(!N.end(i.handles.points)&&i.canComplete){var l=r.currentHandle;this._endDrawing(n,l)}else void 0===s&&this._addPoint(t);V(e)}},{key:"completeDrawing",value:function(e){if(this._drawing){var t=Object(x.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];if(!N.end(a.handles.points)&&a.handles.points.length>=2){var r=n.currentHandle;a.polyBoundingBox={},this._endDrawing(e,r)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(e){var t=e.detail;this.completeDrawing(t.element),V(e)}},{key:"_drawingDoubleTapClickCallback",value:function(e){var t=e.detail;this.completeDrawing(t.element),V(e)}},{key:"_editMouseDragCallback",value:function(e){var t=e.detail;if(this.options.mouseButtonMask.includes(t.buttons)){var n,a=Object(x.getToolState)(t.element,this.name),r=this.configuration,o=a.data[r.currentTool],i=r.currentHandle,s=o.handles.points;if(this._getMouseLocation(t),o.handles.invalidHandlePlacement=N.modify(s,i),o.active=!0,o.highlight=!0,s[i].x=r.mouseLocation.handles.start.x,s[i].y=r.mouseLocation.handles.start.y,n=this._getPrevHandleIndex(i,s),i>=0){var l=s[n].lines.length-1,u=s[n].lines[l];u.x=r.mouseLocation.handles.start.x,u.y=r.mouseLocation.handles.start.y}b.default.cornerstone.updateImage(t.element)}}},{key:"_editTouchDragCallback",value:function(e){var t,n=e.detail,a=Object(x.getToolState)(n.element,this.name),r=this.configuration,o=a.data[r.currentTool],i=r.currentHandle,s=o.handles.points;if(this._getMouseLocation(n),o.handles.invalidHandlePlacement=N.modify(s,i),o.active=!0,o.highlight=!0,s[i].x=r.mouseLocation.handles.start.x,s[i].y=r.mouseLocation.handles.start.y,t=this._getPrevHandleIndex(i,s),i>=0){var l=s[t].lines.length-1,u=s[t].lines[l];u.x=r.mouseLocation.handles.start.x,u.y=r.mouseLocation.handles.start.y}b.default.cornerstone.updateImage(n.element)}},{key:"_getPrevHandleIndex",value:function(e,t){return 0===e?t.length-1:e-1}},{key:"_editMouseUpCallback",value:function(e){var t=e.detail,n=t.element,a=Object(x.getToolState)(t.element,this.name);this._deactivateModify(n),this._dropHandle(t,a),this._endDrawing(n),b.default.cornerstone.updateImage(t.element)}},{key:"_dropHandle",value:function(e,t){var n=this.configuration,a=n.currentTool,r=t.data[a].handles,o=r.points;if(r.invalidHandlePlacement){var i,s=n.currentHandle,l=o[s];if(0===s)i=o[o.length-1];else i=o[s-1];l.x=n.dragOrigin.x,l.y=n.dragOrigin.y,i.lines[0]=l,r.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(e){var t,n=e.detail,a=this.createNewMeasurement(n),r=n.element,o=this.configuration;this._referencedElement=r,e.type===p.default.MOUSE_DOWN_ACTIVATE?t="Mouse":e.type===p.default.TOUCH_START_ACTIVE&&(t="Touch"),this._activateDraw(r,t),this._getMouseLocation(n),Object(x.addToolState)(n.element,this.name,a);var i=Object(x.getToolState)(n.element,this.name);o.currentTool=i.data.length-1,this._activeDrawingToolReference=i.data[o.currentTool]}},{key:"_addPoint",value:function(e){var t=Object(x.getToolState)(e.element,this.name),n=this.configuration,a=t.data[n.currentTool];if(!a.handles.invalidHandlePlacement){var r=new F(e.currentPoints.image);a.handles.points.length&&a.handles.points[n.currentHandle-1].lines.push(e.currentPoints.image),a.handles.points.push(r),n.currentHandle+=1,b.default.cornerstone.updateImage(e.element),this.fireModifiedEvent(e.element,a)}}},{key:"_addPointPencilMode",value:function(e,t){var n=this,a=this.configuration,r=e.element,o=a.mouseLocation.handles.start;t.every(function(e){return n._isDistanceLargerThanSpacing(r,e,o)})&&this._addPoint(e)}},{key:"_endDrawing",value:function(e,t){var n=Object(x.getToolState)(e,this.name),a=this.configuration,r=n.data[a.currentTool];if(r.active=!1,r.highlight=!1,r.handles.invalidHandlePlacement=!1,void 0!==t){var o=r.handles.points;o[a.currentHandle-1].lines.push(o[0])}this._modifying&&(this._modifying=!1,r.invalidated=!0),a.currentHandle=0,a.currentTool=-1,r.canComplete=!1,this._drawing&&this._deactivateDraw(e),b.default.cornerstone.updateImage(e),this.fireModifiedEvent(e,r)}},{key:"_pointNearHandle",value:function(e,t,n){if(void 0!==t.handles&&void 0!==t.handles.points&&!1!==t.visible){for(var a=0;a<t.handles.points.length;a++){var r=b.default.cornerstone.pixelToCanvas(e,t.handles.points[a]);if(b.default.cornerstoneMath.point.distance(r,n)<6)return a}return t.handles.textBox&&Object(_.default)(t.handles.textBox,n)?t.handles.textBox:void 0}}},{key:"_pointNearHandleAllTools",value:function(e){var t=e.element,n=e.currentPoints.canvas,a=Object(x.getToolState)(t,this.name);if(a)for(var r,o=0;o<a.data.length;o++)if(void 0!==(r=this._pointNearHandle(t,a.data[o],n)))return{handleNearby:r,toolIndex:o}}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(P.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_checkInvalidHandleLocation",value:function(e,t){if(e.handles.points.length<2)return!0;var n;n=this._dragging?this._checkHandlesPencilMode(e,t):this._checkHandlesPolygonMode(e,t),e.handles.invalidHandlePlacement=n}},{key:"_checkHandlesPolygonMode",value:function(e,t){var n=this.configuration,a=t.element,r=n.mouseLocation.handles.start,o=e.handles.points,i=!1;return e.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(a,o[0],r)&&!N.end(o)&&o.length>2?(e.canComplete=!0,i=!1):i=N.newHandle(r,o),i}},{key:"_checkHandlesPencilMode",value:function(e,t){var n=this.configuration.mouseLocation.handles.start,a=e.handles.points,r=N.newHandle(n,a);return!1===r&&(r=this._invalidHandlePencilMode(e,t)),r}},{key:"_invalidHandlePencilMode",value:function(e,t){var n=this.configuration,a=t.element,r=n.mouseLocation.handles.start,o=e.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(a,o[0],r))return e.canComplete=!0,!1;e.canComplete=!1;for(var i=1;i<o.length-1;i++)if(this._isDistanceSmallerThanSpacing(a,o[i],r))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(e,t,n){var a,r=b.default.cornerstone.pixelToCanvas(e,t),o=b.default.cornerstone.pixelToCanvas(e,n);return"Mouse"===this._drawingInteractionType?a=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(a=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(e,r,o,"<",a)}},{key:"_isDistanceSmallerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,">")}},{key:"_compareDistanceToSpacing",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===a?b.default.cornerstoneMath.point.distance(t,n)>r:b.default.cornerstoneMath.point.distance(t,n)<r}},{key:"_activateDraw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=t,j.state.isMultiPartToolActive=!0,Object(k.hideToolCursor)(this.element),e.addEventListener(p.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.addEventListener(p.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.addEventListener(p.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.addEventListener(p.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.addEventListener(p.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(p.default.TOUCH_START,this._drawingMouseMoveCallback),e.addEventListener(p.default.TOUCH_START,this._drawingTouchStartCallback),e.addEventListener(p.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.addEventListener(p.default.TOUCH_END,this._drawingMouseUpCallback),e.addEventListener(p.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),b.default.cornerstone.updateImage(e)}},{key:"_deactivateDraw",value:function(e){this._drawing=!1,j.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(k.setToolCursor)(this.element,this.svgCursor),e.removeEventListener(p.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.removeEventListener(p.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.removeEventListener(p.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.removeEventListener(p.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.removeEventListener(p.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(p.default.TOUCH_START,this._drawingTouchStartCallback),e.removeEventListener(p.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.removeEventListener(p.default.TOUCH_START,this._drawingMouseMoveCallback),e.removeEventListener(p.default.TOUCH_END,this._drawingMouseUpCallback),b.default.cornerstone.updateImage(e)}},{key:"_activateModify",value:function(e){j.state.isToolLocked=!0,e.addEventListener(p.default.MOUSE_UP,this._editMouseUpCallback),e.addEventListener(p.default.MOUSE_DRAG,this._editMouseDragCallback),e.addEventListener(p.default.MOUSE_CLICK,this._editMouseUpCallback),e.addEventListener(p.default.TOUCH_END,this._editMouseUpCallback),e.addEventListener(p.default.TOUCH_DRAG,this._editTouchDragCallback),b.default.cornerstone.updateImage(e)}},{key:"_deactivateModify",value:function(e){j.state.isToolLocked=!1,e.removeEventListener(p.default.MOUSE_UP,this._editMouseUpCallback),e.removeEventListener(p.default.MOUSE_DRAG,this._editMouseDragCallback),e.removeEventListener(p.default.MOUSE_CLICK,this._editMouseUpCallback),e.removeEventListener(p.default.TOUCH_END,this._editMouseUpCallback),e.removeEventListener(p.default.TOUCH_DRAG,this._editTouchDragCallback),b.default.cornerstone.updateImage(e)}},{key:"passiveCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"enabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"disabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"_closeToolIfDrawing",value:function(e){if(this._drawing){var t=this.configuration.currentHandle;this._endDrawing(e,t),b.default.cornerstone.updateImage(e)}}},{key:"fireModifiedEvent",value:function(e,t){b.default.cornerstone.triggerEvent(e,p.default.MEASUREMENT_MODIFIED,t)}},{key:"cancelDrawing",value:function(e){if(this._drawing){var t=Object(x.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1,n.currentHandle=0,n.currentTool=-1,a.canComplete=!1,Object(x.removeToolState)(e,this.name,a),this._deactivateDraw(e),b.default.cornerstone.updateImage(e)}}},{key:"newImageCallback",value:function(e){var t=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var n=e.detail.element,a=this._activeDrawingToolReference;a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1;var r=a.handles.points;r[t.currentHandle-1].lines.push(r[0]),t.currentHandle=0,t.currentTool=-1,a.canComplete=!1,this._deactivateDraw(n),b.default.cornerstone.updateImage(n)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=e,b.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=e,b.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=e,b.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=e,b.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(e){this.configuration.invalidColor=e,b.default.cornerstone.updateImage(this.element)}}]),t}(y.default);function V(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return _});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./drawing/drawLinkedTextBox.js"),x=n("./drawing/drawHandles.js"),w=n("./util/lineSegDistance.js"),T=n("./tools/cursors/index.js"),j=n("./util/logger.js"),C=Object(j.getLogger)("tools:annotation:LengthTool"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.lengthCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t=e.currentPoints.image,n=t.x,a=t.y;return{visible:!0,active:!0,color:void 0,handles:{start:{x:n,y:a,highlight:!0,active:!1},end:{x:n,y:a,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}C.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){return t&&t.handles&&t.handles.start&&t.handles.end?!1!==t.visible&&Object(w.default)(e,t.handles.start,t.handles.end,n)<25:(C.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=Object(m.getToolState)(e.currentTarget,this.name);if(i){var s,l,u=Object(b.getNewContext)(n.canvasContext.canvas),c=n.image,d=n.element,f=v.default.getToolWidth(),g=h.default.cornerstone.metaData.get("imagePlaneModule",c.imageId);g?(s=g.rowPixelSpacing||g.rowImagePixelSpacing,l=g.columnPixelSpacing||g.colImagePixelSpacing):(s=c.rowPixelSpacing,l=c.columnPixelSpacing);for(var w=function(e){var a=i.data[e];if(!1===a.visible)return"continue";Object(b.draw)(u,function(e){Object(b.setShadow)(e,t.configuration);var i=p.default.getColorIfActive(a);Object(b.drawLine)(e,d,a.handles.start,a.handles.end,{color:i});var u={color:i,handleRadius:r,drawHandlesIfActive:o};Object(x.default)(e,n,a.handles,u);var c=(a.handles.end.x-a.handles.start.x)*(l||1),h=(a.handles.end.y-a.handles.start.y)*(s||1),g=Math.sqrt(c*c+h*h);if(a.length=g,!a.handles.textBox.hasMoved){var m={x:Math.max(a.handles.start.x,a.handles.end.x)};m.x===a.handles.start.x?m.y=a.handles.start.y:m.y=a.handles.end.y,a.handles.textBox.x=m.x,a.handles.textBox.y=m.y}var v=function(e,t,n){var a=" mm";t&&n||(a=" pixels");return"".concat(e.length.toFixed(2)).concat(a)}(a,s,l);Object(y.default)(e,d,a.handles.textBox,v,a.handles,j,i,f,10,!0)})},T=0;T<i.data.length;T++)w(T)}function j(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}}]),t}(g.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return E});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),v=n("./stateManagement/textStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./drawing/drawTextBox.js"),x=n("./drawing/drawHandles.js"),w=n("./util/getRGBPixels.js"),T=n("./util/calculateSUV.js"),j=n("./tools/cursors/index.js"),C=n("./util/logger.js"),_=Object(C.getLogger)("tools:annotation:ProbeTool"),E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:j.probeCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};_.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.end;if(a||_.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!a||!1===t.visible)return!1;var r=h.default.cornerstone.pixelToCanvas(e,t.handles.end);return h.default.cornerstoneMath.point.distance(r,n)<5}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration.handleRadius,a=Object(m.getToolState)(e.currentTarget,this.name);if(a)for(var r=Object(b.getNewContext)(t.canvasContext.canvas),o=t.image,i=v.default.getFontSize(),s=function(e){var s=a.data[e];if(!1===s.visible)return"continue";Object(b.draw)(r,function(e){var a=p.default.getColorIfActive(s);Object(x.default)(e,t,s.handles,{handleRadius:n,color:a});var r,l,u,c=Math.round(s.handles.end.x),d=Math.round(s.handles.end.y);if(c>=0&&d>=0&&c<o.columns&&d<o.rows){if(l="".concat(c,", ").concat(d),o.color)r=Object(w.default)(t.element,c,d,1,1),u="R: ".concat(r[0]," G: ").concat(r[1]," B: ").concat(r[2]);else{var f=(r=h.default.cornerstone.getStoredPixels(t.element,c,d,1,1))[0],g=f*o.slope+o.intercept,m=Object(T.default)(o,f);u="SP: ".concat(f," MO: ").concat(parseFloat(g.toFixed(3))),m&&(u+=" SUV: ".concat(parseFloat(m.toFixed(3))))}var v={x:s.handles.end.x+3,y:s.handles.end.y-3},b=h.default.cornerstone.pixelToCanvas(t.element,v);Object(y.default)(e,u,b.x,b.y+i+5,a),Object(y.default)(e,l,b.x,b.y,a)}})},l=0;l<a.data.length;l++)s(l)}}]),t}(g.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return _});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./externalModules.js"),g=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./util/calculateSUV.js"),x=n("./util/numbersWithCommas.js"),w=n("./util/throttle.js"),T=n("./tools/cursors/index.js"),j=n("./util/logger.js"),C=Object(j.getLogger)("tools:annotation:RectangleRoiTool"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:T.rectangleRoiCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};C.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||C.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var o="mouse"===a?15:25,i=h.default.cornerstone.pixelToCanvas(e,t.handles.start),s=h.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x),top:Math.min(i.y,s.y),width:Math.abs(i.x-s.x),height:Math.abs(i.y-s.y)};return h.default.cornerstoneMath.rect.distanceToPoint(l,n)<o}},{key:"renderToolData",value:function(e){var t=this,n=Object(m.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=v.default.getToolWidth(),s=this.configuration,l=s.handleRadius,u=s.drawHandlesOnHover,c=Object(b.getNewContext)(a.canvasContext.canvas),d=h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{},f=h.default.cornerstone.metaData.get("imagePlaneModule",r.imageId),g=d.modality,y=f&&f.rowPixelSpacing&&f.columnPixelSpacing,x={rowPixelSpacing:(f=f||{}).rowPixelSpacing||1,columnPixelSpacing:f.columnPixelSpacing||1};Object(b.draw)(c,function(e){for(var s=0;s<n.data.length;s++){var c=n.data[s];if(!1!==c.visible){var d=p.default.getColorIfActive(c),f={color:d,handleRadius:l,drawHandlesIfActive:u};Object(b.setShadow)(e,t.configuration),Object(b.drawRect)(e,o,c.handles.start,c.handles.end,{color:d}),Object(b.drawHandles)(e,a,c.handles,f),!0===c.invalidated&&(c.cachedStats?E(r,o,c,g,x):M(r,o,c,g,x)),c.handles.textBox.hasMoved||(c.handles.textBox.x=Math.max(c.handles.start.x,c.handles.end.x),c.handles.textBox.y=(c.handles.start.y+c.handles.end.y)/2);var h=I(e,r.color,c.cachedStats,g,y,t.configuration);Object(b.drawLinkedTextBox)(e,o,c.handles.textBox,h,c.handles,function(e){return t=e.start,n=e.end,a=O(t,n),r=a.left,o=a.top,i=a.width,s=a.height,[{x:r+i/2,y:o},{x:r,y:o+s/2},{x:r+i/2,y:o+s},{x:r+i,y:o+s/2}];var t,n,a,r,o,i,s},d,i,0,!0)}}})}}}]),t}(g.default),E=Object(w.default)(M,110);function M(e,t,n,a,r){var o=function(e,t,n,a,r){var o,i=O(n.start,n.end),s=function(e,t){for(var n=0,a=0,r=0,o=0,i=e?e[0]:null,s=e?e[0]:null,l=t.top;l<t.top+t.height;l++)for(var u=t.left;u<t.left+t.width;u++)n+=e[o],a+=e[o]*e[o],i=Math.min(i,e[o]),s=Math.max(s,e[o]),r++,o++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var c=n/r,d=a/r-c*c;return{count:r,mean:c,variance:d,stdDev:Math.sqrt(d),min:i,max:s}}(h.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),i);"PT"===a&&(o={mean:Object(y.default)(e,s.mean,!0)||0,stdDev:Object(y.default)(e,s.stdDev,!0)||0});return{area:i.width*(r.columnPixelSpacing||1)*(i.height*(r.rowPixelSpacing||1))||0,count:s.count||0,mean:s.mean||0,variance:s.variance||0,stdDev:s.stdDev||0,min:s.min||0,max:s.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}function O(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function I(e,t,n,a,r){var o=n.area,i=n.mean,s=n.stdDev,l=n.min,u=n.max,c=n.meanStdDevSUV,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=d.showMinMax||!1,h=!1!==d.showHounsfieldUnits,g=[],m=[];if(!t){var v=c&&0!==c.mean,p="CT"===a&&h?" HU":"",b="Mean: ".concat(Object(x.default)(i.toFixed(2))).concat(p),y="Std Dev: ".concat(Object(x.default)(s.toFixed(2))).concat(p);if(v){for(var w="".concat(" SUV: ").concat(Object(x.default)(c.mean.toFixed(2))),T="".concat(" SUV: ").concat(Object(x.default)(c.stdDev.toFixed(2))),j=Math.floor(e.measureText("".concat(y,"     ")).width);e.measureText(b).width<j;)b+=" ";m.push("".concat(b).concat(w)),m.push("".concat(y,"     ").concat(T))}else m.push("".concat(b,"     ").concat(y));if(f){for(var C="Min: ".concat(l).concat(p),_="Max: ".concat(u).concat(p),E=v?Math.floor(e.measureText("".concat(y,"     ")).width):Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(C).width<E;)C+=" ";m.push("".concat(C).concat(_))}}return g.push(function(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(x.default)(e.toFixed(2))).concat(n)}(o,r)),m.forEach(function(e){return g.push(e)}),g}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return j});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./tools/base/BaseAnnotationTool.js"),v=n("./externalModules.js"),p=n("./util/pointInsideBoundingBox.js"),b=n("./stateManagement/toolColors.js"),y=n("./drawing/index.js"),x=n("./drawing/drawTextBox.js"),w=n("./stateManagement/toolState.js"),T=n("./tools/cursors/index.js"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:C},svgCursor:T.textMarkerCursor},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).initialConfiguration=o,e.touchPressCallback=e._changeText.bind(f()(e)),e.doubleClickCallback=e._changeText.bind(f()(e)),e}return g()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){var t=this.configuration;if(t.current){var n={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},a={left:0,top:0,width:e.image.width,height:e.image.height};if(v.default.cornerstoneMath.point.insideRect(n.handles.end,a)){var r=t.markers.indexOf(t.current);return(r+=t.ascending?1:-1)>=t.markers.length?r=t.loop?0:-1:r<0&&(r=t.loop?t.markers.length:-1),t.current=t.markers[r],n}}}},{key:"pointNearTool",value:function(e,t,n){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var a=v.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,n),r=Object(p.default)(t.handles.end,n);return a<10||r}}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration,a=Object(w.getToolState)(t.element,this.name);if(a)for(var r=Object(y.getNewContext)(t.canvasContext.canvas),o=function(e){var o=a.data[e];if(!1===o.visible)return"continue";var i=b.default.getColorIfActive(o);Object(y.draw)(r,function(e){Object(y.setShadow)(e,n);var a=v.default.cornerstone.pixelToCanvas(t.element,o.handles.end);o.handles.end.boundingBox=Object(x.default)(e,o.text,a.x,a.y-10,i,{centering:{x:!0,y:!0}})})},i=0;i<a.data.length;i++)o(i)}},{key:"_changeText",value:function(e){var t,n=e.detail,a=n.element,r=n.currentPoints;function o(e,t,n){!0===n?Object(w.removeToolState)(a,this.name,e):e.text=t,e.active=!1,v.default.cornerstone.updateImage(a)}var i=this.configuration,s=r.canvas,l=Object(w.getToolState)(a,this.name);if(l)for(var u=0;u<l.data.length;u++)if(t=l.data[u],this.pointNearTool(a,t,s))return t.active=!0,v.default.cornerstone.updateImage(a),i.changeTextCallback(t,n,o),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation()}}]),t}(m.default),C=function(e,t,n){n(e,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./events.js"),o=n("./manipulators/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),l=n("./stateManagement/toolState.js");t.default=function(e,t){var n=this,c=e.detail,d=c.element,f=c.image,h=this.configuration;if(!u(f)){var g=this.createNewMeasurement(c),m=function(){g.active=!1,a.default.cornerstone.updateImage(d)};Object(l.addToolState)(d,this.name,g),a.default.cornerstone.updateImage(d);var v=(new Date).getTime(),p=g.handles,b=p.end,y=p.perpendicularStart;Object(o.moveNewHandle)(c,this.name,g,b,{doneMovingCallback:function(){var e=g.handles,t=g.longestDiameter,o=g.shortestDiameter,u=Object(i.default)(c,e),f=parseFloat(t)||0,p=parseFloat(o)||0,b=f<1||p<1,x=(new Date).getTime()-v<150;u||b||x?(g.cancelled=!0,Object(l.removeToolState)(d,n.name,g)):h.getMeasurementLocationCallback(g,c,m),y.locked=!1,a.default.cornerstone.updateImage(d);var w={toolType:n.name,element:d,measurementData:g};Object(s.default)(c,g),a.default.cornerstone.triggerEvent(d,r.default.MEASUREMENT_MODIFIED,w)}},t)}};var u=function(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId),n=e.rowPixelSpacing,r=e.columnPixelSpacing;return t&&(n=t.rowPixelSpacing||t.rowImagePixelSpacing,r=t.columnPixelSpacing||t.colImagePixelSpacing),!n||!r}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:e,y:t,index:n,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},a)};t.default=function(e){var t=e.currentPoints.image,n=t.x,r=t.y;return{toolType:this.name,isCreating:!0,visible:!0,active:!0,handles:{start:a(n,r,0),end:a(n,r,1,{active:!0}),perpendicularStart:a(n,r,2,{locked:!0}),perpendicularEnd:a(n,r,3),textBox:a(n-50,r-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){"touch"===(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse")?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),c=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),h=n("./tools/annotation/bidirectionalTool/invertHandles.js"),g=n("./store/setToolCursor.js");t.default=function(e){var t,n=this,a=e.detail,b=a.element,y=i.state.clickProximity,x=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(b,n.name,t),e&&(e.moving=!1,e.selected=!0),Object(g.setToolCursor)(n.element,n.svgCursor),o.default.cornerstone.updateImage(b),b.addEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.addEventListener(s.default.TOUCH_START,n._moveCallback)},w=a.startPoints.canvas,T=Object(l.getToolState)(e.currentTarget,this.name);if(T){for(var j=function(r){t=T.data[r];var o=[b,t.handles,w,y],i=c.default.apply(void 0,o);if(i)return b.removeEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.removeEventListener(s.default.TOUCH_START,n._moveCallback),t.active=!0,m(t.handles),i.moving=!0,(i=Object(h.default)(a,t,i)).hasBoundingBox||Object(g.hideToolCursor)(n.element),Object(f.default)(a,n.name,t,i,function(){return x(i)}),p(e),{v:!0}},C=0;C<T.data.length;C++){var _=j(C);if("object"===r()(_))return _.v}var E=function(e){return function(){v(e,!1),x()}};for(C=0;C<T.data.length;C++)if(t=T.data[C],this.pointNearTool(b,t,w,"mouse")){b.removeEventListener(s.default.MOUSE_MOVE,this._moveCallback),b.removeEventListener(s.default.TOUCH_START,this._moveCallback),t.active=!0,m(t.handles),v(t.handles,!0);var M=E(t.handles);return Object(d.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:M},"mouse"),p(e),!0}}};var m=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},v=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},p=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),c=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var t,n=this,a=e.detail,v=a.element,p=i.state.touchProximity,b=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(v,n.name,t),e&&(e.moving=!1,e.selected=!0),o.default.cornerstone.updateImage(v),v.addEventListener(s.default.TOUCH_DRAG,n._moveCallback)},y=a.startPoints.canvas,x=Object(l.getToolState)(e.currentTarget,this.name);if(x){for(var w=function(r){t=x.data[r];var o=[v,t.handles,y,p],i=c.default.apply(void 0,o);if(i)return v.removeEventListener(s.default.TOUCH_DRAG,n._moveCallback),t.active=!0,h(t.handles),i.moving=!0,Object(f.default)(a,n.name,t,i,function(){return b(i)}),m(e),{v:!0}},T=0;T<x.data.length;T++){var j=w(T);if("object"===r()(j))return j.v}var C=function(e){return function(){g(e,!1),b()}};for(T=0;T<x.data.length;T++)if(t=x.data[T],this.pointNearTool(v,t,y,"touch")){v.removeEventListener(s.default.TOUCH_DRAG,this._moveCallback),t.active=!0,h(t.handles),g(t.handles,!0);var _=C(t.handles);return Object(d.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:_},"touch"),m(e),!0}}};var h=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},g=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},m=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=function(e,t,n){var a=e[n],r=t[n];e[n]=r,t[n]=a},r=function(e,t){a(e,t,"x"),a(e,t,"y"),a(e,t,"moving"),a(e,t,"hover"),a(e,t,"active"),a(e,t,"selected")};function o(e,t,n){var a=e.image,o=a.rowPixelSpacing,i=a.columnPixelSpacing,s=t.handles,l=s.start,u=s.end,c=s.perpendicularStart,d=s.perpendicularEnd,f=(l.x-u.x)*(i||1),h=(l.y-u.y)*(o||1),g=Math.sqrt(f*f+h*h),m=(c.x-d.x)*(i||1),v=(c.y-d.y)*(o||1);return(Math.sqrt(m*m+v*v)||0)>g?(r(l,u),r(l,c),r(u,d),Object.values(s).find(function(e){return!0===e.moving})):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolCoordinates.js"),o=n("./manipulators/getHandleNearImagePoint.js"),i=n("./stateManagement/toolState.js");t.default=function(e){var t=this,n=e.detail,s=n.element;r.default.setCoords(n);var l=Object(i.getToolState)(s,this.name);if(l){for(var u=!1,c=function(e){var a=n.currentPoints.canvas,r=l.data[e],i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=Object(o.default)(e,t,n,a),i=!1;return Object.keys(t).forEach(function(e){if("textBox"!==e){var n=t[e],a=n===r;n.active!==a&&(i=!0),n.active=a}}),i}(s,r.handles,a);Object.keys(r.handles).forEach(function(e){if("textBox"!==e){var t=r.handles[e];t.hover=t.active}}),i&&(u=!0);var c=t.pointNearTool(s,r,a,"mouse"),d=c&&!r.active,f=!c&&r.active;(d||f)&&(r.active=!r.active,u=!0)},d=0;d<l.data.length;d++)c(d);!0===u&&a.default.cornerstone.updateImage(s)}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js");t.default=function(e,t,n,l,u,c){var d=e.element,f={x:l.x-e.currentPoints.image.x,y:l.y-e.currentPoints.image.y},h=function(r){var u=r.detail;l.hasMoved=!0,void 0===l.index||null===l.index?(l.x=u.currentPoints.image.x+f.x,l.y=u.currentPoints.image.y+f.y):Object(i.default)(l,u,n,f),c&&(l.x=Math.max(l.x,0),l.x=Math.min(l.x,u.image.width),l.y=Math.max(l.y,0),l.y=Math.min(l.y,u.image.height)),a.default.cornerstone.updateImage(d);var h={toolType:t,element:d,measurementData:n};Object(s.default)(e,n),a.default.cornerstone.triggerEvent(d,o.default.MEASUREMENT_MODIFIED,h)};l.active=!0,r.state.isToolLocked=!0,d.addEventListener(o.default.MOUSE_DRAG,h),d.addEventListener(o.default.TOUCH_DRAG,h);var g=a.default.cornerstone.getImage(d),m=function(){a.default.cornerstone.getImage(d).imageId!==g.imageId&&v()};d.addEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,m);var v=function e(){l.active=!1,r.state.isToolLocked=!1,d.removeEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,m),d.removeEventListener(o.default.MOUSE_DRAG,h),d.removeEventListener(o.default.MOUSE_UP,e),d.removeEventListener(o.default.MOUSE_CLICK,e),d.removeEventListener(o.default.TOUCH_DRAG,h),d.removeEventListener(o.default.TOUCH_DRAG_END,e),d.removeEventListener(o.default.TAP,e),a.default.cornerstone.updateImage(d),"function"==typeof u&&u()};d.addEventListener(o.default.MOUSE_UP,v),d.addEventListener(o.default.MOUSE_CLICK,v),d.addEventListener(o.default.TOUCH_DRAG_END,v),d.addEventListener(o.default.TAP,v)}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,r=t.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u={start:{x:o.x,y:o.y},end:{x:i.x,y:i.y}},c={start:{x:s.x,y:s.y},end:{x:l.x,y:l.y}},d=a.default.cornerstoneMath.lineSegment.intersectLine(u,c),f=n(s,d),h=n(l,d),g=n(i,d),m=n(i,e);if(m<=g)return!1;var v=(i.x-e.x)/m,p=(i.y-e.y)/m,b=g/m,y=i.x+(e.x-i.x)*b,x=i.y+(e.y-i.y)*b;return s.x=y-f*p,s.y=x+f*v,l.x=y+h*p,l.y=x-h*v,!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,r=t.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u={start:{x:o.x,y:o.y},end:{x:i.x,y:i.y}},c={start:{x:s.x,y:s.y},end:{x:l.x,y:l.y}},d=a.default.cornerstoneMath.lineSegment.intersectLine(u,c),f=n(s,d),h=n(l,d),g=n(o,d),m=n(o,e);if(m<=g)return!1;var v=(o.x-e.x)/m,p=(o.y-e.y)/m,b=g/m,y=o.x+(e.x-o.x)*b,x=o.y+(e.y-o.y)*b;return s.x=y+f*p,s.y=x-f*v,l.x=y-h*p,l.y=x+h*v,!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,r=t.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u=l,c=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,u),d=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,e),f=c+d;if(n(u,e)<=c)return!1;var h=n(o,i);if(0===h)return!1;var g=(o.x-i.x)/h,m=(o.y-i.y)/h,v=o.x-1*g,p=o.y-1*m,b=i.x+1*g,y=i.y+1*m;s.x=e.x,s.y=e.y,l.x=e.x-f*m,l.y=e.y+f*g;var x={start:{x:o.x,y:o.y},end:{x:i.x,y:i.y}},w={start:{x:s.x,y:s.y},end:{x:l.x,y:l.y}};return a.default.cornerstoneMath.lineSegment.intersectLine(x,w)||(n(e,o)>n(e,i)?(s.x=b+d*m,s.y=y-d*g,l.x=s.x-f*m,l.y=s.y+f*g):(s.x=v+d*m,s.y=p-d*g,l.x=s.x-f*m,l.y=s.y+f*g)),!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=a.default.cornerstoneMath.point.distance,r=t.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u=s,c=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,u),d=a.default.cornerstoneMath.lineSegment.distanceToPoint(t.handles,e),f=c+d;if(n(u,e)<=c)return!1;var h=n(o,i),g=(o.x-i.x)/h,m=(o.y-i.y)/h,v=o.x-1*g,p=o.y-1*m,b=i.x+1*g,y=i.y+1*m;s.x=e.x+f*m,s.y=e.y-f*g,l.x=e.x,l.y=e.y,l.locked=!1,s.locked=!1;var x={start:{x:o.x,y:o.y},end:{x:i.x,y:i.y}},w={start:{x:s.x,y:s.y},end:{x:l.x,y:l.y}};return a.default.cornerstoneMath.lineSegment.intersectLine(x,w)||(n(e,o)>n(e,i)?(l.x=b-d*m,l.y=y+d*g,s.x=l.x+f*m,s.y=l.y-f*g):(l.x=v-d*m,l.y=p+d*g,s.x=l.x+f*m,s.y=l.y-f*g)),!0}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js"),s=n("./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js");t.default=function(e,t,n,l){var u,c,d,f,h={},g={},m={x:t.currentPoints.image.x+l.x,y:t.currentPoints.image.y+l.y};0===e.index?Object(r.default)(m,n)?(e.x=m.x,e.y=m.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?Object(o.default)(m,n)?(e.x=m.x,e.y=m.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(u=!1,h.start={x:n.handles.start.x,y:n.handles.start.y},h.end={x:n.handles.end.x,y:n.handles.end.y},g.start={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},g.end={x:m.x,y:m.y},(c=a.default.cornerstoneMath.lineSegment.intersectLine(h,g))||(g.end={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},c=a.default.cornerstoneMath.lineSegment.intersectLine(h,g),d=a.default.cornerstoneMath.point.distance(c,n.handles.start),f=a.default.cornerstoneMath.point.distance(c,n.handles.end),(!c||d<3||f<3)&&(u=!0)),!1,u||Object(i.default)(m,n)||(t.currentPoints.image.x=n.handles.perpendicularStart.x,t.currentPoints.image.y=n.handles.perpendicularStart.y)):3===e.index&&(u=!1,h.start={x:n.handles.start.x,y:n.handles.start.y},h.end={x:n.handles.end.x,y:n.handles.end.y},g.start={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},g.end={x:m.x,y:m.y},(c=a.default.cornerstoneMath.lineSegment.intersectLine(h,g))||(g.end={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},c=a.default.cornerstoneMath.lineSegment.intersectLine(h,g),d=a.default.cornerstoneMath.point.distance(c,n.handles.start),f=a.default.cornerstoneMath.point.distance(c,n.handles.end),(!c||d<3||f<3)&&(u=!0)),!1,u||Object(s.default)(m,n)||(t.currentPoints.image.x=n.handles.perpendicularEnd.x,t.currentPoints.image.y=n.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),l=[o.default.TOUCH_END,o.default.TOUCH_DRAG_END,o.default.TOUCH_PINCH,o.default.TOUCH_PRESS,o.default.TAP];t.default=function(e,t,n,u,c,d){var f=e.element,h={x:u.x-e.currentPoints.image.x,y:u.y-e.currentPoints.image.y},g=function(r){var l=r.detail;u.hasMoved=!0,void 0===u.index||null===u.index?(u.x=l.currentPoints.image.x+h.x,u.y=l.currentPoints.image.y+h.y):Object(i.default)(u,l,n,h),d&&(u.x=Math.max(u.x,0),u.x=Math.min(u.x,l.image.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,l.image.height)),a.default.cornerstone.updateImage(f);var c={toolType:t,element:f,measurementData:n};Object(s.default)(e,n),a.default.cornerstone.triggerEvent(f,o.default.MEASUREMENT_MODIFIED,c)};u.active=!0,r.state.isToolLocked=!0,f.addEventListener(o.default.TOUCH_DRAG,g);var m=function e(){u.active=!1,r.state.isToolLocked=!1,f.removeEventListener(o.default.TOUCH_DRAG,g),l.forEach(function(t){f.removeEventListener(t,e)}),a.default.cornerstone.updateImage(f),"function"==typeof c&&c()};l.forEach(function(e){f.addEventListener(e,m)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./externalModules.js"),o=n("./util/pointInsideBoundingBox.js");t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s=r.default.cornerstone,l=r.default.cornerstoneMath,u=t.handles,c={start:s.pixelToCanvas(e,u.start),end:s.pixelToCanvas(e,u.end)},d=l.lineSegment.distanceToPoint(c,n);if(Object(o.default)(u.textBox,n))return!0;var f="mouse"===i?a.state.clickProximity:a.state.touchProximity;return!!function(e,t,n,a){var o=r.default.cornerstone,i=r.default.cornerstoneMath,s={start:o.pixelToCanvas(e,t.perpendicularStart),end:o.pixelToCanvas(e,t.perpendicularEnd)};return i.lineSegment.distanceToPoint(s,n)<a}(e,u,n,f)||d<f}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./drawing/drawHandles.js"),s=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),l=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),u=n("./stateManagement/toolStyle.js"),c=n("./stateManagement/toolColors.js"),d=n("./stateManagement/toolState.js"),f=n("./drawing/index.js"),h=n("./drawing/drawLinkedTextBox.js");t.default=function(e){var t=this,n=e.detail,a=n.element,r=n.canvasContext,m=n.image,v=this.configuration,p=v.handleRadius,b=v.drawHandlesOnHover,y=Object(d.getToolState)(a,this.name);if(y){var x=o.default.cornerstone.metaData.get("imagePlaneModule",m.imageId),w=m.rowPixelSpacing,T=m.columnPixelSpacing;if(x&&(w=x.rowPixelSpacing||x.rowImagePixelSpacing,T=x.columnPixelSpacing||x.colImagePixelSpacing),w&&T)for(var j,C=Object(f.getNewContext)(r.canvas),_=c.default.getActiveColor(),E=u.default.getToolWidth(),M=function(e){var r=y.data[e];if(!1===r.visible)return"continue";j=r.active?_:c.default.getToolColor(),Object(l.default)(n,r),Object(f.draw)(C,function(e){Object(f.setShadow)(e,t.configuration);var o=r.handles,l=o.start,u=o.end,c=o.perpendicularStart,d=o.perpendicularEnd,m=o.textBox;Object(f.drawLine)(e,a,l,u,{color:j});var v=E;Object(s.default)(n,r),Object(f.drawLine)(e,a,c,d,{color:j,strokeWidth:v});var y={color:j,handleRadius:p,drawHandlesIfActive:b};Object(i.default)(e,n,r.handles,y);var x=g(r,w,T);Object(h.default)(e,a,m,x,r.handles,function(e){return[e.start,e.end,e.perpendicularStart,e.perpendicularEnd]},j,E,10,!0)})},O=0;O<y.data.length;O++)M(O)}};var g=function(e,t,n){var a=" mm";t&&n||(a=" pixels");var o=" L ".concat(e.longestDiameter).concat(a),i=" W ".concat(e.shortestDiameter).concat(a),s=e.labels;return s&&Array.isArray(s)?[].concat(r()(s),[o,i]):[o,i]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){"use strict";function a(e,t){var n=e.image,a=n.rowPixelSpacing,r=n.columnPixelSpacing,o=t.handles,i=o.start,s=o.end,l=o.perpendicularStart,u=o.perpendicularEnd,c=(i.x-s.x)*(r||1),d=(i.y-s.y)*(a||1),f=Math.sqrt(c*c+d*d),h=(l.x-u.x)*(r||1),g=(l.y-u.y)*(a||1),m=Math.sqrt(h*h+g*g);if(m||(m=0),m>f){var v=f;f=m,m=v}t.longestDiameter=f.toFixed(1),t.shortestDiameter=m.toFixed(1)}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){if(t.handles.perpendicularStart.locked){var n,a,r,o,i=t.handles,s=i.start,l=i.end;if(s.x===l.x&&s.y===l.y)n=s.x,a=s.y,r=l.x,o=l.y;else{var u={x:(s.x+l.x)/2,y:(s.y+l.y)/2},c=(s.x-l.x)*(e.image.columnPixelSpacing||1),d=(s.y-l.y)*(e.image.rowPixelSpacing||1),f=Math.sqrt(c*c+d*d),h=(s.x-l.x)/f,g=(s.y-l.y)/f,m=f/2;n=u.x+m/2*g,a=u.y-m/2*h,r=u.x-m/2*g,o=u.y+m/2*h}t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=a,t.handles.perpendicularEnd.x=r,t.handles.perpendicularEnd.y=o}}},"./tools/annotation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/AngleTool.js"),r=n("./tools/annotation/ArrowAnnotateTool.js"),o=n("./tools/annotation/BidirectionalTool.js"),i=n("./tools/annotation/CobbAngleTool.js"),s=n("./tools/annotation/EllipticalRoiTool.js"),l=n("./tools/annotation/FreehandMouseTool.js"),u=n("./tools/annotation/LengthTool.js"),c=n("./tools/annotation/ProbeTool.js"),d=n("./tools/annotation/RectangleRoiTool.js"),f=n("./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",function(){return a.default}),n.d(t,"ArrowAnnotateTool",function(){return r.default}),n.d(t,"BidirectionalTool",function(){return o.default}),n.d(t,"CobbAngleTool",function(){return i.default}),n.d(t,"EllipticalRoiTool",function(){return s.default}),n.d(t,"FreehandMouseTool",function(){return l.default}),n.d(t,"LengthTool",function(){return u.default}),n.d(t,"ProbeTool",function(){return c.default}),n.d(t,"RectangleRoiTool",function(){return d.default}),n.d(t,"TextMarkerTool",function(){return f.default}),t.default={AngleTool:a.default,ArrowAnnotateTool:r.default,BidirectionalTool:o.default,CobbAngleTool:i.default,EllipticalRoiTool:s.default,FreehandMouseTool:l.default,LengthTool:u.default,ProbeTool:c.default,RectangleRoiTool:d.default,TextMarkerTool:f.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(d),h=n("./tools/base/BaseTool.js"),g=n("./stateManagement/toolState.js"),m=n("./manipulators/handleActivator.js"),v=n("./util/findAndMoveHelpers.js"),p=function(e){function t(e){var n=e.name,a=e.strategies,o=e.defaultStrategy,i=e.configuration,s=e.supportedInteractionTypes,u=e.mixins,d=e.svgCursor;return r()(this,t),l()(this,c()(t).call(this,{name:n,strategies:a,defaultStrategy:o,configuration:i,supportedInteractionTypes:s,mixins:u,svgCursor:d}))}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(e,t,n){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(e){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(e){for(var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=Object(g.getToolState)(n,this.name),o=!1,i=0;i<r.data.length;i++){var s=r.data[i];!0===Object(m.default)(n,s.handles,a)&&(o=!0);var l=this.pointNearTool(n,s,a)&&!s.active,u=!this.pointNearTool(n,s,a)&&s.active;(l||u)&&(s.active=!s.active,o=!0)}return o}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(v.moveHandleNearImagePoint)(e,this,t,n,a)}},{key:"toolSelectedCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(v.moveAnnotation)(e,this,t,n)}}]),t}(h.default);t.default=p},"./tools/base/BaseBrushTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./events.js"),p=n("./tools/base/BaseTool.js"),b=n("./store/isToolActive.js"),y=n("./store/index.js"),x=n("./stateManagement/toolState.js"),w=n("./stateManagement/imageIdSpecificStateManager.js"),T=y.default.modules.brush,j=T.state,C=T.setters,_=function(e){function t(e){var n,a=e.name,o=e.strategies,i=e.defaultStrategy,s=e.configuration,u=e.supportedInteractionTypes,d=e.mixins,h=e.svgCursor;return r()(this,t),s.referencedToolData="brush",(n=l()(this,c()(t).call(this,{name:a,strategies:o,defaultStrategy:i,configuration:s,supportedInteractionTypes:u,mixins:d,svgCursor:h}))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(f()(n)),n}return g()(t,e),i()(t,[{key:"renderBrush",value:function(e){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(e){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(e){this._startPainting(e)}},{key:"preMouseDownCallback",value:function(e){return this._startPainting(e),!0}},{key:"_startPainting",value:function(e){var t=e.detail,n=t.element;this._paint(e),this._drawing=!0,this._startListeningForMouseUp(n),this._lastImageCoords=t.currentPoints.image}},{key:"mouseMoveCallback",value:function(e){var t=e.detail.currentPoints;this._lastImageCoords=t.image}},{key:"passiveCallback",value:function(e){m.default.cornerstone.updateImage(this.element)}},{key:"renderToolData",value:function(e){var t=e.detail.element;Object(b.default)(t,this.name)&&this.renderBrush(e)}},{key:"_getBrushColor",value:function(e){var t=m.default.cornerstone.colors.getColormap(j.colorMapId).getColor(e);return this._drawing?"rgba(".concat(t[[0]],", ").concat(t[[1]],", ").concat(t[[2]],", 1.0 )"):"rgba(".concat(t[[0]],", ").concat(t[[1]],", ").concat(t[[2]],", 0.8 )")}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(t)}},{key:"_startListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),m.default.cornerstone.updateImage(e)}},{key:"_stopListeningForMouseUp",value:function(e){e.removeEventListener(v.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(v.default.MOUSE_CLICK,this._drawingMouseUpCallback),m.default.cornerstone.updateImage(e)}},{key:"nextSegmentation",value:function(){var e=this.constructor.getNumberOfColors(),t=j.drawColorId+1;t===e&&(t=0),j.drawColorId=t}},{key:"previousSegmentation",value:function(){var e=this.constructor.getNumberOfColors(),t=j.drawColorId-1;t<0&&(t=e-1),j.drawColorId=t}},{key:"increaseBrushSize",value:function(){var e=j.radius,t=Math.floor(1.2*e);t===e&&(t+=1),C.radius(t)}},{key:"decreaseBrushSize",value:function(){var e=j.radius,t=Math.floor(.8*e);C.radius(t)}},{key:"showSegmentationOnElement",value:function(e){var t=this._getEnabledElement(),n=t.uuid;C.brushVisibilityForElement(n,e,!0),m.default.cornerstone.updateImage(t.element)}},{key:"hideSegmentationOnElement",value:function(e){var t=this._getEnabledElement(),n=t.uuid;C.brushVisibilityForElement(n,e,!1),m.default.cornerstone.updateImage(t.element)}},{key:"showAllSegmentationsOnElement",value:function(){for(var e=this._getEnabledElement(),t=e.uuid,n=m.default.cornerstone.colors.getColormap(j.colorMapId).getNumberOfColors(),a=0;a<n;a++)C.brushVisibilityForElement(t,a,!0);m.default.cornerstone.updateImage(e.element)}},{key:"hideAllSegmentationsOnElement",value:function(){for(var e=this._getEnabledElement(),t=e.uuid,n=m.default.cornerstone.colors.getColormap(j.colorMapId).getNumberOfColors(),a=0;a<n;a++)C.brushVisibilityForElement(t,a,!1);m.default.cornerstone.updateImage(e.element)}},{key:"_getEnabledElement",value:function(){return m.default.cornerstone.getEnabledElement(this.element)}},{key:"alpha",get:function(){return j.alpha},set:function(e){var t=this._getEnabledElement();j.alpha=e,m.default.cornerstone.updateImage(t.element)}},{key:"hiddenButActiveAlpha",get:function(){return j.hiddenButActiveAlpha},set:function(e){var t=this._getEnabledElement();j.hiddenButActiveAlpha=e,m.default.cornerstone.updateImage(t.element)}}],[{key:"getNumberOfColors",value:function(){return m.default.cornerstone.colors.getColormap(j.colorMapId).getNumberOfColors()}},{key:"getReferencedToolDataName",value:function(){return"brush"}},{key:"invalidateBrushOnEnabledElement",value:function(e){var t=y.default.getters.enabledElementByUID(e),n=Object(x.getToolState)(t,"stack");if(n){for(var a=n.data[0].imageIds,r=w.globalImageIdSpecificToolStateManager.saveToolState(),o=0;o<a.length;o++){var i=a[o];if(r[i]&&r[i].brush)for(var s=r[i].brush.data,l=0;l<s.length;l++)s[l].pixelData&&(s[l].invalidated=!0)}m.default.cornerstone.updateImage(t,!0)}}},{key:"getDataAsVolume",value:function(e){var t=y.default.getters.enabledElementByUID(e),n=Object(x.getToolState)(t,"stack");if(n)for(var a=n.data[0].imageIds,r=m.default.cornerstone.getEnabledElement(t).image,o={xy:r.columns*r.rows,z:r.rows,xyz:r.columns*r.rows*a.length},i=w.globalImageIdSpecificToolStateManager.saveToolState(),s=new ArrayBuffer(o.xyz),l=(new Uint8Array(s),0);l<a.length;l++){var u=a[l];i[u]&&i[u].brush&&i[u].brush.data[0].pixelData}}}]),t}(p.default);t.default=_},"./tools/base/BaseTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),u=n("./mixins/index.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("tools:base:BaseTool"),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,a=t.strategies,r=t.defaultStrategy,o=t.configuration,s=t.supportedInteractionTypes,l=t.mixins,u=t.svgCursor;i()(this,e),this.name=n,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=s||[],this.strategies=a||{},this.defaultStrategy=r||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,u&&(this.svgCursor=u),this._options={},this._configuration=Object.assign({},o),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,l&&l.length&&this._applyMixins(l)}return l()(e,[{key:"mergeOptions",value:function(e){this._options=Object.assign({},this._options,e)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(e){return this.strategies[this.activeStrategy](e,this.configuration)}},{key:"_applyMixins",value:function(e){for(var t=0;t<e.length;t++){var n=u.default["".concat(e[t])];"object"===r()(n)?Object.assign(this,n):d.warn("".concat(this.name,": mixin ").concat(u.default[t]," does not exist."))}}},{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),e}();t.default=f},"./tools/brush/BrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=n.n(u),d=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(h),m=n("./externalModules.js"),v=n("./tools/base/BaseBrushTool.js"),p=n("./stateManagement/toolState.js"),b=n("./store/index.js"),y=n("./util/brush/index.js"),x=n("./events.js"),w=y.default.drawBrushPixels,T=y.default.getCircle,j=b.default.modules.brush,C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],strategies:{overlapping:_,nonOverlapping:E},defaultStrategy:"overlapping",configuration:{}},o=Object.assign(a,n);return(e=l()(this,c()(t).call(this,o))).touchDragCallback=e._paint.bind(f()(e)),e.initialConfiguration=o,e}return g()(t,e),i()(t,[{key:"renderBrush",value:function(e){var t,n=e.detail,a=n.viewport;if(this._drawing?t=this._lastImageCoords:this._mouseUpRender?(t=this._lastImageCoords,this._mouseUpRender=!1):t=b.default.state.mousePositionImage,t){var r=n.image,o=r.rows,i=r.columns,s=t,l=s.x,u=s.y;if(!(l<0||l>i||u<0||u>o)){var c=j.state.radius,d=n.canvasContext,f=n.element,h=j.state.drawColorId,g=this._getBrushColor(h);d.setTransform(1,0,0,1,0,0);var v=m.default.cornerstone,p=c*a.scale,y=v.pixelToCanvas(f,t);d.beginPath(),d.strokeStyle=g,d.ellipse(y.x,y.y,p,p,0,0,2*Math.PI),d.stroke()}}}},{key:"_paint",value:function(e){this.applyActiveStrategy(e,this.configuration),m.default.cornerstone.triggerEvent(e.detail.element,x.default.MEASUREMENT_MODIFIED,e.detail),m.default.cornerstone.updateImage(e.detail.element)}}]),t}(v.default);function _(e){var t=e.detail,n=t.element,a=t.image,r=a.rows,o=a.columns,i=t.currentPoints.image,s=i.x,l=i.y,u=Object(p.getToolState)(n,v.default.getReferencedToolDataName());u||(Object(p.addToolState)(n,v.default.getReferencedToolDataName(),{}),u=Object(p.getToolState)(n,v.default.getReferencedToolDataName()));var c=u.data;if(!(s<0||s>o||l<0||l>r)){var d=j.state.radius;M(t,c,T(d,r,o,s,l))}}function E(e){var t=e.detail,n=t.element,a=t.image,r=a.rows,o=a.columns,i=t.currentPoints.image,s=i.x,l=i.y,u=Object(p.getToolState)(n,v.default.getReferencedToolDataName());u||(Object(p.addToolState)(n,v.default.getReferencedToolDataName(),{}),u=Object(p.getToolState)(n,v.default.getReferencedToolDataName()));var c=u.data,d=j.state.drawColorId;if(!(s<0||s>o||l<0||l>r)){for(var f=j.state.radius,h=T(f,r,o,s,l),g=v.default.getNumberOfColors(),m=0;m<g;m++)m!==d&&c[m]&&c[m].pixelData&&(w(h,c[m],o,!0),c[m].invalidated=!0);M(t,c,h)}}function M(e,t,n){var a=function(e){return e.event&&e.event.ctrlKey||e.ctrlKey}(e),r=e.image.columns,o=j.state.drawColorId;if(!a||t[o]){if(t[o]||(t[o]={}),!t[o].pixelData){var i=m.default.cornerstone.getEnabledElement(e.element).uuid,s=j.getters.imageBitmapCacheForElement(i);s&&(s[o]=null),t[o].pixelData=new Uint8ClampedArray(e.image.width*e.image.height)}var l=t[o];w(n,l,r,a),l.invalidated=!0}}},"./tools/brush/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/brush/BrushTool.js");n.d(t,"BrushTool",function(){return a.default}),t.default={BrushTool:a.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolColors.js"),l=n("./store/index.js").modules.cursor,u=function(){function e(t,n){r()(this,e),this.iconGroupString=t,this.options=Object.assign({},l.getters.defaultOptions(),n)}return i()(e,[{key:"getIconSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(e)}},{key:"getIconWithPointerSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconWithPointerSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(e)}},{key:"_generateIconWithPointerSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.mousePointerGroupString,a=t.iconSize,r=t.viewBox,o=a/Math.max(r.x,r.y),i=16+a,s='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(i,'" height="').concat(i,'" viewBox="0 0 ').concat(i," ").concat(i,'"\n      >\n        <g>\n          ').concat(n,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(o,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(s,t)}},{key:"_generateIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.iconSize,a=t.viewBox,r='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n,'" height="').concat(n,'" viewBox="0 0\n        ').concat(a.x," ").concat(a.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(r,t)}},{key:"_injectColors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.activeColor||s.default.getActiveColor(),a=t.toolColor||s.default.getToolColor(),r=t.fillColor||s.default.getFillColor();return e.replace(/ACTIVE_COLOR/g,"".concat(n)).replace(/TOOL_COLOR/g,"".concat(a)).replace(/FILL_COLOR/g,"".concat(r))}},{key:"mousePoint",get:function(){var e=this.options.mousePoint;return"".concat(e.x," ").concat(e.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"angleCursor",function(){return r}),n.d(t,"arrowAnnotateCursor",function(){return o}),n.d(t,"bidirectionalCursor",function(){return i}),n.d(t,"cobbAngleCursor",function(){return s}),n.d(t,"ellipticalRoiCursor",function(){return l}),n.d(t,"freehandMouseCursor",function(){return u}),n.d(t,"freehandSculpterMouseCursor",function(){return c}),n.d(t,"lengthCursor",function(){return d}),n.d(t,"probeCursor",function(){return f}),n.d(t,"rectangleRoiCursor",function(){return h}),n.d(t,"textMarkerCursor",function(){return g}),n.d(t,"crosshairsCursor",function(){return m}),n.d(t,"eraserCursor",function(){return v}),n.d(t,"magnifyCursor",function(){return p}),n.d(t,"panCursor",function(){return b}),n.d(t,"rotateCursor",function(){return y}),n.d(t,"stackScrollCursor",function(){return x}),n.d(t,"wwwcRegionCursor",function(){return w}),n.d(t,"wwwcCursor",function(){return T}),n.d(t,"zoomCursor",function(){return j});var a=n("./tools/cursors/MouseCursor.js"),r=new a.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),o=new a.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),i=new a.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),s=new a.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),l=new a.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),u=new a.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),c=new a.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),d=new a.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),f=new a.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),h=new a.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),g=new a.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),m=new a.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),v=new a.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),p=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),b=new a.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),y=new a.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),x=new a.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),w=new a.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),T=new a.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),j=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}})},"./tools/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",function(){return a.default});var r=n("./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",function(){return r.default});var o=n("./tools/DragProbeTool.js");n.d(t,"DragProbeTool",function(){return o.default});var i=n("./tools/EraserTool.js");n.d(t,"EraserTool",function(){return i.default});var s=n("./tools/FreehandSculpterMouseTool.js");n.d(t,"FreehandSculpterMouseTool",function(){return s.default});var l=n("./tools/MagnifyTool.js");n.d(t,"MagnifyTool",function(){return l.default});var u=n("./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",function(){return u.default});var c=n("./tools/PanTool.js");n.d(t,"PanTool",function(){return c.default});var d=n("./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",function(){return d.default});var f=n("./tools/RotateTool.js");n.d(t,"RotateTool",function(){return f.default});var h=n("./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",function(){return h.default});var g=n("./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",function(){return g.default});var m=n("./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",function(){return m.default});var v=n("./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",function(){return v.default});var p=n("./tools/StackScrollTool.js");n.d(t,"StackScrollTool",function(){return p.default});var b=n("./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",function(){return b.default});var y=n("./tools/WwwcTool.js");n.d(t,"WwwcTool",function(){return y.default});var x=n("./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",function(){return x.default});var w=n("./tools/ZoomTool.js");n.d(t,"ZoomTool",function(){return w.default});var T=n("./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",function(){return T.default}),t.default={CrosshairsTool:a.default,DoubleTapFitToWindowTool:r.default,DragProbeTool:o.default,EraserTool:i.default,FreehandSculpterMouseTool:s.default,MagnifyTool:l.default,PanMultiTouchTool:u.default,PanTool:c.default,ReferenceLinesTool:d.default,RotateTool:f.default,RotateTouchTool:h.default,ScaleOverlayTool:g.default,StackScrollMouseWheelTool:m.default,StackScrollMultiTouchTool:v.default,StackScrollTool:p.default,WwwcRegionTool:b.default,WwwcTool:y.default,ZoomMouseWheelTool:x.default,ZoomTool:w.default,ZoomTouchPinchTool:T.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/pointProjector.js");t.default=function(e,t){var n=Object(a.planePlaneIntersection)(e,t);if(n)return{start:Object(a.projectPatientPointToImagePlane)(n.start,e),end:Object(a.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/referenceLines/calculateReferenceLine.js"),o=n("./stateManagement/toolColors.js"),i=n("./util/convertToVector3.js"),s=n("./drawing/index.js");t.default=function(e,t,n,l){var u=a.default.cornerstone,c=u.getEnabledElement(n).image,d=u.getEnabledElement(l).image;if(c&&d){var f=u.metaData.get("imagePlaneModule",c.imageId),h=u.metaData.get("imagePlaneModule",d.imageId);if(f&&h&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&h.rowCosines&&h.columnCosines&&h.imagePositionPatient&&f.frameOfReferenceUID===h.frameOfReferenceUID){f.rowCosines=Object(i.default)(f.rowCosines),f.columnCosines=Object(i.default)(f.columnCosines),f.imagePositionPatient=Object(i.default)(f.imagePositionPatient),h.rowCosines=Object(i.default)(h.rowCosines),h.columnCosines=Object(i.default)(h.columnCosines),h.imagePositionPatient=Object(i.default)(h.imagePositionPatient);var g=f.rowCosines.clone().cross(f.columnCosines),m=h.rowCosines.clone().cross(h.columnCosines),v=g.angleTo(m);if(!((v=Math.abs(v))<.5)){var p=Object(r.default)(f,h);if(p){var b=o.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(s.draw)(e,function(e){Object(s.drawLine)(e,t.element,p.start,p.end,{color:b})})}}}}}},"./util/SaveAs.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=e.querySelector("canvas");if(a.msToBlob){var r=a.msToBlob();return window.navigator.msSaveBlob(r,t)}var o=document.createElement("a");if(o.download=t,o.href=a.toDataURL(n,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}else o.fireEvent&&o.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),o=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return{angle:180*Math.acos((Math.pow(a,2)+Math.pow(r,2)-Math.pow(o,2))/(2*a*r))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/brush/drawBrush.js":function(e,t,n){"use strict";n.r(t),n.d(t,"drawBrushPixels",function(){return o}),n.d(t,"drawBrushOnCanvas",function(){return i});var a=n("./externalModules.js"),r=n("./drawing/index.js");function o(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.pixelData;e.forEach(function(e){var t,o=(t=e[0],e[1]*n+t);r[o]=a?0:1}),a&&!r.some(function(e){return 0!==e})&&delete t.pixelData}function i(e,t,n,o){var i=a.default.cornerstone.pixelToCanvas(o,{x:0,y:0}),s=a.default.cornerstone.pixelToCanvas(o,{x:1,y:1}),l=s.x-i.x,u=s.y-i.y;Object(r.draw)(t,function(t){e.forEach(function(e){var i=a.default.cornerstone.pixelToCanvas(o,{x:e[0],y:e[1]}),s={left:i.x,top:i.y,width:l,height:u};Object(r.fillBox)(t,s,n)})})}},"./util/brush/getCircle.js":function(e,t,n){"use strict";function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=Math.round(a),i=Math.round(r);if(1===e)return[[o,i]];for(var s=[],l=0,u=-e;u<=e;u++){var c=i+u;if(!(c>t||c<0))for(var d=-e;d<=e;d++){var f=o+d;f>n||f<0||d*d+u*u<e*e&&(s[l++]=[o+d,i+u])}}return s}n.r(t),n.d(t,"default",function(){return a})},"./util/brush/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/brush/drawBrush.js"),r=n("./util/brush/getCircle.js");t.default={drawBrushPixels:a.drawBrushPixels,drawBrushOnCanvas:a.drawBrushOnCanvas,getCircle:r.default}},"./util/calculateSUV.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");function r(e){return parseFloat(".".concat(e))}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=a.default.cornerstone,i=o.metaData.get("patientStudyModule",e.imageId),s=o.metaData.get("generalSeriesModule",e.imageId);if(i&&s&&"PT"===s.modality){var l=n?t:t*e.slope+e.intercept,u=i.patientWeight;if(u){var c=o.metaData.get("petIsotopeModule",e.imageId);if(c){var d=c.radiopharmaceuticalInfo,f=d.radiopharmaceuticalStartTime,h=d.radionuclideTotalDose,g=d.radionuclideHalfLife,m=s.seriesTime;if(f&&h&&g&&m){var v=r(m.fractionalSeconds||0)+m.seconds+60*m.minutes+60*m.hours*60-(r(f.fractionalSeconds)+f.seconds+60*f.minutes+60*f.hours*60);return l*u/(h*Math.exp(-v*Math.log(2)/g))*1e3}}}}}},"./util/clip.js":function(e,t,n){"use strict";function a(e,t,n){return Math.min(Math.max(t,e),n)}function r(e,t){e.x=a(e.x,0,t.width),e.y=a(e.y,0,t.height)}n.r(t),n.d(t,"default",function(){return a}),n.d(t,"clipToBox",function(){return r})},"./util/convertToVector3.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e){var t=a.default.cornerstoneMath;return e instanceof t.Vector3?e:new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{x:e.x,y:e.y}}n.r(t),t.default=function(e){return{page:a(e.page),image:a(e.image),client:a(e.client),canvas:a(e.canvas)}}},"./util/debounce.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/isObject.js");t.default=function(e,t,n){var r,o,i,s,l,u,c=0,d=!1,f=!1,h=!0,g=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=r,a=o;return r=o=void 0,c=t,s=e.apply(a,n)}function v(e,t){return g?window.requestAnimationFrame(e):setTimeout(e,t)}function p(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-c>=i}function b(){var e=Date.now();if(p(e))return y(e);l=v(b,function(e){var n=e-c,a=t-(e-u);return f?Math.min(a,i-n):a}(e))}function y(e){return l=void 0,h&&r?m(e):(r=o=void 0,s)}function x(){for(var e=Date.now(),n=p(e),a=arguments.length,i=new Array(a),h=0;h<a;h++)i[h]=arguments[h];if(r=i,o=this,u=e,n){if(void 0===l)return function(e){return c=e,l=v(b,t),d?m(e):s}(u);if(f)return l=v(b,t),m(u)}return void 0===l&&(l=v(b,t)),s}return t=Number(t)||0,Object(a.default)(n)&&(d=Boolean(n.leading),i=(f="maxWait"in n)?Math.max(Number(n.maxWait)||0,t):i,h="trailing"in n?Boolean(n.trailing):h),x.cancel=function(){void 0!==l&&function(e){if(g)return window.cancelAnimationFrame(e);clearTimeout(e)}(l),c=0,r=u=o=l=void 0},x.flush=function(){return void 0===l?s:y(Date.now())},x.pending=function(){return void 0!==l},x}},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/pointInEllipse.js");t.default=function(e,t){for(var n=0,r=0,o=0,i=0,s=null,l=null,u=t.top;u<t.top+t.height;u++)for(var c=t.left;c<t.left+t.width;c++){var d={x:c,y:u};Object(a.default)(t,d)&&(null===s&&(s=e[i],l=e[i]),n+=e[i],r+=e[i]*e[i],s=Math.min(s,e[i]),l=Math.max(l,e[i]),o++),i++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var f=n/o,h=r/o-f*f;return{count:o,mean:f,variance:h,stdDev:Math.sqrt(h),min:s,max:l}}},"./util/ellipse/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",function(){return a.default});var r=n("./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",function(){return r.default}),t.default={calculateEllipseStatistics:a.default,pointInEllipse:r.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.width/2,a=e.height/2;if(n<=0||a<=0)return!1;var r=e.left+n,o=e.top+a,i=t.x-r,s=t.y-o;return i*i/(n*n)+s*s/(a*a)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"moveHandleNearImagePoint",function(){return i}),n.d(t,"findHandleDataNearImagePoint",function(){return s}),n.d(t,"moveAnnotation",function(){return l});var a=n("./store/index.js"),r=n("./manipulators/getHandleNearImagePoint.js"),o=n("./manipulators/index.js"),i=function(e,t,n,r,i){n.active=!0,a.state.isToolLocked=!0,Object(o.moveHandle)(e.detail,t.name,n,r,t.options,i),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()},s=function(e,t,n,o){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",s=0;s<t.data.length;s++){var l=t.data[s],u=Object(r.default)(e,l.handles,o,"mouse"===i?a.state.clickProximity:a.state.touchProximity);if(u)return{handle:u,data:l}}},l=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",i=Object.assign({},{doneMovingCallback:function(){n.active=!1,a.state.isToolLocked=!1}},t.options);n.active=!0,a.state.isToolLocked=!0,Object(o.moveAllHandles)(e.detail,t.name,n,null,i,r),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t,n){r()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=a,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolState.js"),l=n("./externalModules.js"),u=n("./util/freehand/ClickedLineData.js"),c=function(){function e(t,n){r()(this,e),this._eventData=t,this._toolName=n}return i()(e,[{key:"findLine",value:function(){var e=this.findTool();if(null===e)return null;var t=this._getCloseLinesInTool(e);return t?this._findCorrectLine(e,t):null}},{key:"findTool",value:function(){return this._toolData=Object(s.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData?this._nearestHandleToPointAllTools().toolIndex:null}},{key:"_nearestHandleToPointAllTools",value:function(){for(var e=this._toolData,t={toolIndex:null,handleIndex:null,distance:1/0},n=0;n<e.data.length;n++){var a=this._nearestHandleToPoint(n);null!==a&&(a.distance<t.distance&&(t=a))}return t}},{key:"_nearestHandleToPoint",value:function(e){var t=this._eventData,n=this._toolData.data[e],a=n.handles.points;if(void 0===a)return null;if(!1===n.visible)return null;for(var r={toolIndex:e,handleIndex:null,distance:1/0},o=0;o<a.length;o++){var i=l.default.cornerstone.pixelToCanvas(t.element,a[o]),s=l.default.cornerstoneMath.point.distance(i,this._mousePoint);s<r.distance&&(r.handleIndex=o,r.distance=s)}return r}},{key:"_getCloseLinesInTool",value:function(t){for(var n=this._toolData.data[t].handles.points,a=[],r=0;r<n.length;r++){var o=e.getNextHandleIndex(r,n.length);this._distanceOfPointfromLine(n[r],n[o])<10&&a.push([r,o])}return a}},{key:"_findCorrectLine",value:function(e,t){for(var n=0;n<t.length;n++)if(this._pointProjectsToLineSegment(e,t[n]))return new u.default(e,t[n]);return null}},{key:"_pointProjectsToLineSegment",value:function(t,n){var a=this._eventData,r=this._toolData.data[t],o=r.handles.points;if(void 0!==r.handles.points){if(!1===r.visible)return!1;var i=o[n[0]],s=o[n[1]],l=e.getCanvasPointsFromHandles(i,s,a.element),u=e.getLineAsVector(l),c=this._getLineOriginToMouseAsVector(l),d=(c[0]*u[0]+c[1]*u[1])/u.magnitude;return d>0&&d<u.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(e){return[this._mousePoint.x-e[0].x,this._mousePoint.y-e[0].y]}},{key:"_distanceOfPointfromLine",value:function(e,t){var n=this._eventData,a=l.default.cornerstone.pixelToCanvas(n.element,e),r=l.default.cornerstone.pixelToCanvas(n.element,t),o=this._mousePoint;return Math.abs((r.y-a.y)*o.x-(r.x-a.x)*o.y+r.x*a.y-r.y*a.x)/l.default.cornerstoneMath.point.distance(a,r)}}],[{key:"getCanvasPointsFromHandles",value:function(e,t,n){var a=[];return e.x<t.x?(a.push(l.default.cornerstone.pixelToCanvas(n,e)),a.push(l.default.cornerstone.pixelToCanvas(n,t))):(a.push(l.default.cornerstone.pixelToCanvas(n,t)),a.push(l.default.cornerstone.pixelToCanvas(n,e))),a}},{key:"getLineAsVector",value:function(e){var t=[e[1].x-e[0].x,e[1].y-e[0].y];return t.magnitude=l.default.cornerstoneMath.point.distance(e[0],e[1]),t}},{key:"getNextHandleIndex",value:function(e,t){return e<t-1?e+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){t===e.length-1?e[t].lines.push(e[0]):e[t].lines.push(e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/pointInFreehand.js");function r(e,t,n,r){Object(a.default)(e,t)&&(n.value+=r,n.squared+=r*r,n.count++)}t.default=function(e,t,n){var a={count:0,mean:0,variance:0,stdDev:0},o=function(e,t,n){for(var a={value:0,squared:0,count:0},o=0,i=t.top;i<t.top+t.height;i++)for(var s=t.left;s<t.left+t.width;s++){var l={x:s,y:i};r(n,l,a,e[o]),o++}return a}(e,t,n);return 0===o.count?a:(a.count=o.count,a.mean=o.value/o.count,a.variance=o.squared/o.count-a.mean*a.mean,a.stdDev=Math.sqrt(a.variance),a)}},"./util/freehand/freehandArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=0,a=e.length-1;t=t||1;for(var r=0;r<e.length;r++)n+=(e[a].x+e[r].x)*(e[a].y-e[r].y),a=r;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var i=e.length-1,s=0;s<e.length;s++)if(-1===a.indexOf(s)&&-1===a.indexOf(i)){if(r(t,n,o(e[i]),o(e[s])))return!0;i=s}else i=s;return!1}function r(e,t,n,a){var r=!1,o=[i(e,t,n),i(e,t,a),i(n,a,e),i(n,a,t)];return o[0]!==o[1]&&o[2]!==o[3]||(0===o[0]&&s(e,n,t)?r=!0:0===o[1]&&s(e,a,t)?r=!0:0===o[2]&&s(n,e,a)?r=!0:0===o[3]&&s(n,t,a)&&(r=!0),r)}function o(e){return{x:e.x,y:e.y}}function i(e,t,n){var a=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return 0===a?0:a>0?1:2}function s(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}n.r(t),t.default={newHandle:function(e,t){var n=t.length-1;return a(t,o(t[n]),o(e),[n])},end:function(e){var t=e.length-1;return a(e,o(e[t]),o(e[0]),[t,0])},modify:function(e,t){var n=o(e[t]),r=t-1;0===t&&(r=e.length-1);var i=o(e[r]);return!!a(e,n,i,[t,r])||a(e,n,i=o(e[r=t===e.length-1?0:t+1]),[t,r])}}},"./util/freehand/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/calculateFreehandStatistics.js"),r=n("./util/freehand/ClickedLineData.js"),o=n("./util/freehand/freehandArea.js"),i=n("./util/freehand/FreehandHandleData.js"),s=n("./util/freehand/freehandIntersect.js"),l=n("./util/freehand/FreehandLineFinder.js"),u=n("./util/freehand/insertOrDelete.js"),c=n("./util/freehand/pointInFreehand.js"),d=n("./util/freehand/addLine.js");t.default={calculateFreehandStatistics:a.default,ClickedLineData:r.default,freehandArea:o.default,FreehandHandleData:i.default,freehandIntersect:s.default,FreehandLineFinder:l.default,insertOrDelete:u.default,pointInFreehand:c.default,addLine:d.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/FreehandLineFinder.js"),r=n("./util/freehand/FreehandHandleData.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./util/freehand/addLine.js");t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby){var l={toolIndex:t.toolIndex,handleIndex:t.handleNearby};(function(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0===n)return;var a=t.handleIndex,r=t.toolIndex,s=n.data[r],l=s.handles.points;if(l.length<=3)return;a===l.length-1?(l[a-1].lines.pop(),l[a-1].lines.push(l[0])):0===a?(l[l.length-1].lines.pop(),l[l.length-1].lines.push(l[a+1])):(l[a-1].lines.pop(),l[a-1].lines.push(l[a+1]));l.splice(a,1),s.invalidated=!0,s.active=!0,s.highlight=!0,i.default.cornerstone.updateImage(e.element)}).call(this,n,l)}else{var u=new a.default(n,this.name).findLine();u&&function(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0===n)return;var a=n.data[t.toolIndex],l=function(e){for(var t=e.handleIndexArray,n=1/0,a=t.includes(0),r=0;r<t.length;r++){var o=t[r];0!==o&&o<n&&(n=o)}a&&1===n&&(n=0);return++n}(t);if(l===1/0)return;var u=new r.default(e.currentPoints.image),c=a.handles.points;c.splice(l,0,u),c[l-1].lines.pop(),c[l-1].lines.push(e.currentPoints.image),Object(s.default)(c,l),a.active=!0,a.highlight=!0,a.invalidated=!0,i.default.cornerstone.updateImage(e.element)}.call(this,n,u)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){"use strict";function a(e,t,n){return a=e.y,r=t.y,o=n.y,!(!(r<a&&a<o||o<a&&a<r)||!function(e,t,n){if(t.x>e.x&&n.x>e.x)return!0;if(t.x===n.x)return e.x<t.x;if(t.x>n.x){var a=t;t=n,n=a}var r=function(e,t,n){var a=(n.y-t.y)/(n.x-t.x);return{value:t.x+a*(e.x-t.x),gradient:a}}(e,t,n);return Math.sign(r.gradient)*e.y>r.value}(e,t,n));var a,r,o}n.r(t),t.default=function(e,t){for(var n=!1,r=e.length-1,o=0;o<e.length;o++)a(t,e[o],e[r])&&(n=!n),r=o;return n}},"./util/getDefault.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyFromKeyCode.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return a[e]};var a={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",13:"RETURN",8:"BACKSPACE",9:"TAB",46:"DELETE",12:"DELETE",27:"ESCAPE",20:"CAPSLOCK",173:"-",189:"-",109:"-",61:"+",187:"+",107:"+",219:"[",221:"]",59:";",186:";",188:",",190:".",199:"/"}},"./util/getLuminance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e).image,c=[],d=0,f=u.getPixelData();if(u.color)for(s=0;s<o;s++)for(l=0;l<r;l++){var h=f[i=4*((s+n)*u.columns+(l+t))],g=f[i+1],m=f[i+2];c[d++]=.2126*h+.7152*g+.0722*m}else for(s=0;s<o;s++)for(l=0;l<r;l++)i=(s+n)*u.columns+(l+t),c[d++]=f[i]*u.slope+u.intercept;return c}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){"use strict";var a;n.r(t),n.d(t,"getDefaultSimultaneousRequests",function(){return l}),n.d(t,"getMaxSimultaneousRequests",function(){return s}),n.d(t,"setMaxSimultaneousRequests",function(){return i}),n.d(t,"getBrowserInfo",function(){return o}),n.d(t,"isMobileDevice",function(){return u});var r={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function o(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function i(e){a=e}function s(){return a||l()}function l(){var e=o().split(" "),t=e[0],n=e[1],a=r[t];return a?a[n]?a[n]:a.default:r.default}function u(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getRGBPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e),c=[],d=0,f=u.image.getPixelData();if(u.image.color)for(s=0;s<o;s++)for(l=0;l<r;l++){var h=f[i=4*((s+n)*u.image.columns+(l+t))],g=f[i+1],m=f[i+2],v=f[i+3];c[d++]=h,c[d++]=g,c[d++]=m,c[d++]=v}return c}},"./util/isObject.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a);t.default=function(e){var t=r()(e);return null!==e&&("object"===t||"function"===t)}},"./util/lineSegDistance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r){var o=a.default.cornerstone,i={start:o.pixelToCanvas(e,t),end:o.pixelToCanvas(e,n)};return a.default.cornerstoneMath.lineSegment.distanceToPoint(i,r)}},"./util/logger.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLogger",function(){return i}),n.d(t,"enable",function(){return s}),n.d(t,"disable",function(){return l});var a=n("../node_modules/debug/src/browser.js"),r=n.n(a),o=r()("cornerstoneTools");o.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var i=function(e){var t=o.extend(e);return{log:t,warn:console.warn.bind(console),error:console.error.bind(console)}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat("cornerstoneTools",":*");return r.a.enable(e)},l=function(){return r.a.disable()}},"./util/makeUnselectable.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){if(e.boundingBox)return a.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){"use strict";n.r(t),n.d(t,"projectPatientPointToImagePlane",function(){return o}),n.d(t,"imagePointToPatientPoint",function(){return i}),n.d(t,"planePlaneIntersection",function(){return s});var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");function o(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=e.clone().sub(o);return{x:n.dot(i)/t.columnPixelSpacing,y:a.dot(i)/t.rowPixelSpacing}}function i(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=n.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var s=a.clone().multiplyScalar(e.y);s.multiplyScalar(t.rowPixelSpacing);var l=i.add(s);return l.add(o),l}function s(e,t){var n=Object(r.default)(e.rowCosines),o=Object(r.default)(e.columnCosines),s=Object(r.default)(e.imagePositionPatient),l=Object(r.default)(t.rowCosines),u=Object(r.default)(t.columnCosines),c=Object(r.default)(t.imagePositionPatient),d=n.clone().cross(o),f=new a.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(d,s);var h=l.clone().cross(u),g=new a.default.cornerstoneMath.Plane;g.setFromNormalAndCoplanarPoint(h,c);var m=g.clone().intersectPlane(f),v=m.origin,p=m.direction,b=i({x:t.columns,y:t.rows},t),y=c.distanceTo(b),x=new a.default.cornerstoneMath.Line3;x.start=v,x.end=v.clone().add(p.multiplyScalar(y));var w=function(e,t){var n=[];return Object.keys(t).forEach(function(a){var r=t[a],o=e.intersectLine(r);o&&n.push(o)}),n}(x,function(e){var t=i({x:0,y:0},e),n=i({x:e.columns,y:0},e),r=i({x:0,y:e.rows},e),o=i({x:e.columns,y:e.rows},e);return{top:new a.default.cornerstoneMath.Line3(t,n),left:new a.default.cornerstoneMath.Line3(t,r),right:new a.default.cornerstoneMath.Line3(n,o),bottom:new a.default.cornerstoneMath.Line3(r,o)}}(t));if(2===w.length)return{start:w[0],end:w[1]}}},"./util/roundToDecimal.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/scrollToIndex.js"),r=n("./stateManagement/toolState.js"),o=n("./util/clip.js"),i=n("./externalModules.js");function s(e,t,n){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index){e.pending.splice(e.pending.indexOf(t),1);if(e.pending.length>0){s(e,e.pending[0],n)}return}var r=function a(r){var o;if(e.imageIds.indexOf(r.detail.image.imageId)===t.index){e.pending.splice(e.pending.indexOf(t),1);n.removeEventListener(i["default"].cornerstone.EVENTS.NEW_IMAGE,a);if(e.pending.length>0){s(e,e.pending[0],n)}}};n.addEventListener(i["default"].cornerstone.EVENTS.NEW_IMAGE,r);Object(a["default"])(n,t.index)}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=Object(r.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var u=l.data[0];u.pending||(u.pending=[]);var c=u.currentImageIdIndex+t;if(n)c%=u.imageIds.length;else c=Object(o.default)(c,0,u.imageIds.length-1);if(s)Object(a.default)(e,c);else{var d={index:c};u.pending.push(d),function e(t,n,r){if(t.pending[0]===n){if(t.currentImageIdIndex===n.index)return t.pending.splice(t.pending.indexOf(n),1),void(t.pending.length>0&&e(t,t.pending[0],r));r.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,function e(o){t.imageIds.indexOf(o.detail.image.imageId)===n.index&&(t.pending.splice(t.pending.indexOf(n),1),r.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,e),t.pending.length>0&&function e(t,n,r){if(t.pending[0]===n){if(t.currentImageIdIndex===n.index)return t.pending.splice(t.pending.indexOf(n),1),void(t.pending.length>0&&e(t,t.pending[0],r));r.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,function a(o){t.imageIds.indexOf(o.detail.image.imageId)===n.index&&(t.pending.splice(t.pending.indexOf(n),1),r.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,a),t.pending.length>0&&e(t,t.pending[0],r))}),Object(a.default)(r,n.index)}}(t,t.pending[0],r))}),Object(a.default)(r,n.index)}}(u,d,e)}}}},"./util/scrollToIndex.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),i=n("./requestPool/requestPoolManager.js"),s=n("./stateManagement/loadHandlerManager.js"),l=n("./util/triggerEvent.js");t.default=function(e,t){var n=Object(o.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var u,c=r.default.cornerstone;if(n.data.length>1){var d=Object(o.getToolState)(e,"stackRenderer");d&&d.data&&d.data.length&&(u=d.data[0])}var f=n.data[0];t<0&&(t+=f.imageIds.length);var h=s.default.getStartLoadHandler(),g=s.default.getEndLoadHandler(),m=s.default.getErrorLoadingHandler();if(t!==f.currentImageIdIndex){h&&h(e);var v={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var p=f.imageIds[t];(Boolean(f.preventCache)?c.loadImage(p):c.loadAndCacheImage(p)).then(function(a){if(f.currentImageIdIndex===t){try{c.getEnabledElement(e)}catch(e){return}u?(u.currentImageIdIndex=t,u.render(e,n.data)):c.displayImage(e,a),g&&g(e,a)}},function(n){var a=f.imageIds[t];m&&m(e,a,n)}),i.default.startGrabbing(),Object(l.default)(e,a.default.STACK_SCROLL,v)}}}},"./util/setContextToDisplayFontSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){return a.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:n/e.viewport.scale/.1,lineHeight:n/e.viewport.scale/.1,fontScale:.1}}},"./util/throttle.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/debounce.js"),r=n("./util/isObject.js");t.default=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(r.default)(n)&&(o="leading"in n?Boolean(n.leading):o,i="trailing"in n?Boolean(n.trailing):i),Object(a.default)(e,t,{leading:o,trailing:i,maxWait:t})}},"./util/triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./util/wait.js":function(e,t,n){"use strict";n.r(t),n.d(t,"wait",function(){return r}),n.d(t,"waitForEnabledElementImageToLoad",function(){return o});var a=n("./externalModules.js"),r=function(e){return new Promise(function(t){return setTimeout(t,e)})};function o(e){try{var t=a.default.cornerstone.getEnabledElement(e);return t.image?t:r(250).then(function(){return o(e)})}catch(e){return null}}t.default=r},"./util/zoom/changeViewportScale.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=n.maxScale,r=n.minScale,o=Math.log(e.scale)/Math.log(1.7)+t,i=Math.pow(1.7,o);return e.scale=a&&i>a?a:r&&i<r?r:i,e}},"./util/zoom/correctShift.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=t.hflip,a=t.vflip,r=t.rotation;if(e.x*=n?-1:1,e.y*=a?-1:1,0!==r){var o=r*Math.PI/180,i=Math.cos(o),s=Math.sin(o),l=e.x*i-e.y*s,u=e.x*s+e.y*i;e.x=l,e.y=u}return e}},"./util/zoom/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",function(){return a.default});var r=n("./util/zoom/correctShift.js");n.d(t,"correctShift",function(){return r.default}),t.default={changeViewportScale:a.default,correctShift:r.default}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="3.7.0"}})},e.exports=a()},function(e,t,n){var a;window,a=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(!w[e]||!x[e])return;for(var n in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--p&&0===b&&_()}(e,n),t&&t(e,n)};var n,a=!0,r="72ed982d5a0046aad5fa",o=1e4,i={},s=[],l=[];function u(e){var t=M[e];if(!t)return O;var a=function(a){return t.hot.active?(M[a]?-1===M[a].parents.indexOf(e)&&M[a].parents.push(e):(s=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),s=[]),O(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return O[e]},set:function(t){O[e]=t}}};for(var o in O)Object.prototype.hasOwnProperty.call(O,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===f&&h("prepare"),b++,O.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===f&&(y[e]||C(e),0===b&&0===p&&_())}},a.t=function(e,t){return 1&t&&(e=a(e)),O.t(e,-2&t)},a}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:j,apply:E,status:function(e){if(!e)return f;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:i[e]};return n=void 0,t}var d=[],f="idle";function h(e){f=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var g,m,v,p=0,b=0,y={},x={},w={};function T(e){return+e+""===e?+e:e}function j(e){if("idle"!==f)throw new Error("check() is only allowed in idle status");return a=e,h("check"),(t=o,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=O.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(e){return n(e)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return h("idle"),null;x={},y={},w=e.c,v=e.h,h("prepare");var t=new Promise(function(e,t){g={resolve:e,reject:t}});m={};return C("cornerstone"),"prepare"===f&&0===b&&0===p&&_(),t});var t}function C(e){w[e]?(x[e]=!0,p++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=O.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):y[e]=!0}function _(){h("ready");var e=g;if(g=null,e)if(a)Promise.resolve().then(function(){return E(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(T(n));e.resolve(t)}}function E(t){if("ready"!==f)throw new Error("apply() is only allowed in ready status");var n,a,o,l,u;function c(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=M[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],c=M[u];if(c){if(c.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(c.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),d(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var g={},p=[],b={},y=function(){console.warn("[HMR] unexpected require("+j.moduleId+") to disposed module")};for(var x in m)if(Object.prototype.hasOwnProperty.call(m,x)){var j;u=T(x);var C=!1,_=!1,E=!1,I="";switch((j=m[x]?c(u):{type:"disposed",moduleId:x}).chain&&(I="\nUpdate propagation: "+j.chain.join(" -> ")),j.type){case"self-declined":t.onDeclined&&t.onDeclined(j),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+j.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(j),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+j.moduleId+" in "+j.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(j),t.ignoreUnaccepted||(C=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(j),_=!0;break;case"disposed":t.onDisposed&&t.onDisposed(j),E=!0;break;default:throw new Error("Unexception type "+j.type)}if(C)return h("abort"),Promise.reject(C);if(_)for(u in b[u]=m[u],d(p,j.outdatedModules),j.outdatedDependencies)Object.prototype.hasOwnProperty.call(j.outdatedDependencies,u)&&(g[u]||(g[u]=[]),d(g[u],j.outdatedDependencies[u]));E&&(d(p,[j.moduleId]),b[u]=y)}var S,P=[];for(a=0;a<p.length;a++)u=p[a],M[u]&&M[u].hot._selfAccepted&&P.push({module:u,errorHandler:M[u].hot._selfAccepted});h("dispose"),Object.keys(w).forEach(function(e){!1===w[e]&&function(e){delete installedChunks[e]}(e)});for(var k,L,D=p.slice();D.length>0;)if(u=D.pop(),l=M[u]){var A={},R=l.hot._disposeHandlers;for(o=0;o<R.length;o++)(n=R[o])(A);for(i[u]=A,l.hot.active=!1,delete M[u],delete g[u],o=0;o<l.children.length;o++){var H=M[l.children[o]];H&&((S=H.parents.indexOf(u))>=0&&H.parents.splice(S,1))}}for(u in g)if(Object.prototype.hasOwnProperty.call(g,u)&&(l=M[u]))for(L=g[u],o=0;o<L.length;o++)k=L[o],(S=l.children.indexOf(k))>=0&&l.children.splice(S,1);for(u in h("apply"),r=v,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in g)if(Object.prototype.hasOwnProperty.call(g,u)&&(l=M[u])){L=g[u];var U=[];for(a=0;a<L.length;a++)if(k=L[a],n=l.hot._acceptedDependencies[k]){if(-1!==U.indexOf(n))continue;U.push(n)}for(a=0;a<U.length;a++){n=U[a];try{n(L)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:L[a],error:e}),t.ignoreErrored||B||(B=e)}}}for(a=0;a<P.length;a++){var N=P[a];u=N.module,s=[u];try{O(u)}catch(e){if("function"==typeof N.errorHandler)try{N.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||B||(B=n),B||(B=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||B||(B=e)}}return B?(h("fail"),Promise.reject(B)):(h("idle"),new Promise(function(e){e(p)}))}var M={};function O(t){if(M[t])return M[t].exports;var n=M[t]={i:t,l:!1,exports:{},hot:c(t),parents:(l=s,s=[],l),children:[]};return e[t].call(n.exports,n,n.exports,u(t)),n.l=!0,n.exports}return O.m=e,O.c=M,O.d=function(e,t,n){O.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},O.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O.t=function(e,t){if(1&t&&(e=O(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(O.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)O.d(n,a,function(t){return e[t]}.bind(null,a));return n},O.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return O.d(t,"a",t),t},O.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},O.p="",O.h=function(){return r},u("./index.js")(O.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),o=Object(r.default)(n);return o.invert(),o.transformPoint(t.x,t.y)}},"./colors/colormap.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getColormapsList",function(){return l}),n.d(t,"getColormap",function(){return u});var a=n("./colors/lookupTable.js"),r=[0,0,0,0],o={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function i(e,t){for(var n=0,a=e.length-1;n<=a;){var r=n+Math.floor((a-n)/2),o=e[r];if(o===t)return r;t<o?a=r-1:n=r+1}return n}function s(e,t,n){var a,r=[],o=[],s=[],l=[];for(n=null===n?1:n,a=0;a<t.length;a++){var u=t[a];r.push((e-1)*u[0]),o.push(u[1]),s.push(u[1])}var c=function(e,t,n){for(var a=(t-e)/((n=null===n?100:n)-1),r=[];n-- >0;)r.push(e),e+=a;return r[r.length-1]=t,r}(0,1,e);for(a=0;a<e;a++)c[a]=(e-1)*Math.pow(c[a],n);var d=function(e,t){var n,a=[],r=t.length;for(e.sort(function(e,t){return e-t}),n=0;n<r;n++)a[n]=i(e,t[n]);return a}(r,c);for(a=1;a<e-1;a++){var f=d[a],h=(c[a]-r[f-1])/(r[f]-r[f-1]),g=o[f]-s[f-1];l[a]=h*g+s[f-1]}return l[0]=s[0],l[e-1]=o[t.length-1],l}function l(){var e=[];return Object.keys(o).forEach(function(t){if(o.hasOwnProperty(t)){var n=o[t];e.push({id:t,name:n.name})}}),e.sort(function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n===a?0:n<a?-1:1}),e}function u(e,t){var n=o[e];return n||(n=o[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){var a,r=[];n=null===n?1:n;var o=s(t=null===t?256:t,e.red,n),i=s(t,e.green,n),l=s(t,e.blue,n);for(a=0;a<t;a++){var u=[Math.round(255*o[a]),Math.round(255*i[a]),Math.round(255*l[a]),255];r.push(u)}return r}(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(r);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:r},getColorRepeating:function(e){var t=n.colors.length;return e=t?e%t:0,this.getColor(e)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=n.colors.length;e.setNumberOfTableValues(t);for(var a=0;a<t;a++)e.setTableValue(a,n.colors[a])}},createLookupTable:function(){var e=new a.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}}},"./colors/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/colormap.js"),r=n("./colors/lookupTable.js");t.default={getColormap:a.getColormap,getColormapsList:a.getColormapsList,LookupTable:r.default}},"./colors/lookupTable.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t);var r=0,o=1;function i(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var a=[];if(0===t)return a[0]=n,a[1]=n,a[2]=n,a;var r=Math.floor(6*e),o=6*e-r,i=n*(1-t),s=n*(1-t*o),l=n*(1-t*(1-o));switch(r){case 0:case 6:a[0]=n,a[1]=l,a[2]=i;break;case 1:a[0]=s,a[1]=n,a[2]=i;break;case 2:a[0]=i,a[1]=n,a[2]=l;break;case 3:a[0]=i,a[1]=s,a[2]=n;break;case 4:a[0]=l,a[1]=i,a[2]=n;break;case 5:a[0]=n,a[1]=i,a[2]=s}return a}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}var t,n,s;return t=e,(n=[{key:"setNumberOfTableValues",value:function(e){this.NumberOfColors=e}},{key:"setRamp",value:function(e){this.Ramp=e}},{key:"setTableRange",value:function(e,t){this.TableRange[0]=e,this.TableRange[1]=t}},{key:"setHueRange",value:function(e,t){this.HueRange[0]=e,this.HueRange[1]=t}},{key:"setSaturationRange",value:function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}},{key:"setValueRange",value:function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}},{key:"setRange",value:function(e,t){this.InputRange[0]=e,this.InputRange[1]=t}},{key:"setAlphaRange",value:function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}},{key:"getColor",value:function(e){return this.mapValue(e)}},{key:"build",value:function(e){if(!(this.Table.length>1)||e){this.Table=[];var t,n,a,r,o=this.NumberOfColors-1;o?(t=(this.HueRange[1]-this.HueRange[0])/o,n=(this.SaturationRange[1]-this.SaturationRange[0])/o,a=(this.ValueRange[1]-this.ValueRange[0])/o,r=(this.AlphaRange[1]-this.AlphaRange[0])/o):t=n=a=r=0;for(var s=0;s<=o;s++){var l=this.HueRange[0]+s*t,u=this.SaturationRange[0]+s*n,c=this.ValueRange[0]+s*a,d=this.AlphaRange[0]+s*r,f=i(l,u,c),h=[];switch(this.Ramp){case"scurve":h[0]=Math.floor(127.5*(1+Math.cos((1-f[0])*Math.PI))),h[1]=Math.floor(127.5*(1+Math.cos((1-f[1])*Math.PI))),h[2]=Math.floor(127.5*(1+Math.cos((1-f[2])*Math.PI))),h[3]=Math.floor(255*d);break;case"linear":h[0]=Math.floor(255*f[0]+.5),h[1]=Math.floor(255*f[1]+.5),h[2]=Math.floor(255*f[2]+.5),h[3]=Math.floor(255*d+.5);break;case"sqrt":h[0]=Math.floor(255*Math.sqrt(f[0])+.5),h[1]=Math.floor(255*Math.sqrt(f[1])+.5),h[2]=Math.floor(255*Math.sqrt(f[2])+.5),h[3]=Math.floor(255*Math.sqrt(d)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(h)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var e=this.NumberOfColors,t=e+r,n=e+o,a=e+2;this.UseBelowRangeColor||0===e?this.Table[t]=this.BelowRangeColor:this.Table[t]=this.Table[0],this.UseAboveRangeColor||0===e?this.Table[n]=this.AboveRangeColor:this.Table[n]=this.Table[e-1],this.Table[a]=this.NaNColor}},{key:"mapValue",value:function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}},{key:"getIndex",value:function(e){var t={Range:[]};if(t.MaxIndex=this.NumberOfColors-1,t.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?t.Scale=Number.MAX_VALUE:t.Scale=t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;var n=function(e,t){var n;return n=e<t.Range[0]?t.MaxIndex+r+1.5:e>t.Range[1]?t.MaxIndex+o+1.5:(e+t.Shift)*t.Scale,Math.floor(n)}(e,t);return n===this.NumberOfColors+r?n=0:n===this.NumberOfColors+o&&(n=this.NumberOfColors-1),n}},{key:"setTableValue",value:function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index (".concat(e,")"));e>=this.NumberOfColors&&new Error("Index ".concat(e," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}}])&&a(t.prototype,n),s&&a(t,s),e}();t.default=s},"./disable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){if(void 0===e)throw new Error("disable: element must not be undefined");for(var t=Object(a.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var i={element:e};Object(r.default)(e,o.default.ELEMENT_DISABLED,i),Object(r.default)(o.events,o.default.ELEMENT_DISABLED,i),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}}},"./displayImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js"),o=n("./updateImage.js"),i=n("./internal/now.js"),s=n("./layers.js"),l=n("./triggerEvent.js"),u=n("./events.js");t.default=function(e,t,n){if(void 0===e)throw new Error("displayImage: parameter element must not be undefined");if(void 0===t)throw new Error("displayImage: parameter image must not be undefined");var c,d=Object(a.getEnabledElement)(e),f=d.image;if(d.image=t,d.layers&&d.layers.length&&Object(s.setLayerImage)(e,t),void 0===d.viewport&&(d.viewport=Object(r.default)(d.canvas,t)),n)for(var h in n)null!==n[h]&&(d.viewport[h]=n[h]);void 0!==d.lastImageTimeStamp&&(c=(1e3/(Object(i.default)()-d.lastImageTimeStamp)).toFixed());d.lastImageTimeStamp=Object(i.default)();var g={viewport:d.viewport,element:d.element,image:d.image,oldImage:f,enabledElement:d,frameRate:c};Object(l.default)(d.element,u.default.NEW_IMAGE,g),Object(o.default)(e)}},"./draw.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);if(void 0===t.image)throw new Error("draw: image has not been loaded yet");Object(r.default)(t)}},"./drawInvalidated.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(){for(var e=Object(a.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&Object(r.default)(n,!0)}}},"./enable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./resize.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/requestAnimationFrame.js"),s=n("./internal/tryEnableWebgl.js"),l=n("./triggerEvent.js"),u=n("./generateUUID.js"),c=n("./events.js"),d=n("./internal/getCanvas.js");t.default=function(e,t){if(void 0===e)throw new Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(s.default)(t);var n={element:e,canvas:Object(d.default)(e),image:void 0,invalid:!1,needsRedraw:!0,options:t,layers:[],data:{},renderingTools:{},uuid:Object(u.default)()};Object(a.addEnabledElement)(n),Object(l.default)(c.events,c.default.ELEMENT_ENABLED,n),Object(r.default)(e,!0),function e(t){if(void 0!==n.canvas){var a={enabledElement:n,timestamp:t};Object(l.default)(n.element,c.default.PRE_RENDER,a),n.needsRedraw&&function(e){return void 0!==e.image||e.layers.length>0}(n)&&Object(o.default)(n,n.invalid),Object(i.default)(e)}}()}},"./enabledElementData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getElementData",function(){return r}),n.d(t,"removeElementData",function(){return o});var a=n("./enabledElements.js");function r(e,t){var n=Object(a.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]}function o(e,t){delete Object(a.getEnabledElement)(e).data[t]}},"./enabledElements.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getEnabledElement",function(){return r}),n.d(t,"addEnabledElement",function(){return o}),n.d(t,"getEnabledElementsByImageId",function(){return i}),n.d(t,"getEnabledElements",function(){return s});var a=[];function r(e){if(void 0===e)throw new Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<a.length;t++)if(a[t].element===e)return a[t];throw new Error("element not enabled")}function o(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");a.push(e)}function i(e){var t=[];return a.forEach(function(n){n.image&&n.image.imageId===e&&t.push(n)}),t}function s(){return a}},"./events.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t),n.d(t,"events",function(){return r});t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.namespaces={}}var t,n,r;return t=e,(n=[{key:"addEventNamespaceListener",value:function(e,t){e.indexOf(".")<=0||(this.namespaces[e]=t,this.addEventListener(e.split(".")[0],t))}},{key:"removeEventNamespaceListener",value:function(e){e.indexOf(".")<=0||!this.namespaces[e]||(this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e])}},{key:"addEventListener",value:function(e,t){e.indexOf(".")>0?this.addEventNamespaceListener(e,t):(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}},{key:"removeEventListener",value:function(e,t){if(e.indexOf(".")>0)this.removeEventNamespaceListener(e);else if(e in this.listeners)for(var n=this.listeners[e],a=0,r=n.length;a<r;a++)if(n[a]===t)return void n.splice(a,1)}},{key:"dispatchEvent",value:function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type],n=0,a=t.length;n<a;n++)t[n].call(this,e);return!e.defaultPrevented}}])&&a(t.prototype,n),r&&a(t,r),e}())},"./falseColorMapping.js":function(e,t,n){"use strict";n.r(t),n.d(t,"convertImageToFalseColorImage",function(){return s}),n.d(t,"convertToFalseColorImage",function(){return l}),n.d(t,"restoreImage",function(){return i});var a=n("./enabledElements.js"),r=n("./pixelDataToFalseColorData.js"),o=n("./colors/colormap.js");function i(e){return!(!e.restore||"function"!=typeof e.restore)&&(e.restore(),!0)}function s(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=(t=function(e){return e&&"string"==typeof e&&(e=Object(o.getColormap)(e)),e}(t)).getId();if(e.colormapId===n)return!1;if(i(e),n){var a=e.minPixelValue||0,s=e.maxPixelValue||255;e.restore=function(e){if(e.restore)return e.restore;var t=e.color,n=e.rgba,a=e.cachedLut,r=e.slope,o=e.windowWidth,i=e.windowCenter,s=e.minPixelValue,l=e.maxPixelValue;return function(){if(e.color=t,e.rgba=n,e.cachedLut=a,e.slope=r,e.windowWidth=o,e.windowCenter=i,e.minPixelValue=s,e.maxPixelValue=l,e.origPixelData){var u=e.origPixelData;e.getPixelData=function(){return u}}e.origPixelData=void 0,e.colormapId=void 0,e.falseColor=void 0}}(e);var l=t.createLookupTable();l.setTableRange(a,s),Object(r.default)(e,l);var u=function(e){for(var t,n=Number.MAX_VALUE,a=Number.MIN_VALUE,r=e.length,o=0;o<r;o++)n=n<(t=e[o])?n:t,a=a>t?a:t;return{minPixelValue:n,maxPixelValue:a}}(e.getPixelData());e.minPixelValue=u.minPixelValue,e.maxPixelValue=u.maxPixelValue,e.windowWidth=255,e.windowCenter=128,e.colormapId=n}return!0}function l(e,t){return s(Object(a.getEnabledElement)(e).image,t)}},"./fitToWindow.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./updateImage.js"),o=n("./internal/getImageFitScale.js");t.default=function(e){var t=Object(a.getEnabledElement)(e),n=t.image;t.viewport.scale=Object(o.default)(t.canvas,n,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0,Object(r.default)(e)}},"./generateUUID.js":function(e,t,n){"use strict";n.r(t),t.default=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}},"./getDefaultViewportForImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n.canvas,t)}},"./getImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){return Object(a.getEnabledElement)(e).image}},"./getPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./getStoredPixels.js"),o=n("./internal/getModalityLUT.js");t.default=function(e,t,n,i,s){var l=Object(r.default)(e,t,n,i,s),u=Object(a.getEnabledElement)(e),c=Object(o.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return l.map(c)}},"./getStoredPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e,t,n,r,o){if(void 0===e)throw new Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=Object(a.getEnabledElement)(e),s=[],l=0,u=i.image.getPixelData(),c=0;c<o;c++)for(var d=0;d<r;d++){var f=(c+n)*i.image.columns+(d+t);s[l++]=u[f]}return s}},"./getViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){var t=Object(a.getEnabledElement)(e).viewport;if(void 0!==t)return Object.assign({},t)}},"./imageCache.js":function(e,t,n){"use strict";n.r(t),n.d(t,"cachedImages",function(){return l}),n.d(t,"setMaximumSizeBytes",function(){return u}),n.d(t,"putImageLoadObject",function(){return d}),n.d(t,"getImageLoadObject",function(){return f}),n.d(t,"removeImageLoadObject",function(){return h}),n.d(t,"getCacheInfo",function(){return g}),n.d(t,"purgeCache",function(){return m}),n.d(t,"changeImageIdCacheSize",function(){return v});var a=n("./events.js"),r=n("./triggerEvent.js"),o=1073741824,i=0,s={},l=[];function u(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");o=e,Object(r.default)(a.events,a.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),c()}function c(){if(!(i<=o)){for(l.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});i>o;){var e=l[l.length-1].imageId;h(e),Object(r.default)(a.events,a.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=g();Object(r.default)(a.events,a.default.IMAGE_CACHE_FULL,t)}}function d(e,t){if(void 0===e)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===s.hasOwnProperty(e))throw new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};s[e]=n,l.push(n),t.promise.then(function(e){if(-1!==l.indexOf(n)){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,i+=n.sizeInBytes;var t={action:"addImage",image:n};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,t),n.sharedCacheKey=e.sharedCacheKey,c()}},function(){var t=s[e];l.splice(l.indexOf(t),1),delete s[e]})}function f(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function h(e){if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0===t)throw new Error("removeImageLoadObject: imageId was not present in imageCache");l.splice(l.indexOf(t),1),i-=t.sizeInBytes;var n,o={action:"deleteImage",image:t};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,o),(n=t.imageLoadObject).promise.then(function(){n.decache&&n.decache()},function(){n.decache&&n.decache()}),delete s[e]}function g(){return{maximumSizeInBytes:o,cacheSizeInBytes:i,numberOfImagesCached:l.length}}function m(){for(;l.length>0;){h(l[0].imageId)}}function v(e,t){var n=s[e];n&&n.imageLoadObject.promise.then(function(e){var o=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,i+=o;var s={action:"changeImageSize",image:e};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,s)})}t.default={imageCache:s,cachedImages:l,setMaximumSizeBytes:u,putImageLoadObject:d,getImageLoadObject:f,removeImageLoadObject:h,getCacheInfo:g,purgeCache:m,changeImageIdCacheSize:v}},"./imageLoader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"loadImage",function(){return u}),n.d(t,"loadAndCacheImage",function(){return c}),n.d(t,"registerImageLoader",function(){return d}),n.d(t,"registerUnknownImageLoader",function(){return f});var a,r=n("./imageCache.js"),o=n("./events.js"),i=n("./triggerEvent.js"),s={};function l(e,t){var n=e.indexOf(":"),r=e.substring(0,n),l=s[r];if(null==l){if(void 0!==a)return a(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var u=l(e,t);return u.promise.then(function(e){Object(i.default)(o.events,o.default.IMAGE_LOADED,{image:e})},function(t){var n={imageId:e,error:t};Object(i.default)(o.events,o.default.IMAGE_LOAD_FAILED,n)}),u}function u(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n?n.promise:l(e,t).promise}function c(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n?n.promise:(n=l(e,t),Object(r.putImageLoadObject)(e,n),n.promise)}function d(e,t){s[e]=t}function f(e){var t=a;return a=e,t}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/drawImage.js");n.d(t,"drawImage",function(){return a.default});var r=n("./internal/generateLut.js");n.d(t,"generateLut",function(){return r.default});var o=n("./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",function(){return o.default});var i=n("./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",function(){return i.default});var s=n("./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",function(){return s.default});var l=n("./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",function(){return l.default});var u=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",function(){return u.default});var c=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",function(){return c.default});var d=n("./internal/index.js");n.d(t,"internal",function(){return d.default});var f=n("./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",function(){return f.renderLabelMapImage});var h=n("./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",function(){return h.renderPseudoColorImage});var g=n("./rendering/renderColorImage.js");n.d(t,"renderColorImage",function(){return g.renderColorImage});var m=n("./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",function(){return m.renderGrayscaleImage});var v=n("./rendering/renderWebImage.js");n.d(t,"renderWebImage",function(){return v.renderWebImage});var p=n("./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",function(){return p.default});var b=n("./canvasToPixel.js");n.d(t,"canvasToPixel",function(){return b.default});var y=n("./disable.js");n.d(t,"disable",function(){return y.default});var x=n("./displayImage.js");n.d(t,"displayImage",function(){return x.default});var w=n("./draw.js");n.d(t,"draw",function(){return w.default});var T=n("./drawInvalidated.js");n.d(t,"drawInvalidated",function(){return T.default});var j=n("./enable.js");n.d(t,"enable",function(){return j.default});var C=n("./enabledElementData.js");n.d(t,"getElementData",function(){return C.getElementData}),n.d(t,"removeElementData",function(){return C.removeElementData});var _=n("./enabledElements.js");n.d(t,"getEnabledElement",function(){return _.getEnabledElement}),n.d(t,"addEnabledElement",function(){return _.addEnabledElement}),n.d(t,"getEnabledElementsByImageId",function(){return _.getEnabledElementsByImageId}),n.d(t,"getEnabledElements",function(){return _.getEnabledElements});var E=n("./layers.js");n.d(t,"addLayer",function(){return E.addLayer}),n.d(t,"removeLayer",function(){return E.removeLayer}),n.d(t,"getLayer",function(){return E.getLayer}),n.d(t,"getLayers",function(){return E.getLayers}),n.d(t,"getVisibleLayers",function(){return E.getVisibleLayers}),n.d(t,"setActiveLayer",function(){return E.setActiveLayer}),n.d(t,"getActiveLayer",function(){return E.getActiveLayer}),n.d(t,"purgeLayers",function(){return E.purgeLayers}),n.d(t,"setLayerImage",function(){return E.setLayerImage});var M=n("./fitToWindow.js");n.d(t,"fitToWindow",function(){return M.default});var O=n("./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",function(){return O.default});var I=n("./getImage.js");n.d(t,"getImage",function(){return I.default});var S=n("./getPixels.js");n.d(t,"getPixels",function(){return S.default});var P=n("./getStoredPixels.js");n.d(t,"getStoredPixels",function(){return P.default});var k=n("./getViewport.js");n.d(t,"getViewport",function(){return k.default});var L=n("./imageLoader.js");n.d(t,"loadImage",function(){return L.loadImage}),n.d(t,"loadAndCacheImage",function(){return L.loadAndCacheImage}),n.d(t,"registerImageLoader",function(){return L.registerImageLoader}),n.d(t,"registerUnknownImageLoader",function(){return L.registerUnknownImageLoader});var D=n("./invalidate.js");n.d(t,"invalidate",function(){return D.default});var A=n("./invalidateImageId.js");n.d(t,"invalidateImageId",function(){return A.default});var R=n("./pageToPixel.js");n.d(t,"pageToPixel",function(){return R.default});var H=n("./pixelToCanvas.js");n.d(t,"pixelToCanvas",function(){return H.default});var B=n("./reset.js");n.d(t,"reset",function(){return B.default});var U=n("./resize.js");n.d(t,"resize",function(){return U.default});var N=n("./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",function(){return N.default});var F=n("./setViewport.js");n.d(t,"setViewport",function(){return F.default});var z=n("./updateImage.js");n.d(t,"updateImage",function(){return z.default});var V=n("./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",function(){return V.default});var W=n("./rendering/index.js");n.d(t,"rendering",function(){return W.default});var q=n("./imageCache.js");n.d(t,"imageCache",function(){return q.default});var G=n("./metaData.js");n.d(t,"metaData",function(){return G.default});var Y=n("./webgl/index.js");n.d(t,"webGL",function(){return Y.default});var X=n("./colors/index.js");n.d(t,"colors",function(){return X.default});var Z=n("./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",function(){return Z.convertImageToFalseColorImage}),n.d(t,"convertToFalseColorImage",function(){return Z.convertToFalseColorImage}),n.d(t,"restoreImage",function(){return Z.restoreImage});var $=n("./events.js");n.d(t,"EVENTS",function(){return $.default}),n.d(t,"events",function(){return $.events});var K=n("./triggerEvent.js");n.d(t,"triggerEvent",function(){return K.default});var J={drawImage:a.default,generateLut:r.default,getDefaultViewport:o.default,requestAnimationFrame:i.default,storedPixelDataToCanvasImageData:s.default,storedColorPixelDataToCanvasImageData:l.default,storedPixelDataToCanvasImageDataColorLUT:u.default,storedPixelDataToCanvasImageDataPseudocolorLUT:c.default,internal:d.default,renderLabelMapImage:f.renderLabelMapImage,renderPseudoColorImage:h.renderPseudoColorImage,renderColorImage:g.renderColorImage,renderGrayscaleImage:m.renderGrayscaleImage,renderWebImage:v.renderWebImage,renderToCanvas:p.default,canvasToPixel:b.default,disable:y.default,displayImage:x.default,draw:w.default,drawInvalidated:T.default,enable:j.default,getElementData:C.getElementData,removeElementData:C.removeElementData,getEnabledElement:_.getEnabledElement,addEnabledElement:_.addEnabledElement,getEnabledElementsByImageId:_.getEnabledElementsByImageId,getEnabledElements:_.getEnabledElements,addLayer:E.addLayer,removeLayer:E.removeLayer,getLayer:E.getLayer,getLayers:E.getLayers,getVisibleLayers:E.getVisibleLayers,setActiveLayer:E.setActiveLayer,getActiveLayer:E.getActiveLayer,purgeLayers:E.purgeLayers,setLayerImage:E.setLayerImage,fitToWindow:M.default,getDefaultViewportForImage:O.default,getImage:I.default,getPixels:S.default,getStoredPixels:P.default,getViewport:k.default,loadImage:L.loadImage,loadAndCacheImage:L.loadAndCacheImage,registerImageLoader:L.registerImageLoader,registerUnknownImageLoader:L.registerUnknownImageLoader,invalidate:D.default,invalidateImageId:A.default,pageToPixel:R.default,pixelToCanvas:H.default,reset:B.default,resize:U.default,setToPixelCoordinateSystem:N.default,setViewport:F.default,updateImage:z.default,pixelDataToFalseColorData:V.default,rendering:W.default,imageCache:q.default,metaData:G.default,webGL:Y.default,colors:X.default,convertImageToFalseColorImage:Z.convertImageToFalseColorImage,convertToFalseColorImage:Z.convertToFalseColorImage,restoreImage:Z.restoreImage,EVENTS:$.default,events:$.events,triggerEvent:K.default};t.default=J},"./internal/calculateTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js");t.default=function(e,t){var n=new a.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var r=e.viewport.rotation;0!==r&&n.rotate(r*Math.PI/180);var o=e.viewport.scale,i=e.viewport.scale,s=e.viewport.displayedArea.brhc.x-(e.viewport.displayedArea.tlhc.x-1),l=e.viewport.displayedArea.brhc.y-(e.viewport.displayedArea.tlhc.y-1);if("NONE"===e.viewport.displayedArea.presentationSizeMode)e.image.rowPixelSpacing<e.image.columnPixelSpacing?o*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(i*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);else if(o=e.viewport.displayedArea.columnPixelSpacing,i=e.viewport.displayedArea.rowPixelSpacing,"SCALE TO FIT"===e.viewport.displayedArea.presentationSizeMode){var u=e.canvas.height/(l*i),c=e.canvas.width/(s*o);o=i=Math.min(c,u),e.viewport.displayedArea.rowPixelSpacing<e.viewport.displayedArea.columnPixelSpacing?o*=e.viewport.displayedArea.columnPixelSpacing/e.viewport.displayedArea.rowPixelSpacing:e.viewport.displayedArea.columnPixelSpacing<e.viewport.displayedArea.rowPixelSpacing&&(i*=e.viewport.displayedArea.rowPixelSpacing/e.viewport.displayedArea.columnPixelSpacing)}return n.scale(o,i),0!==r&&n.rotate(-r*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==r&&n.rotate(r*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-s/2,-l/2),n}},"./internal/computeAutoVoi.js":function(e,t,n){"use strict";function a(e,t){if(!function(e){return e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e)){var n=t.maxPixelValue*t.slope+t.intercept,a=t.minPixelValue*t.slope+t.intercept,r=n-a,o=(n+a)/2;void 0===e.voi?e.voi={windowWidth:r,windowCenter:o}:(e.voi.windowWidth=r,e.voi.windowCenter=o)}}n.r(t),n.d(t,"default",function(){return a})},"./internal/drawCompositeImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./layers.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./setToPixelCoordinateSystem.js");function u(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}function c(e,t){e.forEach(function(e){if(e!==t&&e.viewport&&t.viewport){e.syncProps||u(e);var n,a,r=(a=e,(n=t).syncProps||u(n),a.syncProps||u(a),a.syncProps.originalScale/n.syncProps.originalScale);e.viewport.scale=t.viewport.scale*r,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/r,y:t.viewport.translation.y/r},e.viewport.hflip=t.viewport.hflip,e.viewport.vflip=t.viewport.vflip}})}t.default=function(e,t){var n=e.element,d=Object(a.getLayers)(n),f=Object(a.getActiveLayer)(n),h=Object(a.getVisibleLayers)(n),g=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,g&&d.forEach(function(e){e.viewport&&u(e)}),!0===e.syncViewports&&c(h,f);var m=e.canvas.getContext("2d");m.setTransform(1,0,0,1,0,0),m.fillStyle="black",m.fillRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){t.forEach(function(t,a){if(t.image){e.save(),t.canvas=e.canvas,Object(l.default)(t,e);var u=t.viewport.colormap||t.options.colormap,c=t.viewport.labelmap,d=t.invalid||n;if(u&&""!==u&&!0===c)Object(s.addLabelMapLayer)(t,d);else if(u&&""!==u)Object(i.addPseudoColorLayer)(t,d);else if(!0===t.image.color)Object(o.addColorLayer)(t,d);else{var f=0===a;Object(r.addGrayscaleLayer)(t,d,f)}t.options&&t.options.opacity?e.globalAlpha=t.options.opacity:e.globalAlpha=1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.imageSmoothingEnabled=!t.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled;var h=t.viewport.displayedArea.tlhc.x-1,g=t.viewport.displayedArea.tlhc.y-1,m=t.viewport.displayedArea.brhc.x-h,v=t.viewport.displayedArea.brhc.y-g;e.drawImage(t.canvas,h,g,m,v,0,0,m,v),e.restore(),t.invalid=!1}})}(m,h,t)}},"./internal/drawImage.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js"),r=n("./internal/drawCompositeImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderGrayscaleImage.js"),s=n("./rendering/renderPseudoColorImage.js"),l=n("./rendering/renderLabelMapImage.js"),u=n("./triggerEvent.js"),c=n("./events.js");t.default=function(e,t){var n=e.image,d=e.element,f=e.layers||[];if(e.canvas&&(e.image||f.length)){var h=Object(a.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},f&&f.length)Object(r.default)(e,t);else if(n){var g=n.render;g||(g=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?l.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?s.renderPseudoColorImage:n.color?o.renderColorImage:i.renderGrayscaleImage),g(e,t)}var m=Object(a.default)()-h,v={viewport:e.viewport,element:d,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d"),renderTimeInMs:m};n.stats.lastRenderTime=m,e.invalid=!1,e.needsRedraw=!1,Object(u.default)(d,c.default.IMAGE_RENDERED,v)}}},"./internal/generateColorLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getVOILut.js");t.default=function(e,t,n,r,o){var i=e.maxPixelValue,s=e.minPixelValue,l=Math.min(s,0);if(void 0===e.cachedLut){var u=i-l+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(u)}var c=e.cachedLut.lutArray,d=Object(a.default)(t,n,o);if(!0===r)for(var f=s;f<=i;f++)c[f+-l]=255-d(f);else for(var h=s;h<=i;h++)c[h+-l]=d(h);return c}},"./internal/generateLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getModalityLUT.js"),r=n("./internal/getVOILut.js");t.default=function(e,t,n,o,i,s){var l=e.maxPixelValue,u=e.minPixelValue,c=Math.min(u,0);if(void 0===e.cachedLut){var d=l-c+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(d)}var f=e.cachedLut.lutArray,h=Object(a.default)(e.slope,e.intercept,i),g=Object(r.default)(t,n,s);if(!0===o)for(var m=u;m<=l;m++)f[m+-c]=255-g(h(m));else for(var v=u;v<=l;v++)f[v+-c]=g(h(v));return f}},"./internal/getCanvas.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a="cornerstone-canvas";function r(e){var t="canvas.".concat(a);return e.querySelector(t)||function(e){var t=document.createElement("canvas");return t.style.display="block",t.classList.add(a),e.appendChild(t),t}(e)}},"./internal/getDefaultViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getImageFitScale.js");t.default=function(e,t){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===t?{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}}:{scale:Object(a.default)(e,t,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap,labelmap:Boolean(t.labelmap),displayedArea:{tlhc:{x:1,y:1},brhc:{x:t.columns,y:t.rows},rowPixelSpacing:void 0===t.rowPixelSpacing?1:t.rowPixelSpacing,columnPixelSpacing:void 0===t.columnPixelSpacing?1:t.columnPixelSpacing,presentationSizeMode:"NONE"}}}},"./internal/getImageFitScale.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js"),r=n("./internal/getImageSize.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(a.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(a.validateParameterUndefinedOrNull)(t,"getImageScale: parameter image must not be undefined");var o=Object(r.default)(t,n),i=t.rowPixelSpacing||1,s=t.columnPixelSpacing||1,l=1,u=1;i<s?u=s/i:l=i/s;var c=e.height/o.height/l,d=e.width/o.width/u;return{verticalScale:c,horizontalScale:d,scaleFactor:Math.min(d,c)}}},"./internal/getImageSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(a.validateParameterUndefinedOrNull)(e,"getImageSize: parameter image must not be undefined"),Object(a.validateParameterUndefinedOrNull)(e.width,"getImageSize: parameter image must have width"),Object(a.validateParameterUndefinedOrNull)(e.height,"getImageSize: parameter image must have height"),function(e){return!(null==e||0===e||180===e)}(t)?{height:e.width,width:e.height}:{width:e.width,height:e.height}}},"./internal/getModalityLUT.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t=e.lut[0],n=e.lut[e.lut.length-1],a=e.firstValueMapped+e.lut.length;return function(r){return r<e.firstValueMapped?t:r>=a?n:e.lut[r]}}(n):function(e,t){return function(n){return n*e+t}}(e,t)}},"./internal/getTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e){return Object(a.default)(e)}},"./internal/getVOILut.js":function(e,t,n){"use strict";function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.r(t),t.default=function(e,t,n){return n?function(e){var t=Math.max.apply(Math,a(e.lut)).toString(2).length-8,n=e.lut[0]>>t,r=e.lut[e.lut.length-1]>>t,o=e.firstValueMapped+e.lut.length-1;return function(a){return a<e.firstValueMapped?n:a>=o?r:e.lut[a-e.firstValueMapped]>>t}}(n):function(e,t){return function(n){return 255*((n-t)/e+.5)}}(e,t)}},"./internal/guid.js":function(e,t,n){"use strict";function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(a()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a())}},"./internal/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/drawImage.js"),r=n("./internal/generateLut.js"),o=n("./internal/getDefaultViewport.js"),i=n("./internal/requestAnimationFrame.js"),s=n("./internal/storedPixelDataToCanvasImageData.js"),l=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),u=n("./internal/storedColorPixelDataToCanvasImageData.js"),c=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),d=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),f=n("./internal/getTransform.js"),h=n("./internal/calculateTransform.js"),g=n("./internal/transform.js");t.default={drawImage:a.default,generateLut:r.default,getDefaultViewport:o.default,requestAnimationFrame:i.default,storedPixelDataToCanvasImageData:s.default,storedPixelDataToCanvasImageDataRGBA:l.default,storedPixelDataToCanvasImageDataColorLUT:c.default,storedPixelDataToCanvasImageDataPseudocolorLUT:d.default,storedColorPixelDataToCanvasImageData:u.default,getTransform:f.default,calculateTransform:h.default,Transform:g.Transform}},"./internal/now.js":function(e,t,n){"use strict";n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||function(e){window.setTimeout(e,1e3/60)}(e)}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s]=t[o[l]+-i],l+=2,s+=2;else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s]=t[o[l]],l+=2,s+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=o.length,s=e.minPixelValue,l=3,u=0;if(r=Object(a.default)(),o instanceof Int16Array)if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;else if(o instanceof Uint16Array)for(;u<i;)n[l]=t[o[u++]],l+=4;else if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n){var o=Object(r.default)(),i=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-o;var s,l,u=i.length,c=e.minPixelValue,d=0,f=0;if(o=Object(r.default)(),l=t instanceof a.default.LookupTable?t.Table:t,c<0)for(;f<u;)s=l[i[f++]+-c],n[d++]=s[0],n[d++]=s[1],n[d++]=s[2],n[d++]=s[3];else for(;f<u;)s=l[i[f++]],n[d++]=s[0],n[d++]=s[1],n[d++]=s[2],n[d++]=s[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-o}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n,o){var i=Object(r.default)(),s=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-i;var l,u,c=s.length,d=e.minPixelValue,f=0,h=0;if(i=Object(r.default)(),u=n instanceof a.default.LookupTable?n.Table:n,d<0)for(;h<c;)l=u[t[s[h++]+-d]],o[f++]=l[0],o[f++]=l[1],o[f++]=l[2],o[f++]=l[3];else for(;h<c;)l=u[t[s[h++]]],o[f++]=l[0],o[f++]=l[1],o[f++]=l[2],o[f++]=l[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-i}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i,s=o.length,l=e.minPixelValue,u=0,c=0;if(r=Object(a.default)(),o instanceof Int16Array)if(l<0)for(;c<s;)i=t[o[c++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;c<s;)i=t[o[c++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(o instanceof Uint16Array)for(;c<s;)i=t[o[c++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(l<0)for(;c<s;)i=t[o[c++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;c<s;)i=t[o[c++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=o[l++];else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=o[l++];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/transform.js":function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t),n.d(t,"Transform",function(){return r});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t,n,r;return t=e,(n=[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],a=this.m[0]*e.m[2]+this.m[2]*e.m[3],r=this.m[1]*e.m[2]+this.m[3]*e.m[3],o=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],i=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=t,this.m[1]=n,this.m[2]=a,this.m[3]=r,this.m[4]=o,this.m[5]=i}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,a=-this.m[2]*e,r=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),i=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=t,this.m[1]=n,this.m[2]=a,this.m[3]=r,this.m[4]=o,this.m[5]=i}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),a=this.m[0]*t+this.m[2]*n,r=this.m[1]*t+this.m[3]*n,o=this.m[0]*-n+this.m[2]*t,i=this.m[1]*-n+this.m[3]*t;this.m[0]=a,this.m[1]=r,this.m[2]=o,this.m[3]=i}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e,a=t;return{x:e=n*this.m[0]+a*this.m[2]+this.m[4],y:t=n*this.m[1]+a*this.m[3]+this.m[5]}}}])&&a(t.prototype,n),r&&a(t,r),e}()},"./internal/tryEnableWebgl.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/index.js");t.default=function(e){return a.default.renderer.isWebGLAvailable()?(a.default.renderer.initRenderer(),e.renderer="webgl",!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,!1)}},"./internal/validator.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw new Error(t)}function r(e,t){if(null==e)throw new Error(t)}n.r(t),n.d(t,"validateParameterUndefined",function(){return a}),n.d(t,"validateParameterUndefinedOrNull",function(){return r})},"./invalidate.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0;var n={element:e};Object(r.default)(e,o.default.INVALIDATED,n)}},"./invalidateImageId.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){Object(a.getEnabledElementsByImageId)(e).forEach(function(e){Object(r.default)(e,!0)})}},"./layers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rescaleImage",function(){return c}),n.d(t,"addLayer",function(){return d}),n.d(t,"removeLayer",function(){return f}),n.d(t,"getLayer",function(){return h}),n.d(t,"getLayers",function(){return g}),n.d(t,"getVisibleLayers",function(){return m}),n.d(t,"setActiveLayer",function(){return v}),n.d(t,"setLayerImage",function(){return p}),n.d(t,"getActiveLayer",function(){return b}),n.d(t,"purgeLayers",function(){return y});var a=n("./internal/guid.js"),r=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js"),i=n("./updateImage.js"),s=n("./triggerEvent.js"),l=n("./events.js");function u(e,t,n){var a=t.element,r={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(s.default)(a,e,r)}function c(e,t){if(e.layerId===t.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var n=e.image,a=t.image;if(n.imageId&&a.imageId){var r=t.viewport.displayedArea.columnPixelSpacing*a.width/(e.viewport.displayedArea.columnPixelSpacing*n.width),o=t.viewport.scale/e.viewport.scale*r;t.viewport.scale=e.viewport.scale*o}}function d(e,t,n){var i,s=Object(a.default)(),d=Object(r.getEnabledElement)(e),f=d.layers;t&&(i=Object(o.default)(d.canvas,t),n&&n.viewport&&(i=Object.assign(i,n.viewport))),!1!==d.syncViewports&&(d.syncViewports=!0);var h={image:t,layerId:s,viewport:i,options:n||{},renderingTools:{}};return f.length&&t&&c(f[0],h),f.push(h),u(l.default.LAYER_ADDED,d,s),1===f.length&&t&&v(e,s),s}function f(e,t){var n=Object(r.getEnabledElement)(e),a=n.layers,o=n.layers.findIndex(function(e){return e.layerId===t});-1!==o&&(a.splice(o,1),t===n.activeLayerId&&a.length&&v(e,a[0].layerId),u(l.default.LAYER_REMOVED,n,t))}function h(e,t){return Object(r.getEnabledElement)(e).layers.find(function(e){return e.layerId===t})}function g(e){return Object(r.getEnabledElement)(e).layers}function m(e){return Object(r.getEnabledElement)(e).layers.filter(function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity})}function v(e,t){var n=Object(r.getEnabledElement)(e);if(n.activeLayerId!==t){var a=n.layers.findIndex(function(e){return e.layerId===t});if(-1===a)throw new Error("setActiveLayer: layer not found in layers array");var o=n.layers[a];if(!o.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");n.activeLayerId=t,n.image=o.image,n.viewport=o.viewport,Object(i.default)(e),u(l.default.ACTIVE_LAYER_CHANGED,n,t)}}function p(e,t,n){var a,i=Object(r.getEnabledElement)(e),s=i.layers[0];if(!(a=n?h(e,n):b(e)))throw new Error("setLayerImage: Layer not found");if(a.image=t,t){if(!a.viewport){var l=Object(o.default)(i.canvas,t);a.options&&a.options.viewport&&(a.viewport=Object.assign(l,a.options.viewport)),s.layerId!==n&&c(s,a)}}else a.viewport=void 0}function b(e){var t=Object(r.getEnabledElement)(e);return t.layers.find(function(e){return e.layerId===t.activeLayerId})}function y(e){var t=Object(r.getEnabledElement)(e);t.layers=[],delete t.activeLayerId,delete t.lastSyncViewportsState}},"./metaData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addProvider",function(){return r}),n.d(t,"removeProvider",function(){return o});var a=[];function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(t=0;t<a.length&&!(a[t].priority<=n);t++);a.splice(t,0,{priority:n,provider:e})}function o(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}t.default={addProvider:r,removeProvider:o,get:function(e,t){for(var n=0;n<a.length;n++){var r=a[n].provider(e,t);if(void 0!==r)return r}}}},"./pageToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t,n){var o=Object(a.getEnabledElement)(e);if(void 0===o.image)throw new Error("image has not been loaded yet");var i=e.getBoundingClientRect(),s={x:t-i.left-window.pageXOffset,y:n-i.top-window.pageYOffset},l=Object(r.default)(o);return l.invert(),l.transformPoint(s.x,s.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./colors/index.js");function r(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n,r,o=e.minPixelValue,i=0,s=0,l=e.width*e.height,u=e.origPixelData||e.getPixelData(),c=new Uint8Array(4*l);if(e.color=!0,e.falseColor=!0,e.origPixelData=u,t instanceof a.default.LookupTable)for(t.build();s<l;)n=u[s++],r=t.mapValue(n),c[i++]=r[0],c[i++]=r[1],c[i++]=r[2],c[i++]=r[3];else if(o<0)for(;s<l;)n=u[s++],c[i++]=t[n+-o][0],c[i++]=t[n+-o][1],c[i++]=t[n+-o][2],c[i++]=t[n+-o][3];else for(;s<l;)n=u[s++],c[i++]=t[n][0],c[i++]=t[n][1],c[i++]=t[n][2],c[i++]=t[n][3];e.rgba=!0,e.cachedLut=void 0,e.render=void 0,e.slope=1,e.intercept=0,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return c}}},"./pixelToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n).transformPoint(t.x,t.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.lastRenderedImageId,a=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!a||a.windowCenter!==e.viewport.voi.windowCenter||a.windowWidth!==e.viewport.voi.windowWidth||a.invert!==e.viewport.invert||a.rotation!==e.viewport.rotation||a.hflip!==e.viewport.hflip||a.vflip!==e.viewport.vflip||a.modalityLUT!==e.viewport.modalityLUT||a.voiLUT!==e.viewport.voiLUT||a.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/computeAutoVoi.js"),r=n("./rendering/lutMatches.js"),o=n("./internal/generateLut.js");t.default=function(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&Object(r.default)(e.cachedLut.modalityLUT,t.modalityLUT)&&Object(r.default)(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n?e.cachedLut.lutArray:(Object(a.default)(t,e),Object(o.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT,e.cachedLut.lutArray)}},"./rendering/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./rendering/renderColorImage.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderWebImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./rendering/renderToCanvas.js");t.default={colorImage:a.renderColorImage,grayscaleImage:r.renderGrayscaleImage,webImage:o.renderWebImage,pseudoColorImage:i.renderPseudoColorImage,labelMapImage:s.renderLabelMapImage,toCanvas:l.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;var a=n.getContext("2d");a.fillStyle="white",a.fillRect(0,0,n.width,n.height);var r=a.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=a,e.renderingTools.renderCanvasData=r}},"./rendering/lutMatches.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}},"./rendering/renderColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderColorImage",function(){return h}),n.d(t,"addColorLayer",function(){return g});var a=n("./internal/now.js"),r=n("./internal/generateColorLut.js"),o=n("./internal/storedColorPixelDataToCanvasImageData.js"),i=n("./internal/storedRGBAPixelDataToCanvasImageData.js"),s=n("./setToPixelCoordinateSystem.js"),l=n("./webgl/index.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),d=n("./rendering/saveLastRendered.js");function f(e,t,n){var s=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&s||(e.renderingTools.renderCanvas=document.createElement("canvas"));var l=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===Object(u.default)(e,t)&&!0!==n)return l;l.width===t.width&&l.height===t.height||Object(c.default)(e,t);var d=Object(a.default)(),f=function(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert?e.cachedLut.lutArray:(Object(r.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.lutArray)}(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(a.default)()-d;var h=e.renderingTools.renderCanvasData,g=e.renderingTools.renderCanvasContext;return t.rgba?Object(i.default)(t,f,h.data):Object(o.default)(t,f,h.data),d=Object(a.default)(),g.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(a.default)()-d,l}function h(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderColorImage: image must be loaded before it can be drawn");var a,r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(s.default)(e,r),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?l.default.renderer.render(e):f(e,n,t);var o=e.viewport.displayedArea.tlhc.x-1,i=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-o,c=e.viewport.displayedArea.brhc.y-i;r.drawImage(a,o,i,u,c,0,0,u,c),e.renderingTools=Object(d.default)(e)}function g(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addColorLayer: image must be loaded before it can be drawn");n.rgba=!0,e.canvas=f(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(d.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderGrayscaleImage",function(){return h}),n.d(t,"addGrayscaleLayer",function(){return g});var a=n("./internal/storedPixelDataToCanvasImageData.js"),r=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),o=n("./setToPixelCoordinateSystem.js"),i=n("./internal/now.js"),s=n("./webgl/index.js"),l=n("./rendering/getLut.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),c=n("./rendering/initializeRenderCanvas.js"),d=n("./rendering/saveLastRendered.js");function f(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!s||(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(c.default)(e,t));var d=e.renderingTools.renderCanvas;if(!1===Object(u.default)(e,t)&&!0!==n)return d;d.width===t.width&&d.height===t.height||Object(c.default)(e,t);var f=Object(i.default)(),h=Object(l.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(i.default)()-f;var g=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return o?Object(a.default)(t,h,g.data):Object(r.default)(t,h,g.data),f=Object(i.default)(),m.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(i.default)()-f,d}function h(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var a,r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(o.default)(e,r),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?s.default.renderer.render(e):f(e,n,t);var i=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-i,c=e.viewport.displayedArea.brhc.y-l;r.drawImage(a,i,l,u,c,0,0,u,c),e.renderingTools=Object(d.default)(e)}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var a=e.image;if(void 0===a)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=f(e,a,t,n);var r=e.canvas.getContext("2d");r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,e.renderingTools=Object(d.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderLabelMapImage",function(){return d}),n.d(t,"addLabelMapLayer",function(){return f});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./rendering/initializeRenderCanvas.js"),i=n("./rendering/saveLastRendered.js"),s=n("./rendering/doesImageNeedToBeRendered.js"),l=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),u=n("./colors/index.js");function c(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,i=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),i&&"string"==typeof i&&(i=u.default.getColormap(i)),!i)throw new Error("renderLabelMapImage: colormap not found.");var c=i.getId();if(!1===Object(s.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===c)return a;a.width===t.width&&a.height===t.height||Object(o.default)(e,t);var d=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===c||(e.renderingTools.colorLut=i.createLookupTable(),e.renderingTools.colormapId=c),t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-d;var f=e.renderingTools.colorLut,h=e.renderingTools.renderCanvasData,g=e.renderingTools.renderCanvasContext;return Object(l.default)(t,f,h.data),d=Object(r.default)(),g.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-d,a}function d(e,t){if(void 0===e)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var o=c(e,n,t),s=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-s,d=e.viewport.displayedArea.brhc.y-l;r.drawImage(o,s,l,u,d,0,0,u,d),e.renderingTools=Object(i.default)(e)}function f(e,t){if(void 0===e)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=c(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(i.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderPseudoColorImage",function(){return f}),n.d(t,"addPseudoColorLayer",function(){return h});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./rendering/initializeRenderCanvas.js"),i=n("./rendering/getLut.js"),s=n("./rendering/saveLastRendered.js"),l=n("./rendering/doesImageNeedToBeRendered.js"),u=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),c=n("./colors/index.js");function d(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,s=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),s&&"string"==typeof s&&(s=c.default.getColormap(s)),!s)throw new Error("renderPseudoColorImage: colormap not found.");var d=s.getId();if(!1===Object(l.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===d)return a;a.width===t.width&&a.height===t.height||Object(o.default)(e,t);var f=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===d||(s.setNumberOfColors(256),e.renderingTools.colorLut=s.createLookupTable(),e.renderingTools.colormapId=d);var h=Object(i.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-f;var g=e.renderingTools.colorLut,m=e.renderingTools.renderCanvasData,v=e.renderingTools.renderCanvasContext;return Object(u.default)(t,h,g,m.data),f=Object(r.default)(),v.putImageData(m,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-f,a}function f(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var o=d(e,n,t),i=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-i,c=e.viewport.displayedArea.brhc.y-l;r.drawImage(o,i,l,u,c,0,0,u,c),e.renderingTools=Object(s.default)(e)}function h(e,t){if(void 0===e)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=d(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(s.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./triggerEvent.js"),r=n("./events.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/getDefaultViewport.js"),s=n("./internal/tryEnableWebgl.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===e)throw new Error("renderToCanvas: parameter canvas cannot be undefined");l&&l.renderer&&"webgl"===l.renderer.toLowerCase()&&Object(s.default)(l);var u=Object(i.default)(e,t);n&&Object.assign(u,n);var c=function(e,t,n,a){return{element:e,canvas:e,image:t,invalid:!0,needsRedraw:!0,options:n,layers:[],data:{},renderingTools:{},viewport:a}}(e,t,l,u),d={enabledElement:c,timestamp:Date.now()};Object(a.default)(c.element,r.default.PRE_RENDER,d),Object(o.default)(c,c.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderWebImage",function(){return o});var a=n("./setToPixelCoordinateSystem.js"),r=n("./rendering/renderColorImage.js");function o(e,t){if(void 0===e)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var o=e.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0),o.fillStyle="black",o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=e.viewport.displayedArea.tlhc.x-1,s=e.viewport.displayedArea.tlhc.y-1,l=e.viewport.displayedArea.brhc.x-i,u=e.viewport.displayedArea.brhc.y-s;o.drawImage(n.getImage(),i,s,l,u,0,0,l,u)}else Object(r.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.image.imageId,n=e.viewport,a=e.image.color;return e.renderingTools.lastRenderedImageId=t,e.renderingTools.lastRenderedIsColor=a,e.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},e.renderingTools}},"./reset.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js"),o=n("./updateImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.viewport=Object(r.default)(t.canvas,t.image),Object(o.default)(e)}},"./resize.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./fitToWindow.js"),o=n("./updateImage.js"),i=n("./triggerEvent.js"),s=n("./internal/getImageSize.js"),l=n("./events.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),u=n.canvas.width,c=n.canvas.height;!function(e,t){t.width!==e.clientWidth&&(t.width=e.clientWidth,t.style.width="".concat(e.clientWidth,"px")),t.height!==e.clientHeight&&(t.height=e.clientHeight,t.style.height="".concat(e.clientHeight,"px"))}(e,n.canvas);var d={element:e};Object(i.default)(e,l.default.ELEMENT_RESIZED,d),void 0!==n.image&&(t||function(e,t,n){var a=e.viewport.scale,r=Object(s.default)(e.image,e.viewport.rotation),o=Math.round(r.width*a),i=Math.round(r.height*a),l=e.viewport.translation.x,u=e.viewport.translation.y;return o===t&&i<=n||o<=t&&i===n&&0===l&&0===u}(n,u,c)?Object(r.default)(e):(!function(e,t,n){var a=e.viewport.scale,r=e.canvas.width/t,o=e.canvas.height/n,i=Math.sqrt(r*o);e.viewport.scale=i*a}(n,u,c),Object(o.default)(e)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var r=Object(a.default)(e,n);t.setTransform(r.m[0],r.m[1],r.m[2],r.m[3],r.m[4],r.m[5])}},"./setViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),r=n("./enabledElements.js"),o=n("./updateImage.js");t.default=function(e,t){var n=Object(r.getEnabledElement)(e);if(void 0===n.viewport&&(n.viewport=Object(a.default)(n.canvas)),t)for(var i in t)null!==t[i]&&(n.viewport[i]=t[i]);n.viewport.voi.windowWidth&&(n.viewport.voi.windowWidth=Math.max(t.voi.windowWidth,1e-6)),n.viewport.scale&&(n.viewport.scale=Math.max(t.scale,1e-4)),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),n.image&&Object(o.default)(e)}},"./triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./updateImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.getEnabledElement)(e);if(void 0===n.image&&!n.layers.length)throw new Error("updateImage: image has not been loaded yet");Object(r.default)(n,t)}},"./webgl/createProgramFromString.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost()){var r=e.getShaderInfoLog(a);console.error("Could not compile shader:\n".concat(r))}return a}n.r(t),t.default=function(e,t,n){return function(e,t,n){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS)&&!e.isContextLost()){var r=e.getProgramInfoLog(a);console.error("WebGL program filed to link:\n".concat(r))}return a}(e,a(e,t,e.VERTEX_SHADER),a(e,n,e.FRAGMENT_SHADER))}},"./webgl/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/renderer.js"),r=n("./webgl/createProgramFromString.js"),o=n("./webgl/textureCache.js"),i={createProgramFromString:r.default,renderer:{render:a.render,initRenderer:a.initRenderer,getRenderCanvas:a.getRenderCanvas,isWebGLAvailable:a.isWebGLAvailable},textureCache:o.default};Object.defineProperty(i,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return a.isWebGLInitialized}}),t.default=i},"./webgl/renderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isWebGLInitialized",function(){return d}),n.d(t,"getRenderCanvas",function(){return f}),n.d(t,"initRenderer",function(){return h}),n.d(t,"render",function(){return y}),n.d(t,"isWebGLAvailable",function(){return x});var a,r,o,i=n("./webgl/shaders/index.js"),s=n("./webgl/vertexShader.js"),l=n("./webgl/textureCache.js"),u=n("./webgl/createProgramFromString.js"),c=document.createElement("canvas"),d=!1;function f(){return c}function h(){!0!==d&&function(e){a=null;try{var t={preserveDrawingBuffer:!0};a=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),e.removeEventListener("webglcontextlost",g,!1),e.addEventListener("webglcontextlost",g,!1),e.removeEventListener("webglcontextrestored",m,!1),e.addEventListener("webglcontextrestored",m,!1)}catch(e){throw new Error("Error creating WebGL context")}a||(console.error("Unable to initialize WebGL. Your browser may not support it."),a=null);return a}(c)&&(o=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,o),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),r=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,r),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),function(){for(var e in i.shaders){var t=i.shaders[e];t.attributes={},t.uniforms={},t.vert=s.vertexShader,t.program=Object(u.default)(a,t.vert,t.frag),t.attributes.texCoordLocation=a.getAttribLocation(t.program,"a_texCoord"),a.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=a.getAttribLocation(t.program,"a_position"),a.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=a.getUniformLocation(t.program,"u_resolution")}}(),d=!0)}function g(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function m(e){e.preventDefault(),d=!1,l.default.purgeCache(),h()}function v(e){if(e.color)return"rgb";var t=e.getPixelData();return t instanceof Int16Array?"int16":t instanceof Uint16Array?"uint16":t instanceof Int8Array?"int8":"uint8"}function p(e){var t=l.default.getImageTexture(e.imageId);return t||(t=function(e){var t={uint8:a.LUMINANCE,int8:a.LUMINANCE_ALPHA,uint16:a.LUMINANCE_ALPHA,int16:a.RGB,rgb:a.RGB},n=v(e),r=t[n],o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_ALIGNMENT,1);var s=i.dataUtilities[n].storedPixelDataToImageData(e,e.width,e.height);return a.texImage2D(a.TEXTURE_2D,0,r,e.width,e.height,0,r,a.UNSIGNED_BYTE,s),{texture:o,sizeInBytes:e.width*e.height*{int8:1,uint16:2,int16:3,rgb:3}[n]}}(e),l.default.putImageTexture(e,t)),t.texture}function b(e,t,n,i,s){for(var l in a.clearColor(1,0,0,1),a.viewport(0,0,i,s),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(e.program),a.bindBuffer(a.ARRAY_BUFFER,r),a.vertexAttribPointer(e.attributes.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,o),a.vertexAttribPointer(e.attributes.positionLocation,2,a.FLOAT,!1,0,0),t){var u=a.getUniformLocation(e.program,l);if(u){var c=t[l],d=c.type,f=c.value;"i"===d?a.uniform1i(u,f):"f"===d?a.uniform1f(u,f):"2f"===d&&a.uniform2f(u,f[0],f[1])}}!function(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}(a,i,s),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.drawArrays(a.TRIANGLE_STRIP,0,4)}function y(e){var t=e.image;c.width=t.width,c.height=t.height;var n=e.viewport,a=function(e){var t=v(e);return i.shaders.hasOwnProperty(t)?i.shaders[t]:i.shaders.rgb}(t),r=p(t);return b(a,{u_resolution:{type:"2f",value:[t.width,t.height]},wc:{type:"f",value:n.voi.windowCenter},ww:{type:"f",value:n.voi.windowWidth},slope:{type:"f",value:t.slope},intercept:{type:"f",value:t.intercept},minPixelValue:{type:"f",value:t.minPixelValue},invert:{type:"i",value:n.invert?1:0}},r,t.width,t.height),c}function x(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(e){return!1}}},"./webgl/shaders/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"shaders",function(){return l}),n.d(t,"dataUtilities",function(){return u});var a=n("./webgl/shaders/int16.js"),r=n("./webgl/shaders/int8.js"),o=n("./webgl/shaders/rgb.js"),i=n("./webgl/shaders/uint16.js"),s=n("./webgl/shaders/uint8.js"),l={int16:a.int16Shader,int8:r.int8Shader,rgb:o.rgbShader,uint16:i.uint16Shader,uint8:s.uint8Shader},u={int16:a.int16DataUtilities,int8:r.int8DataUtilities,rgb:o.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:s.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int16DataUtilities",function(){return r}),n.d(t,"int16Shader",function(){return a});var a={};var r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*3),a=0,r=0;r<t.length;r++){var o=Math.abs(t[r]);n[a++]=255&o,n[a++]=o>>8,n[a++]=t[r]<0?0:1}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int8DataUtilities",function(){return r}),n.d(t,"int8Shader",function(){return a});var a={};var r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++)n[a++]=t[r],n[a++]=t[r]<0?0:1;return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rgbDataUtilities",function(){return r}),n.d(t,"rgbShader",function(){return a});var a={};var r={storedPixelDataToImageData:function(e){var t=e.minPixelValue,n=0,a=0,r=e.width*e.height*4,o=e.width*e.height*3,i=e.getPixelData(),s=new Uint8Array(o);if(t<0)for(;a<r;)s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,a+=1;else for(;a<r;)s[n++]=i[a++],s[n++]=i[a++],s[n++]=i[a++],a+=1;return s}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint16DataUtilities",function(){return r}),n.d(t,"uint16Shader",function(){return a});var a={};var r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++){var o=t[r];n[a++]=255&o,n[a++]=o>>8}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint8DataUtilities",function(){return r}),n.d(t,"uint8Shader",function(){return a});var a={};var r={storedPixelDataToImageData:function(e){return e.getPixelData()}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./triggerEvent.js"),o={},i=[],s=268435456,l=0;function u(){if(!(l<=s)){for(i.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});l>s;){var e=i[i.length-1];l-=e.sizeInBytes,delete o[e.imageId],i.pop(),Object(r.default)(a.events,a.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:s,cacheSizeInBytes:l,numberOfImagesCached:i.length};Object(r.default)(a.events,a.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function(){for(;i.length>0;){var e=i.pop();delete o[e.imageId]}l=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=o[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(e,t){var n=e.imageId;if(void 0===e)throw new Error("putImageTexture: image must not be undefined");if(void 0===n)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(o,n))throw new Error("putImageTexture: imageId already in cache");var a={imageId:n,imageTexture:t,timeStamp:new Date,sizeInBytes:t.sizeInBytes};if(o[n]=a,i.push(a),void 0===t.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");l+=a.sizeInBytes,u()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=o[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return i.splice(i.indexOf(t),1),l-=t.sizeInBytes,delete o[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");s=e,u()}}},"./webgl/vertexShader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"vertexShader",function(){return a});var a="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})},e.exports=a()},function(e,t,n){var a=n(12);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(18).default)("885f48d4",a,!1,{})},function(e,t,n){(function(e,a){var r;(function(){var o,i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",u="__lodash_hash_undefined__",c=500,d="__lodash_placeholder__",f=1,h=2,g=4,m=1,v=2,p=1,b=2,y=4,x=8,w=16,T=32,j=64,C=128,_=256,E=512,M=30,O="...",I=800,S=16,P=1,k=2,L=1/0,D=9007199254740991,A=1.7976931348623157e308,R=NaN,H=4294967295,B=H-1,U=H>>>1,N=[["ary",C],["bind",p],["bindKey",b],["curry",x],["curryRight",w],["flip",E],["partial",T],["partialRight",j],["rearg",_]],F="[object Arguments]",z="[object Array]",V="[object AsyncFunction]",W="[object Boolean]",q="[object Date]",G="[object DOMException]",Y="[object Error]",X="[object Function]",Z="[object GeneratorFunction]",$="[object Map]",K="[object Number]",J="[object Null]",Q="[object Object]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",ae="[object String]",re="[object Symbol]",oe="[object Undefined]",ie="[object WeakMap]",se="[object WeakSet]",le="[object ArrayBuffer]",ue="[object DataView]",ce="[object Float32Array]",de="[object Float64Array]",fe="[object Int8Array]",he="[object Int16Array]",ge="[object Int32Array]",me="[object Uint8Array]",ve="[object Uint8ClampedArray]",pe="[object Uint16Array]",be="[object Uint32Array]",ye=/\b__p \+= '';/g,xe=/\b(__p \+=) '' \+/g,we=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Te=/&(?:amp|lt|gt|quot|#39);/g,je=/[&<>"']/g,Ce=RegExp(Te.source),_e=RegExp(je.source),Ee=/<%-([\s\S]+?)%>/g,Me=/<%([\s\S]+?)%>/g,Oe=/<%=([\s\S]+?)%>/g,Ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Se=/^\w*$/,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,Le=RegExp(ke.source),De=/^\s+|\s+$/g,Ae=/^\s+/,Re=/\s+$/,He=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Be=/\{\n\/\* \[wrapped with (.+)\] \*/,Ue=/,? & /,Ne=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fe=/\\(\\)?/g,ze=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ve=/\w*$/,We=/^[-+]0x[0-9a-f]+$/i,qe=/^0b[01]+$/i,Ge=/^\[object .+?Constructor\]$/,Ye=/^0o[0-7]+$/i,Xe=/^(?:0|[1-9]\d*)$/,Ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$e=/($^)/,Ke=/['\n\r\u2028\u2029\\]/g,Je="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",et="[\\ud800-\\udfff]",tt="["+Qe+"]",nt="["+Je+"]",at="\\d+",rt="[\\u2700-\\u27bf]",ot="[a-z\\xdf-\\xf6\\xf8-\\xff]",it="[^\\ud800-\\udfff"+Qe+at+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",st="\\ud83c[\\udffb-\\udfff]",lt="[^\\ud800-\\udfff]",ut="(?:\\ud83c[\\udde6-\\uddff]){2}",ct="[\\ud800-\\udbff][\\udc00-\\udfff]",dt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ft="(?:"+ot+"|"+it+")",ht="(?:"+dt+"|"+it+")",gt="(?:"+nt+"|"+st+")"+"?",mt="[\\ufe0e\\ufe0f]?"+gt+("(?:\\u200d(?:"+[lt,ut,ct].join("|")+")[\\ufe0e\\ufe0f]?"+gt+")*"),vt="(?:"+[rt,ut,ct].join("|")+")"+mt,pt="(?:"+[lt+nt+"?",nt,ut,ct,et].join("|")+")",bt=RegExp("[']","g"),yt=RegExp(nt,"g"),xt=RegExp(st+"(?="+st+")|"+pt+mt,"g"),wt=RegExp([dt+"?"+ot+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[tt,dt,"$"].join("|")+")",ht+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[tt,dt+ft,"$"].join("|")+")",dt+"?"+ft+"+(?:['](?:d|ll|m|re|s|t|ve))?",dt+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",at,vt].join("|"),"g"),Tt=RegExp("[\\u200d\\ud800-\\udfff"+Je+"\\ufe0e\\ufe0f]"),jt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ct=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_t=-1,Et={};Et[ce]=Et[de]=Et[fe]=Et[he]=Et[ge]=Et[me]=Et[ve]=Et[pe]=Et[be]=!0,Et[F]=Et[z]=Et[le]=Et[W]=Et[ue]=Et[q]=Et[Y]=Et[X]=Et[$]=Et[K]=Et[Q]=Et[te]=Et[ne]=Et[ae]=Et[ie]=!1;var Mt={};Mt[F]=Mt[z]=Mt[le]=Mt[ue]=Mt[W]=Mt[q]=Mt[ce]=Mt[de]=Mt[fe]=Mt[he]=Mt[ge]=Mt[$]=Mt[K]=Mt[Q]=Mt[te]=Mt[ne]=Mt[ae]=Mt[re]=Mt[me]=Mt[ve]=Mt[pe]=Mt[be]=!0,Mt[Y]=Mt[X]=Mt[ie]=!1;var Ot={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},It=parseFloat,St=parseInt,Pt="object"==typeof e&&e&&e.Object===Object&&e,kt="object"==typeof self&&self&&self.Object===Object&&self,Lt=Pt||kt||Function("return this")(),Dt=t&&!t.nodeType&&t,At=Dt&&"object"==typeof a&&a&&!a.nodeType&&a,Rt=At&&At.exports===Dt,Ht=Rt&&Pt.process,Bt=function(){try{var e=At&&At.require&&At.require("util").types;return e||Ht&&Ht.binding&&Ht.binding("util")}catch(e){}}(),Ut=Bt&&Bt.isArrayBuffer,Nt=Bt&&Bt.isDate,Ft=Bt&&Bt.isMap,zt=Bt&&Bt.isRegExp,Vt=Bt&&Bt.isSet,Wt=Bt&&Bt.isTypedArray;function qt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Gt(e,t,n,a){for(var r=-1,o=null==e?0:e.length;++r<o;){var i=e[r];t(a,i,n(i),e)}return a}function Yt(e,t){for(var n=-1,a=null==e?0:e.length;++n<a&&!1!==t(e[n],n,e););return e}function Xt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Zt(e,t){for(var n=-1,a=null==e?0:e.length;++n<a;)if(!t(e[n],n,e))return!1;return!0}function $t(e,t){for(var n=-1,a=null==e?0:e.length,r=0,o=[];++n<a;){var i=e[n];t(i,n,e)&&(o[r++]=i)}return o}function Kt(e,t){return!!(null==e?0:e.length)&&ln(e,t,0)>-1}function Jt(e,t,n){for(var a=-1,r=null==e?0:e.length;++a<r;)if(n(t,e[a]))return!0;return!1}function Qt(e,t){for(var n=-1,a=null==e?0:e.length,r=Array(a);++n<a;)r[n]=t(e[n],n,e);return r}function en(e,t){for(var n=-1,a=t.length,r=e.length;++n<a;)e[r+n]=t[n];return e}function tn(e,t,n,a){var r=-1,o=null==e?0:e.length;for(a&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function nn(e,t,n,a){var r=null==e?0:e.length;for(a&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function an(e,t){for(var n=-1,a=null==e?0:e.length;++n<a;)if(t(e[n],n,e))return!0;return!1}var rn=fn("length");function on(e,t,n){var a;return n(e,function(e,n,r){if(t(e,n,r))return a=n,!1}),a}function sn(e,t,n,a){for(var r=e.length,o=n+(a?1:-1);a?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function ln(e,t,n){return t==t?function(e,t,n){var a=n-1,r=e.length;for(;++a<r;)if(e[a]===t)return a;return-1}(e,t,n):sn(e,cn,n)}function un(e,t,n,a){for(var r=n-1,o=e.length;++r<o;)if(a(e[r],t))return r;return-1}function cn(e){return e!=e}function dn(e,t){var n=null==e?0:e.length;return n?mn(e,t)/n:R}function fn(e){return function(t){return null==t?o:t[e]}}function hn(e){return function(t){return null==e?o:e[t]}}function gn(e,t,n,a,r){return r(e,function(e,r,o){n=a?(a=!1,e):t(n,e,r,o)}),n}function mn(e,t){for(var n,a=-1,r=e.length;++a<r;){var i=t(e[a]);i!==o&&(n=n===o?i:n+i)}return n}function vn(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}function pn(e){return function(t){return e(t)}}function bn(e,t){return Qt(t,function(t){return e[t]})}function yn(e,t){return e.has(t)}function xn(e,t){for(var n=-1,a=e.length;++n<a&&ln(t,e[n],0)>-1;);return n}function wn(e,t){for(var n=e.length;n--&&ln(t,e[n],0)>-1;);return n}var Tn=hn({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),jn=hn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Cn(e){return"\\"+Ot[e]}function _n(e){return Tt.test(e)}function En(e){var t=-1,n=Array(e.size);return e.forEach(function(e,a){n[++t]=[a,e]}),n}function Mn(e,t){return function(n){return e(t(n))}}function On(e,t){for(var n=-1,a=e.length,r=0,o=[];++n<a;){var i=e[n];i!==t&&i!==d||(e[n]=d,o[r++]=n)}return o}function In(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Sn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Pn(e){return _n(e)?function(e){var t=xt.lastIndex=0;for(;xt.test(e);)++t;return t}(e):rn(e)}function kn(e){return _n(e)?function(e){return e.match(xt)||[]}(e):function(e){return e.split("")}(e)}var Ln=hn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Dn=function e(t){var n,a=(t=null==t?Lt:Dn.defaults(Lt.Object(),t,Dn.pick(Lt,Ct))).Array,r=t.Date,Je=t.Error,Qe=t.Function,et=t.Math,tt=t.Object,nt=t.RegExp,at=t.String,rt=t.TypeError,ot=a.prototype,it=Qe.prototype,st=tt.prototype,lt=t["__core-js_shared__"],ut=it.toString,ct=st.hasOwnProperty,dt=0,ft=(n=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ht=st.toString,gt=ut.call(tt),mt=Lt._,vt=nt("^"+ut.call(ct).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pt=Rt?t.Buffer:o,xt=t.Symbol,Tt=t.Uint8Array,Ot=pt?pt.allocUnsafe:o,Pt=Mn(tt.getPrototypeOf,tt),kt=tt.create,Dt=st.propertyIsEnumerable,At=ot.splice,Ht=xt?xt.isConcatSpreadable:o,Bt=xt?xt.iterator:o,rn=xt?xt.toStringTag:o,hn=function(){try{var e=Uo(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),An=t.clearTimeout!==Lt.clearTimeout&&t.clearTimeout,Rn=r&&r.now!==Lt.Date.now&&r.now,Hn=t.setTimeout!==Lt.setTimeout&&t.setTimeout,Bn=et.ceil,Un=et.floor,Nn=tt.getOwnPropertySymbols,Fn=pt?pt.isBuffer:o,zn=t.isFinite,Vn=ot.join,Wn=Mn(tt.keys,tt),qn=et.max,Gn=et.min,Yn=r.now,Xn=t.parseInt,Zn=et.random,$n=ot.reverse,Kn=Uo(t,"DataView"),Jn=Uo(t,"Map"),Qn=Uo(t,"Promise"),ea=Uo(t,"Set"),ta=Uo(t,"WeakMap"),na=Uo(tt,"create"),aa=ta&&new ta,ra={},oa=di(Kn),ia=di(Jn),sa=di(Qn),la=di(ea),ua=di(ta),ca=xt?xt.prototype:o,da=ca?ca.valueOf:o,fa=ca?ca.toString:o;function ha(e){if(Os(e)&&!ps(e)&&!(e instanceof pa)){if(e instanceof va)return e;if(ct.call(e,"__wrapped__"))return fi(e)}return new va(e)}var ga=function(){function e(){}return function(t){if(!Ms(t))return{};if(kt)return kt(t);e.prototype=t;var n=new e;return e.prototype=o,n}}();function ma(){}function va(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}function pa(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=H,this.__views__=[]}function ba(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function ya(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function xa(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function wa(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new xa;++t<n;)this.add(e[t])}function Ta(e){var t=this.__data__=new ya(e);this.size=t.size}function ja(e,t){var n=ps(e),a=!n&&vs(e),r=!n&&!a&&ws(e),o=!n&&!a&&!r&&Rs(e),i=n||a||r||o,s=i?vn(e.length,at):[],l=s.length;for(var u in e)!t&&!ct.call(e,u)||i&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Go(u,l))||s.push(u);return s}function Ca(e){var t=e.length;return t?e[wr(0,t-1)]:o}function _a(e,t){return li(no(e),Da(t,0,e.length))}function Ea(e){return li(no(e))}function Ma(e,t,n){(n===o||hs(e[t],n))&&(n!==o||t in e)||ka(e,t,n)}function Oa(e,t,n){var a=e[t];ct.call(e,t)&&hs(a,n)&&(n!==o||t in e)||ka(e,t,n)}function Ia(e,t){for(var n=e.length;n--;)if(hs(e[n][0],t))return n;return-1}function Sa(e,t,n,a){return Ua(e,function(e,r,o){t(a,e,n(e),o)}),a}function Pa(e,t){return e&&ao(t,rl(t),e)}function ka(e,t,n){"__proto__"==t&&hn?hn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function La(e,t){for(var n=-1,r=t.length,i=a(r),s=null==e;++n<r;)i[n]=s?o:Qs(e,t[n]);return i}function Da(e,t,n){return e==e&&(n!==o&&(e=e<=n?e:n),t!==o&&(e=e>=t?e:t)),e}function Aa(e,t,n,a,r,i){var s,l=t&f,u=t&h,c=t&g;if(n&&(s=r?n(e,a,r,i):n(e)),s!==o)return s;if(!Ms(e))return e;var d=ps(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ct.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return no(e,s)}else{var m=zo(e),v=m==X||m==Z;if(ws(e))return $r(e,l);if(m==Q||m==F||v&&!r){if(s=u||v?{}:Wo(e),!l)return u?function(e,t){return ao(e,Fo(e),t)}(e,function(e,t){return e&&ao(t,ol(t),e)}(s,e)):function(e,t){return ao(e,No(e),t)}(e,Pa(s,e))}else{if(!Mt[m])return r?e:{};s=function(e,t,n){var a,r,o,i=e.constructor;switch(t){case le:return Kr(e);case W:case q:return new i(+e);case ue:return function(e,t){var n=t?Kr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case ce:case de:case fe:case he:case ge:case me:case ve:case pe:case be:return Jr(e,n);case $:return new i;case K:case ae:return new i(e);case te:return(o=new(r=e).constructor(r.source,Ve.exec(r))).lastIndex=r.lastIndex,o;case ne:return new i;case re:return a=e,da?tt(da.call(a)):{}}}(e,m,l)}}i||(i=new Ta);var p=i.get(e);if(p)return p;if(i.set(e,s),Ls(e))return e.forEach(function(a){s.add(Aa(a,t,n,a,e,i))}),s;if(Is(e))return e.forEach(function(a,r){s.set(r,Aa(a,t,n,r,e,i))}),s;var b=d?o:(c?u?ko:Po:u?ol:rl)(e);return Yt(b||e,function(a,r){b&&(a=e[r=a]),Oa(s,r,Aa(a,t,n,r,e,i))}),s}function Ra(e,t,n){var a=n.length;if(null==e)return!a;for(e=tt(e);a--;){var r=n[a],i=t[r],s=e[r];if(s===o&&!(r in e)||!i(s))return!1}return!0}function Ha(e,t,n){if("function"!=typeof e)throw new rt(l);return ri(function(){e.apply(o,n)},t)}function Ba(e,t,n,a){var r=-1,o=Kt,s=!0,l=e.length,u=[],c=t.length;if(!l)return u;n&&(t=Qt(t,pn(n))),a?(o=Jt,s=!1):t.length>=i&&(o=yn,s=!1,t=new wa(t));e:for(;++r<l;){var d=e[r],f=null==n?d:n(d);if(d=a||0!==d?d:0,s&&f==f){for(var h=c;h--;)if(t[h]===f)continue e;u.push(d)}else o(t,f,a)||u.push(d)}return u}ha.templateSettings={escape:Ee,evaluate:Me,interpolate:Oe,variable:"",imports:{_:ha}},ha.prototype=ma.prototype,ha.prototype.constructor=ha,va.prototype=ga(ma.prototype),va.prototype.constructor=va,pa.prototype=ga(ma.prototype),pa.prototype.constructor=pa,ba.prototype.clear=function(){this.__data__=na?na(null):{},this.size=0},ba.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ba.prototype.get=function(e){var t=this.__data__;if(na){var n=t[e];return n===u?o:n}return ct.call(t,e)?t[e]:o},ba.prototype.has=function(e){var t=this.__data__;return na?t[e]!==o:ct.call(t,e)},ba.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=na&&t===o?u:t,this},ya.prototype.clear=function(){this.__data__=[],this.size=0},ya.prototype.delete=function(e){var t=this.__data__,n=Ia(t,e);return!(n<0||(n==t.length-1?t.pop():At.call(t,n,1),--this.size,0))},ya.prototype.get=function(e){var t=this.__data__,n=Ia(t,e);return n<0?o:t[n][1]},ya.prototype.has=function(e){return Ia(this.__data__,e)>-1},ya.prototype.set=function(e,t){var n=this.__data__,a=Ia(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this},xa.prototype.clear=function(){this.size=0,this.__data__={hash:new ba,map:new(Jn||ya),string:new ba}},xa.prototype.delete=function(e){var t=Ho(this,e).delete(e);return this.size-=t?1:0,t},xa.prototype.get=function(e){return Ho(this,e).get(e)},xa.prototype.has=function(e){return Ho(this,e).has(e)},xa.prototype.set=function(e,t){var n=Ho(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this},wa.prototype.add=wa.prototype.push=function(e){return this.__data__.set(e,u),this},wa.prototype.has=function(e){return this.__data__.has(e)},Ta.prototype.clear=function(){this.__data__=new ya,this.size=0},Ta.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ta.prototype.get=function(e){return this.__data__.get(e)},Ta.prototype.has=function(e){return this.__data__.has(e)},Ta.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ya){var a=n.__data__;if(!Jn||a.length<i-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new xa(a)}return n.set(e,t),this.size=n.size,this};var Ua=io(Ya),Na=io(Xa,!0);function Fa(e,t){var n=!0;return Ua(e,function(e,a,r){return n=!!t(e,a,r)}),n}function za(e,t,n){for(var a=-1,r=e.length;++a<r;){var i=e[a],s=t(i);if(null!=s&&(l===o?s==s&&!As(s):n(s,l)))var l=s,u=i}return u}function Va(e,t){var n=[];return Ua(e,function(e,a,r){t(e,a,r)&&n.push(e)}),n}function Wa(e,t,n,a,r){var o=-1,i=e.length;for(n||(n=qo),r||(r=[]);++o<i;){var s=e[o];t>0&&n(s)?t>1?Wa(s,t-1,n,a,r):en(r,s):a||(r[r.length]=s)}return r}var qa=so(),Ga=so(!0);function Ya(e,t){return e&&qa(e,t,rl)}function Xa(e,t){return e&&Ga(e,t,rl)}function Za(e,t){return $t(t,function(t){return Cs(e[t])})}function $a(e,t){for(var n=0,a=(t=Gr(t,e)).length;null!=e&&n<a;)e=e[ci(t[n++])];return n&&n==a?e:o}function Ka(e,t,n){var a=t(e);return ps(e)?a:en(a,n(e))}function Ja(e){return null==e?e===o?oe:J:rn&&rn in tt(e)?function(e){var t=ct.call(e,rn),n=e[rn];try{e[rn]=o;var a=!0}catch(e){}var r=ht.call(e);return a&&(t?e[rn]=n:delete e[rn]),r}(e):function(e){return ht.call(e)}(e)}function Qa(e,t){return e>t}function er(e,t){return null!=e&&ct.call(e,t)}function tr(e,t){return null!=e&&t in tt(e)}function nr(e,t,n){for(var r=n?Jt:Kt,i=e[0].length,s=e.length,l=s,u=a(s),c=1/0,d=[];l--;){var f=e[l];l&&t&&(f=Qt(f,pn(t))),c=Gn(f.length,c),u[l]=!n&&(t||i>=120&&f.length>=120)?new wa(l&&f):o}f=e[0];var h=-1,g=u[0];e:for(;++h<i&&d.length<c;){var m=f[h],v=t?t(m):m;if(m=n||0!==m?m:0,!(g?yn(g,v):r(d,v,n))){for(l=s;--l;){var p=u[l];if(!(p?yn(p,v):r(e[l],v,n)))continue e}g&&g.push(v),d.push(m)}}return d}function ar(e,t,n){var a=null==(e=ti(e,t=Gr(t,e)))?e:e[ci(ji(t))];return null==a?o:qt(a,e,n)}function rr(e){return Os(e)&&Ja(e)==F}function or(e,t,n,a,r){return e===t||(null==e||null==t||!Os(e)&&!Os(t)?e!=e&&t!=t:function(e,t,n,a,r,i){var s=ps(e),l=ps(t),u=s?z:zo(e),c=l?z:zo(t),d=(u=u==F?Q:u)==Q,f=(c=c==F?Q:c)==Q,h=u==c;if(h&&ws(e)){if(!ws(t))return!1;s=!0,d=!1}if(h&&!d)return i||(i=new Ta),s||Rs(e)?Io(e,t,n,a,r,i):function(e,t,n,a,r,o,i){switch(n){case ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case le:return!(e.byteLength!=t.byteLength||!o(new Tt(e),new Tt(t)));case W:case q:case K:return hs(+e,+t);case Y:return e.name==t.name&&e.message==t.message;case te:case ae:return e==t+"";case $:var s=En;case ne:var l=a&m;if(s||(s=In),e.size!=t.size&&!l)return!1;var u=i.get(e);if(u)return u==t;a|=v,i.set(e,t);var c=Io(s(e),s(t),a,r,o,i);return i.delete(e),c;case re:if(da)return da.call(e)==da.call(t)}return!1}(e,t,u,n,a,r,i);if(!(n&m)){var g=d&&ct.call(e,"__wrapped__"),p=f&&ct.call(t,"__wrapped__");if(g||p){var b=g?e.value():e,y=p?t.value():t;return i||(i=new Ta),r(b,y,n,a,i)}}return!!h&&(i||(i=new Ta),function(e,t,n,a,r,i){var s=n&m,l=Po(e),u=l.length,c=Po(t).length;if(u!=c&&!s)return!1;for(var d=u;d--;){var f=l[d];if(!(s?f in t:ct.call(t,f)))return!1}var h=i.get(e);if(h&&i.get(t))return h==t;var g=!0;i.set(e,t),i.set(t,e);for(var v=s;++d<u;){f=l[d];var p=e[f],b=t[f];if(a)var y=s?a(b,p,f,t,e,i):a(p,b,f,e,t,i);if(!(y===o?p===b||r(p,b,n,a,i):y)){g=!1;break}v||(v="constructor"==f)}if(g&&!v){var x=e.constructor,w=t.constructor;x!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w)&&(g=!1)}return i.delete(e),i.delete(t),g}(e,t,n,a,r,i))}(e,t,n,a,or,r))}function ir(e,t,n,a){var r=n.length,i=r,s=!a;if(null==e)return!i;for(e=tt(e);r--;){var l=n[r];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++r<i;){var u=(l=n[r])[0],c=e[u],d=l[1];if(s&&l[2]){if(c===o&&!(u in e))return!1}else{var f=new Ta;if(a)var h=a(c,d,u,e,t,f);if(!(h===o?or(d,c,m|v,a,f):h))return!1}}return!0}function sr(e){return!(!Ms(e)||(t=e,ft&&ft in t))&&(Cs(e)?vt:Ge).test(di(e));var t}function lr(e){return"function"==typeof e?e:null==e?Sl:"object"==typeof e?ps(e)?gr(e[0],e[1]):hr(e):Ul(e)}function ur(e){if(!Ko(e))return Wn(e);var t=[];for(var n in tt(e))ct.call(e,n)&&"constructor"!=n&&t.push(n);return t}function cr(e){if(!Ms(e))return function(e){var t=[];if(null!=e)for(var n in tt(e))t.push(n);return t}(e);var t=Ko(e),n=[];for(var a in e)("constructor"!=a||!t&&ct.call(e,a))&&n.push(a);return n}function dr(e,t){return e<t}function fr(e,t){var n=-1,r=ys(e)?a(e.length):[];return Ua(e,function(e,a,o){r[++n]=t(e,a,o)}),r}function hr(e){var t=Bo(e);return 1==t.length&&t[0][2]?Qo(t[0][0],t[0][1]):function(n){return n===e||ir(n,e,t)}}function gr(e,t){return Xo(e)&&Jo(t)?Qo(ci(e),t):function(n){var a=Qs(n,e);return a===o&&a===t?el(n,e):or(t,a,m|v)}}function mr(e,t,n,a,r){e!==t&&qa(t,function(i,s){if(Ms(i))r||(r=new Ta),function(e,t,n,a,r,i,s){var l=ni(e,n),u=ni(t,n),c=s.get(u);if(c)Ma(e,n,c);else{var d=i?i(l,u,n+"",e,t,s):o,f=d===o;if(f){var h=ps(u),g=!h&&ws(u),m=!h&&!g&&Rs(u);d=u,h||g||m?ps(l)?d=l:xs(l)?d=no(l):g?(f=!1,d=$r(u,!0)):m?(f=!1,d=Jr(u,!0)):d=[]:Ps(u)||vs(u)?(d=l,vs(l)?d=Ws(l):Ms(l)&&!Cs(l)||(d=Wo(u))):f=!1}f&&(s.set(u,d),r(d,u,a,i,s),s.delete(u)),Ma(e,n,d)}}(e,t,s,n,mr,a,r);else{var l=a?a(ni(e,s),i,s+"",e,t,r):o;l===o&&(l=i),Ma(e,s,l)}},ol)}function vr(e,t){var n=e.length;if(n)return Go(t+=t<0?n:0,n)?e[t]:o}function pr(e,t,n){var a=-1;return t=Qt(t.length?t:[Sl],pn(Ro())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(fr(e,function(e,n,r){return{criteria:Qt(t,function(t){return t(e)}),index:++a,value:e}}),function(e,t){return function(e,t,n){for(var a=-1,r=e.criteria,o=t.criteria,i=r.length,s=n.length;++a<i;){var l=Qr(r[a],o[a]);if(l){if(a>=s)return l;var u=n[a];return l*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)})}function br(e,t,n){for(var a=-1,r=t.length,o={};++a<r;){var i=t[a],s=$a(e,i);n(s,i)&&Er(o,Gr(i,e),s)}return o}function yr(e,t,n,a){var r=a?un:ln,o=-1,i=t.length,s=e;for(e===t&&(t=no(t)),n&&(s=Qt(e,pn(n)));++o<i;)for(var l=0,u=t[o],c=n?n(u):u;(l=r(s,c,l,a))>-1;)s!==e&&At.call(s,l,1),At.call(e,l,1);return e}function xr(e,t){for(var n=e?t.length:0,a=n-1;n--;){var r=t[n];if(n==a||r!==o){var o=r;Go(r)?At.call(e,r,1):Br(e,r)}}return e}function wr(e,t){return e+Un(Zn()*(t-e+1))}function Tr(e,t){var n="";if(!e||t<1||t>D)return n;do{t%2&&(n+=e),(t=Un(t/2))&&(e+=e)}while(t);return n}function jr(e,t){return oi(ei(e,t,Sl),e+"")}function Cr(e){return Ca(hl(e))}function _r(e,t){var n=hl(e);return li(n,Da(t,0,n.length))}function Er(e,t,n,a){if(!Ms(e))return e;for(var r=-1,i=(t=Gr(t,e)).length,s=i-1,l=e;null!=l&&++r<i;){var u=ci(t[r]),c=n;if(r!=s){var d=l[u];(c=a?a(d,u,l):o)===o&&(c=Ms(d)?d:Go(t[r+1])?[]:{})}Oa(l,u,c),l=l[u]}return e}var Mr=aa?function(e,t){return aa.set(e,t),e}:Sl,Or=hn?function(e,t){return hn(e,"toString",{configurable:!0,enumerable:!1,value:Ml(t),writable:!0})}:Sl;function Ir(e){return li(hl(e))}function Sr(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=a(o);++r<o;)i[r]=e[r+t];return i}function Pr(e,t){var n;return Ua(e,function(e,a,r){return!(n=t(e,a,r))}),!!n}function kr(e,t,n){var a=0,r=null==e?a:e.length;if("number"==typeof t&&t==t&&r<=U){for(;a<r;){var o=a+r>>>1,i=e[o];null!==i&&!As(i)&&(n?i<=t:i<t)?a=o+1:r=o}return r}return Lr(e,t,Sl,n)}function Lr(e,t,n,a){t=n(t);for(var r=0,i=null==e?0:e.length,s=t!=t,l=null===t,u=As(t),c=t===o;r<i;){var d=Un((r+i)/2),f=n(e[d]),h=f!==o,g=null===f,m=f==f,v=As(f);if(s)var p=a||m;else p=c?m&&(a||h):l?m&&h&&(a||!g):u?m&&h&&!g&&(a||!v):!g&&!v&&(a?f<=t:f<t);p?r=d+1:i=d}return Gn(i,B)}function Dr(e,t){for(var n=-1,a=e.length,r=0,o=[];++n<a;){var i=e[n],s=t?t(i):i;if(!n||!hs(s,l)){var l=s;o[r++]=0===i?0:i}}return o}function Ar(e){return"number"==typeof e?e:As(e)?R:+e}function Rr(e){if("string"==typeof e)return e;if(ps(e))return Qt(e,Rr)+"";if(As(e))return fa?fa.call(e):"";var t=e+"";return"0"==t&&1/e==-L?"-0":t}function Hr(e,t,n){var a=-1,r=Kt,o=e.length,s=!0,l=[],u=l;if(n)s=!1,r=Jt;else if(o>=i){var c=t?null:jo(e);if(c)return In(c);s=!1,r=yn,u=new wa}else u=t?[]:l;e:for(;++a<o;){var d=e[a],f=t?t(d):d;if(d=n||0!==d?d:0,s&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue e;t&&u.push(f),l.push(d)}else r(u,f,n)||(u!==l&&u.push(f),l.push(d))}return l}function Br(e,t){return null==(e=ti(e,t=Gr(t,e)))||delete e[ci(ji(t))]}function Ur(e,t,n,a){return Er(e,t,n($a(e,t)),a)}function Nr(e,t,n,a){for(var r=e.length,o=a?r:-1;(a?o--:++o<r)&&t(e[o],o,e););return n?Sr(e,a?0:o,a?o+1:r):Sr(e,a?o+1:0,a?r:o)}function Fr(e,t){var n=e;return n instanceof pa&&(n=n.value()),tn(t,function(e,t){return t.func.apply(t.thisArg,en([e],t.args))},n)}function zr(e,t,n){var r=e.length;if(r<2)return r?Hr(e[0]):[];for(var o=-1,i=a(r);++o<r;)for(var s=e[o],l=-1;++l<r;)l!=o&&(i[o]=Ba(i[o]||s,e[l],t,n));return Hr(Wa(i,1),t,n)}function Vr(e,t,n){for(var a=-1,r=e.length,i=t.length,s={};++a<r;){var l=a<i?t[a]:o;n(s,e[a],l)}return s}function Wr(e){return xs(e)?e:[]}function qr(e){return"function"==typeof e?e:Sl}function Gr(e,t){return ps(e)?e:Xo(e,t)?[e]:ui(qs(e))}var Yr=jr;function Xr(e,t,n){var a=e.length;return n=n===o?a:n,!t&&n>=a?e:Sr(e,t,n)}var Zr=An||function(e){return Lt.clearTimeout(e)};function $r(e,t){if(t)return e.slice();var n=e.length,a=Ot?Ot(n):new e.constructor(n);return e.copy(a),a}function Kr(e){var t=new e.constructor(e.byteLength);return new Tt(t).set(new Tt(e)),t}function Jr(e,t){var n=t?Kr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Qr(e,t){if(e!==t){var n=e!==o,a=null===e,r=e==e,i=As(e),s=t!==o,l=null===t,u=t==t,c=As(t);if(!l&&!c&&!i&&e>t||i&&s&&u&&!l&&!c||a&&s&&u||!n&&u||!r)return 1;if(!a&&!i&&!c&&e<t||c&&n&&r&&!a&&!i||l&&n&&r||!s&&r||!u)return-1}return 0}function eo(e,t,n,r){for(var o=-1,i=e.length,s=n.length,l=-1,u=t.length,c=qn(i-s,0),d=a(u+c),f=!r;++l<u;)d[l]=t[l];for(;++o<s;)(f||o<i)&&(d[n[o]]=e[o]);for(;c--;)d[l++]=e[o++];return d}function to(e,t,n,r){for(var o=-1,i=e.length,s=-1,l=n.length,u=-1,c=t.length,d=qn(i-l,0),f=a(d+c),h=!r;++o<d;)f[o]=e[o];for(var g=o;++u<c;)f[g+u]=t[u];for(;++s<l;)(h||o<i)&&(f[g+n[s]]=e[o++]);return f}function no(e,t){var n=-1,r=e.length;for(t||(t=a(r));++n<r;)t[n]=e[n];return t}function ao(e,t,n,a){var r=!n;n||(n={});for(var i=-1,s=t.length;++i<s;){var l=t[i],u=a?a(n[l],e[l],l,n,e):o;u===o&&(u=e[l]),r?ka(n,l,u):Oa(n,l,u)}return n}function ro(e,t){return function(n,a){var r=ps(n)?Gt:Sa,o=t?t():{};return r(n,e,Ro(a,2),o)}}function oo(e){return jr(function(t,n){var a=-1,r=n.length,i=r>1?n[r-1]:o,s=r>2?n[2]:o;for(i=e.length>3&&"function"==typeof i?(r--,i):o,s&&Yo(n[0],n[1],s)&&(i=r<3?o:i,r=1),t=tt(t);++a<r;){var l=n[a];l&&e(t,l,a,i)}return t})}function io(e,t){return function(n,a){if(null==n)return n;if(!ys(n))return e(n,a);for(var r=n.length,o=t?r:-1,i=tt(n);(t?o--:++o<r)&&!1!==a(i[o],o,i););return n}}function so(e){return function(t,n,a){for(var r=-1,o=tt(t),i=a(t),s=i.length;s--;){var l=i[e?s:++r];if(!1===n(o[l],l,o))break}return t}}function lo(e){return function(t){var n=_n(t=qs(t))?kn(t):o,a=n?n[0]:t.charAt(0),r=n?Xr(n,1).join(""):t.slice(1);return a[e]()+r}}function uo(e){return function(t){return tn(Cl(vl(t).replace(bt,"")),e,"")}}function co(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=ga(e.prototype),a=e.apply(n,t);return Ms(a)?a:n}}function fo(e){return function(t,n,a){var r=tt(t);if(!ys(t)){var i=Ro(n,3);t=rl(t),n=function(e){return i(r[e],e,r)}}var s=e(t,n,a);return s>-1?r[i?t[s]:s]:o}}function ho(e){return So(function(t){var n=t.length,a=n,r=va.prototype.thru;for(e&&t.reverse();a--;){var i=t[a];if("function"!=typeof i)throw new rt(l);if(r&&!s&&"wrapper"==Do(i))var s=new va([],!0)}for(a=s?a:n;++a<n;){var u=Do(i=t[a]),c="wrapper"==u?Lo(i):o;s=c&&Zo(c[0])&&c[1]==(C|x|T|_)&&!c[4].length&&1==c[9]?s[Do(c[0])].apply(s,c[3]):1==i.length&&Zo(i)?s[u]():s.thru(i)}return function(){var e=arguments,a=e[0];if(s&&1==e.length&&ps(a))return s.plant(a).value();for(var r=0,o=n?t[r].apply(this,e):a;++r<n;)o=t[r].call(this,o);return o}})}function go(e,t,n,r,i,s,l,u,c,d){var f=t&C,h=t&p,g=t&b,m=t&(x|w),v=t&E,y=g?o:co(e);return function p(){for(var b=arguments.length,x=a(b),w=b;w--;)x[w]=arguments[w];if(m)var T=Ao(p),j=function(e,t){for(var n=e.length,a=0;n--;)e[n]===t&&++a;return a}(x,T);if(r&&(x=eo(x,r,i,m)),s&&(x=to(x,s,l,m)),b-=j,m&&b<d){var C=On(x,T);return wo(e,t,go,p.placeholder,n,x,C,u,c,d-b)}var _=h?n:this,E=g?_[e]:e;return b=x.length,u?x=function(e,t){for(var n=e.length,a=Gn(t.length,n),r=no(e);a--;){var i=t[a];e[a]=Go(i,n)?r[i]:o}return e}(x,u):v&&b>1&&x.reverse(),f&&c<b&&(x.length=c),this&&this!==Lt&&this instanceof p&&(E=y||co(E)),E.apply(_,x)}}function mo(e,t){return function(n,a){return function(e,t,n,a){return Ya(e,function(e,r,o){t(a,n(e),r,o)}),a}(n,e,t(a),{})}}function vo(e,t){return function(n,a){var r;if(n===o&&a===o)return t;if(n!==o&&(r=n),a!==o){if(r===o)return a;"string"==typeof n||"string"==typeof a?(n=Rr(n),a=Rr(a)):(n=Ar(n),a=Ar(a)),r=e(n,a)}return r}}function po(e){return So(function(t){return t=Qt(t,pn(Ro())),jr(function(n){var a=this;return e(t,function(e){return qt(e,a,n)})})})}function bo(e,t){var n=(t=t===o?" ":Rr(t)).length;if(n<2)return n?Tr(t,e):t;var a=Tr(t,Bn(e/Pn(t)));return _n(t)?Xr(kn(a),0,e).join(""):a.slice(0,e)}function yo(e){return function(t,n,r){return r&&"number"!=typeof r&&Yo(t,n,r)&&(n=r=o),t=Ns(t),n===o?(n=t,t=0):n=Ns(n),function(e,t,n,r){for(var o=-1,i=qn(Bn((t-e)/(n||1)),0),s=a(i);i--;)s[r?i:++o]=e,e+=n;return s}(t,n,r=r===o?t<n?1:-1:Ns(r),e)}}function xo(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Vs(t),n=Vs(n)),e(t,n)}}function wo(e,t,n,a,r,i,s,l,u,c){var d=t&x;t|=d?T:j,(t&=~(d?j:T))&y||(t&=~(p|b));var f=[e,t,r,d?i:o,d?s:o,d?o:i,d?o:s,l,u,c],h=n.apply(o,f);return Zo(e)&&ai(h,f),h.placeholder=a,ii(h,e,t)}function To(e){var t=et[e];return function(e,n){if(e=Vs(e),n=null==n?0:Gn(Fs(n),292)){var a=(qs(e)+"e").split("e");return+((a=(qs(t(a[0]+"e"+(+a[1]+n)))+"e").split("e"))[0]+"e"+(+a[1]-n))}return t(e)}}var jo=ea&&1/In(new ea([,-0]))[1]==L?function(e){return new ea(e)}:Al;function Co(e){return function(t){var n=zo(t);return n==$?En(t):n==ne?Sn(t):function(e,t){return Qt(t,function(t){return[t,e[t]]})}(t,e(t))}}function _o(e,t,n,r,i,s,u,c){var f=t&b;if(!f&&"function"!=typeof e)throw new rt(l);var h=r?r.length:0;if(h||(t&=~(T|j),r=i=o),u=u===o?u:qn(Fs(u),0),c=c===o?c:Fs(c),h-=i?i.length:0,t&j){var g=r,m=i;r=i=o}var v=f?o:Lo(e),E=[e,t,n,r,i,g,m,s,u,c];if(v&&function(e,t){var n=e[1],a=t[1],r=n|a,o=r<(p|b|C),i=a==C&&n==x||a==C&&n==_&&e[7].length<=t[8]||a==(C|_)&&t[7].length<=t[8]&&n==x;if(!o&&!i)return e;a&p&&(e[2]=t[2],r|=n&p?0:y);var s=t[3];if(s){var l=e[3];e[3]=l?eo(l,s,t[4]):s,e[4]=l?On(e[3],d):t[4]}(s=t[5])&&(l=e[5],e[5]=l?to(l,s,t[6]):s,e[6]=l?On(e[5],d):t[6]),(s=t[7])&&(e[7]=s),a&C&&(e[8]=null==e[8]?t[8]:Gn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(E,v),e=E[0],t=E[1],n=E[2],r=E[3],i=E[4],!(c=E[9]=E[9]===o?f?0:e.length:qn(E[9]-h,0))&&t&(x|w)&&(t&=~(x|w)),t&&t!=p)M=t==x||t==w?function(e,t,n){var r=co(e);return function i(){for(var s=arguments.length,l=a(s),u=s,c=Ao(i);u--;)l[u]=arguments[u];var d=s<3&&l[0]!==c&&l[s-1]!==c?[]:On(l,c);return(s-=d.length)<n?wo(e,t,go,i.placeholder,o,l,d,o,o,n-s):qt(this&&this!==Lt&&this instanceof i?r:e,this,l)}}(e,t,c):t!=T&&t!=(p|T)||i.length?go.apply(o,E):function(e,t,n,r){var o=t&p,i=co(e);return function t(){for(var s=-1,l=arguments.length,u=-1,c=r.length,d=a(c+l),f=this&&this!==Lt&&this instanceof t?i:e;++u<c;)d[u]=r[u];for(;l--;)d[u++]=arguments[++s];return qt(f,o?n:this,d)}}(e,t,n,r);else var M=function(e,t,n){var a=t&p,r=co(e);return function t(){return(this&&this!==Lt&&this instanceof t?r:e).apply(a?n:this,arguments)}}(e,t,n);return ii((v?Mr:ai)(M,E),e,t)}function Eo(e,t,n,a){return e===o||hs(e,st[n])&&!ct.call(a,n)?t:e}function Mo(e,t,n,a,r,i){return Ms(e)&&Ms(t)&&(i.set(t,e),mr(e,t,o,Mo,i),i.delete(t)),e}function Oo(e){return Ps(e)?o:e}function Io(e,t,n,a,r,i){var s=n&m,l=e.length,u=t.length;if(l!=u&&!(s&&u>l))return!1;var c=i.get(e);if(c&&i.get(t))return c==t;var d=-1,f=!0,h=n&v?new wa:o;for(i.set(e,t),i.set(t,e);++d<l;){var g=e[d],p=t[d];if(a)var b=s?a(p,g,d,t,e,i):a(g,p,d,e,t,i);if(b!==o){if(b)continue;f=!1;break}if(h){if(!an(t,function(e,t){if(!yn(h,t)&&(g===e||r(g,e,n,a,i)))return h.push(t)})){f=!1;break}}else if(g!==p&&!r(g,p,n,a,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function So(e){return oi(ei(e,o,bi),e+"")}function Po(e){return Ka(e,rl,No)}function ko(e){return Ka(e,ol,Fo)}var Lo=aa?function(e){return aa.get(e)}:Al;function Do(e){for(var t=e.name+"",n=ra[t],a=ct.call(ra,t)?n.length:0;a--;){var r=n[a],o=r.func;if(null==o||o==e)return r.name}return t}function Ao(e){return(ct.call(ha,"placeholder")?ha:e).placeholder}function Ro(){var e=ha.iteratee||Pl;return e=e===Pl?lr:e,arguments.length?e(arguments[0],arguments[1]):e}function Ho(e,t){var n,a,r=e.__data__;return("string"==(a=typeof(n=t))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function Bo(e){for(var t=rl(e),n=t.length;n--;){var a=t[n],r=e[a];t[n]=[a,r,Jo(r)]}return t}function Uo(e,t){var n=function(e,t){return null==e?o:e[t]}(e,t);return sr(n)?n:o}var No=Nn?function(e){return null==e?[]:(e=tt(e),$t(Nn(e),function(t){return Dt.call(e,t)}))}:zl,Fo=Nn?function(e){for(var t=[];e;)en(t,No(e)),e=Pt(e);return t}:zl,zo=Ja;function Vo(e,t,n){for(var a=-1,r=(t=Gr(t,e)).length,o=!1;++a<r;){var i=ci(t[a]);if(!(o=null!=e&&n(e,i)))break;e=e[i]}return o||++a!=r?o:!!(r=null==e?0:e.length)&&Es(r)&&Go(i,r)&&(ps(e)||vs(e))}function Wo(e){return"function"!=typeof e.constructor||Ko(e)?{}:ga(Pt(e))}function qo(e){return ps(e)||vs(e)||!!(Ht&&e&&e[Ht])}function Go(e,t){var n=typeof e;return!!(t=null==t?D:t)&&("number"==n||"symbol"!=n&&Xe.test(e))&&e>-1&&e%1==0&&e<t}function Yo(e,t,n){if(!Ms(n))return!1;var a=typeof t;return!!("number"==a?ys(n)&&Go(t,n.length):"string"==a&&t in n)&&hs(n[t],e)}function Xo(e,t){if(ps(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!As(e))||Se.test(e)||!Ie.test(e)||null!=t&&e in tt(t)}function Zo(e){var t=Do(e),n=ha[t];if("function"!=typeof n||!(t in pa.prototype))return!1;if(e===n)return!0;var a=Lo(n);return!!a&&e===a[0]}(Kn&&zo(new Kn(new ArrayBuffer(1)))!=ue||Jn&&zo(new Jn)!=$||Qn&&"[object Promise]"!=zo(Qn.resolve())||ea&&zo(new ea)!=ne||ta&&zo(new ta)!=ie)&&(zo=function(e){var t=Ja(e),n=t==Q?e.constructor:o,a=n?di(n):"";if(a)switch(a){case oa:return ue;case ia:return $;case sa:return"[object Promise]";case la:return ne;case ua:return ie}return t});var $o=lt?Cs:Vl;function Ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)}function Jo(e){return e==e&&!Ms(e)}function Qo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==o||e in tt(n))}}function ei(e,t,n){return t=qn(t===o?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=qn(r.length-t,0),s=a(i);++o<i;)s[o]=r[t+o];o=-1;for(var l=a(t+1);++o<t;)l[o]=r[o];return l[t]=n(s),qt(e,this,l)}}function ti(e,t){return t.length<2?e:$a(e,Sr(t,0,-1))}function ni(e,t){if("__proto__"!=t)return e[t]}var ai=si(Mr),ri=Hn||function(e,t){return Lt.setTimeout(e,t)},oi=si(Or);function ii(e,t,n){var a=t+"";return oi(e,function(e,t){var n=t.length;if(!n)return e;var a=n-1;return t[a]=(n>1?"& ":"")+t[a],t=t.join(n>2?", ":" "),e.replace(He,"{\n/* [wrapped with "+t+"] */\n")}(a,function(e,t){return Yt(N,function(n){var a="_."+n[0];t&n[1]&&!Kt(e,a)&&e.push(a)}),e.sort()}(function(e){var t=e.match(Be);return t?t[1].split(Ue):[]}(a),n)))}function si(e){var t=0,n=0;return function(){var a=Yn(),r=S-(a-n);if(n=a,r>0){if(++t>=I)return arguments[0]}else t=0;return e.apply(o,arguments)}}function li(e,t){var n=-1,a=e.length,r=a-1;for(t=t===o?a:t;++n<t;){var i=wr(n,r),s=e[i];e[i]=e[n],e[n]=s}return e.length=t,e}var ui=function(e){var t=ss(e,function(e){return n.size===c&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Pe,function(e,n,a,r){t.push(a?r.replace(Fe,"$1"):n||e)}),t});function ci(e){if("string"==typeof e||As(e))return e;var t=e+"";return"0"==t&&1/e==-L?"-0":t}function di(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function fi(e){if(e instanceof pa)return e.clone();var t=new va(e.__wrapped__,e.__chain__);return t.__actions__=no(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var hi=jr(function(e,t){return xs(e)?Ba(e,Wa(t,1,xs,!0)):[]}),gi=jr(function(e,t){var n=ji(t);return xs(n)&&(n=o),xs(e)?Ba(e,Wa(t,1,xs,!0),Ro(n,2)):[]}),mi=jr(function(e,t){var n=ji(t);return xs(n)&&(n=o),xs(e)?Ba(e,Wa(t,1,xs,!0),o,n):[]});function vi(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var r=null==n?0:Fs(n);return r<0&&(r=qn(a+r,0)),sn(e,Ro(t,3),r)}function pi(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var r=a-1;return n!==o&&(r=Fs(n),r=n<0?qn(a+r,0):Gn(r,a-1)),sn(e,Ro(t,3),r,!0)}function bi(e){return null!=e&&e.length?Wa(e,1):[]}function yi(e){return e&&e.length?e[0]:o}var xi=jr(function(e){var t=Qt(e,Wr);return t.length&&t[0]===e[0]?nr(t):[]}),wi=jr(function(e){var t=ji(e),n=Qt(e,Wr);return t===ji(n)?t=o:n.pop(),n.length&&n[0]===e[0]?nr(n,Ro(t,2)):[]}),Ti=jr(function(e){var t=ji(e),n=Qt(e,Wr);return(t="function"==typeof t?t:o)&&n.pop(),n.length&&n[0]===e[0]?nr(n,o,t):[]});function ji(e){var t=null==e?0:e.length;return t?e[t-1]:o}var Ci=jr(_i);function _i(e,t){return e&&e.length&&t&&t.length?yr(e,t):e}var Ei=So(function(e,t){var n=null==e?0:e.length,a=La(e,t);return xr(e,Qt(t,function(e){return Go(e,n)?+e:e}).sort(Qr)),a});function Mi(e){return null==e?e:$n.call(e)}var Oi=jr(function(e){return Hr(Wa(e,1,xs,!0))}),Ii=jr(function(e){var t=ji(e);return xs(t)&&(t=o),Hr(Wa(e,1,xs,!0),Ro(t,2))}),Si=jr(function(e){var t=ji(e);return t="function"==typeof t?t:o,Hr(Wa(e,1,xs,!0),o,t)});function Pi(e){if(!e||!e.length)return[];var t=0;return e=$t(e,function(e){if(xs(e))return t=qn(e.length,t),!0}),vn(t,function(t){return Qt(e,fn(t))})}function ki(e,t){if(!e||!e.length)return[];var n=Pi(e);return null==t?n:Qt(n,function(e){return qt(t,o,e)})}var Li=jr(function(e,t){return xs(e)?Ba(e,t):[]}),Di=jr(function(e){return zr($t(e,xs))}),Ai=jr(function(e){var t=ji(e);return xs(t)&&(t=o),zr($t(e,xs),Ro(t,2))}),Ri=jr(function(e){var t=ji(e);return t="function"==typeof t?t:o,zr($t(e,xs),o,t)}),Hi=jr(Pi);var Bi=jr(function(e){var t=e.length,n=t>1?e[t-1]:o;return n="function"==typeof n?(e.pop(),n):o,ki(e,n)});function Ui(e){var t=ha(e);return t.__chain__=!0,t}function Ni(e,t){return t(e)}var Fi=So(function(e){var t=e.length,n=t?e[0]:0,a=this.__wrapped__,r=function(t){return La(t,e)};return!(t>1||this.__actions__.length)&&a instanceof pa&&Go(n)?((a=a.slice(n,+n+(t?1:0))).__actions__.push({func:Ni,args:[r],thisArg:o}),new va(a,this.__chain__).thru(function(e){return t&&!e.length&&e.push(o),e})):this.thru(r)});var zi=ro(function(e,t,n){ct.call(e,n)?++e[n]:ka(e,n,1)});var Vi=fo(vi),Wi=fo(pi);function qi(e,t){return(ps(e)?Yt:Ua)(e,Ro(t,3))}function Gi(e,t){return(ps(e)?Xt:Na)(e,Ro(t,3))}var Yi=ro(function(e,t,n){ct.call(e,n)?e[n].push(t):ka(e,n,[t])});var Xi=jr(function(e,t,n){var r=-1,o="function"==typeof t,i=ys(e)?a(e.length):[];return Ua(e,function(e){i[++r]=o?qt(t,e,n):ar(e,t,n)}),i}),Zi=ro(function(e,t,n){ka(e,n,t)});function $i(e,t){return(ps(e)?Qt:fr)(e,Ro(t,3))}var Ki=ro(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Ji=jr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&Yo(e,t[0],t[1])?t=[]:n>2&&Yo(t[0],t[1],t[2])&&(t=[t[0]]),pr(e,Wa(t,1),[])}),Qi=Rn||function(){return Lt.Date.now()};function es(e,t,n){return t=n?o:t,t=e&&null==t?e.length:t,_o(e,C,o,o,o,o,t)}function ts(e,t){var n;if("function"!=typeof t)throw new rt(l);return e=Fs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=o),n}}var ns=jr(function(e,t,n){var a=p;if(n.length){var r=On(n,Ao(ns));a|=T}return _o(e,a,t,n,r)}),as=jr(function(e,t,n){var a=p|b;if(n.length){var r=On(n,Ao(as));a|=T}return _o(t,a,e,n,r)});function rs(e,t,n){var a,r,i,s,u,c,d=0,f=!1,h=!1,g=!0;if("function"!=typeof e)throw new rt(l);function m(t){var n=a,i=r;return a=r=o,d=t,s=e.apply(i,n)}function v(e){var n=e-c;return c===o||n>=t||n<0||h&&e-d>=i}function p(){var e=Qi();if(v(e))return b(e);u=ri(p,function(e){var n=t-(e-c);return h?Gn(n,i-(e-d)):n}(e))}function b(e){return u=o,g&&a?m(e):(a=r=o,s)}function y(){var e=Qi(),n=v(e);if(a=arguments,r=this,c=e,n){if(u===o)return function(e){return d=e,u=ri(p,t),f?m(e):s}(c);if(h)return u=ri(p,t),m(c)}return u===o&&(u=ri(p,t)),s}return t=Vs(t)||0,Ms(n)&&(f=!!n.leading,i=(h="maxWait"in n)?qn(Vs(n.maxWait)||0,t):i,g="trailing"in n?!!n.trailing:g),y.cancel=function(){u!==o&&Zr(u),d=0,a=c=r=u=o},y.flush=function(){return u===o?s:b(Qi())},y}var os=jr(function(e,t){return Ha(e,1,t)}),is=jr(function(e,t,n){return Ha(e,Vs(t)||0,n)});function ss(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new rt(l);var n=function(){var a=arguments,r=t?t.apply(this,a):a[0],o=n.cache;if(o.has(r))return o.get(r);var i=e.apply(this,a);return n.cache=o.set(r,i)||o,i};return n.cache=new(ss.Cache||xa),n}function ls(e){if("function"!=typeof e)throw new rt(l);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ss.Cache=xa;var us=Yr(function(e,t){var n=(t=1==t.length&&ps(t[0])?Qt(t[0],pn(Ro())):Qt(Wa(t,1),pn(Ro()))).length;return jr(function(a){for(var r=-1,o=Gn(a.length,n);++r<o;)a[r]=t[r].call(this,a[r]);return qt(e,this,a)})}),cs=jr(function(e,t){var n=On(t,Ao(cs));return _o(e,T,o,t,n)}),ds=jr(function(e,t){var n=On(t,Ao(ds));return _o(e,j,o,t,n)}),fs=So(function(e,t){return _o(e,_,o,o,o,t)});function hs(e,t){return e===t||e!=e&&t!=t}var gs=xo(Qa),ms=xo(function(e,t){return e>=t}),vs=rr(function(){return arguments}())?rr:function(e){return Os(e)&&ct.call(e,"callee")&&!Dt.call(e,"callee")},ps=a.isArray,bs=Ut?pn(Ut):function(e){return Os(e)&&Ja(e)==le};function ys(e){return null!=e&&Es(e.length)&&!Cs(e)}function xs(e){return Os(e)&&ys(e)}var ws=Fn||Vl,Ts=Nt?pn(Nt):function(e){return Os(e)&&Ja(e)==q};function js(e){if(!Os(e))return!1;var t=Ja(e);return t==Y||t==G||"string"==typeof e.message&&"string"==typeof e.name&&!Ps(e)}function Cs(e){if(!Ms(e))return!1;var t=Ja(e);return t==X||t==Z||t==V||t==ee}function _s(e){return"number"==typeof e&&e==Fs(e)}function Es(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=D}function Ms(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Os(e){return null!=e&&"object"==typeof e}var Is=Ft?pn(Ft):function(e){return Os(e)&&zo(e)==$};function Ss(e){return"number"==typeof e||Os(e)&&Ja(e)==K}function Ps(e){if(!Os(e)||Ja(e)!=Q)return!1;var t=Pt(e);if(null===t)return!0;var n=ct.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ut.call(n)==gt}var ks=zt?pn(zt):function(e){return Os(e)&&Ja(e)==te};var Ls=Vt?pn(Vt):function(e){return Os(e)&&zo(e)==ne};function Ds(e){return"string"==typeof e||!ps(e)&&Os(e)&&Ja(e)==ae}function As(e){return"symbol"==typeof e||Os(e)&&Ja(e)==re}var Rs=Wt?pn(Wt):function(e){return Os(e)&&Es(e.length)&&!!Et[Ja(e)]};var Hs=xo(dr),Bs=xo(function(e,t){return e<=t});function Us(e){if(!e)return[];if(ys(e))return Ds(e)?kn(e):no(e);if(Bt&&e[Bt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Bt]());var t=zo(e);return(t==$?En:t==ne?In:hl)(e)}function Ns(e){return e?(e=Vs(e))===L||e===-L?(e<0?-1:1)*A:e==e?e:0:0===e?e:0}function Fs(e){var t=Ns(e),n=t%1;return t==t?n?t-n:t:0}function zs(e){return e?Da(Fs(e),0,H):0}function Vs(e){if("number"==typeof e)return e;if(As(e))return R;if(Ms(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ms(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(De,"");var n=qe.test(e);return n||Ye.test(e)?St(e.slice(2),n?2:8):We.test(e)?R:+e}function Ws(e){return ao(e,ol(e))}function qs(e){return null==e?"":Rr(e)}var Gs=oo(function(e,t){if(Ko(t)||ys(t))ao(t,rl(t),e);else for(var n in t)ct.call(t,n)&&Oa(e,n,t[n])}),Ys=oo(function(e,t){ao(t,ol(t),e)}),Xs=oo(function(e,t,n,a){ao(t,ol(t),e,a)}),Zs=oo(function(e,t,n,a){ao(t,rl(t),e,a)}),$s=So(La);var Ks=jr(function(e,t){e=tt(e);var n=-1,a=t.length,r=a>2?t[2]:o;for(r&&Yo(t[0],t[1],r)&&(a=1);++n<a;)for(var i=t[n],s=ol(i),l=-1,u=s.length;++l<u;){var c=s[l],d=e[c];(d===o||hs(d,st[c])&&!ct.call(e,c))&&(e[c]=i[c])}return e}),Js=jr(function(e){return e.push(o,Mo),qt(sl,o,e)});function Qs(e,t,n){var a=null==e?o:$a(e,t);return a===o?n:a}function el(e,t){return null!=e&&Vo(e,t,tr)}var tl=mo(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ht.call(t)),e[t]=n},Ml(Sl)),nl=mo(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ht.call(t)),ct.call(e,t)?e[t].push(n):e[t]=[n]},Ro),al=jr(ar);function rl(e){return ys(e)?ja(e):ur(e)}function ol(e){return ys(e)?ja(e,!0):cr(e)}var il=oo(function(e,t,n){mr(e,t,n)}),sl=oo(function(e,t,n,a){mr(e,t,n,a)}),ll=So(function(e,t){var n={};if(null==e)return n;var a=!1;t=Qt(t,function(t){return t=Gr(t,e),a||(a=t.length>1),t}),ao(e,ko(e),n),a&&(n=Aa(n,f|h|g,Oo));for(var r=t.length;r--;)Br(n,t[r]);return n});var ul=So(function(e,t){return null==e?{}:function(e,t){return br(e,t,function(t,n){return el(e,n)})}(e,t)});function cl(e,t){if(null==e)return{};var n=Qt(ko(e),function(e){return[e]});return t=Ro(t),br(e,n,function(e,n){return t(e,n[0])})}var dl=Co(rl),fl=Co(ol);function hl(e){return null==e?[]:bn(e,rl(e))}var gl=uo(function(e,t,n){return t=t.toLowerCase(),e+(n?ml(t):t)});function ml(e){return jl(qs(e).toLowerCase())}function vl(e){return(e=qs(e))&&e.replace(Ze,Tn).replace(yt,"")}var pl=uo(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),bl=uo(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),yl=lo("toLowerCase");var xl=uo(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var wl=uo(function(e,t,n){return e+(n?" ":"")+jl(t)});var Tl=uo(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),jl=lo("toUpperCase");function Cl(e,t,n){return e=qs(e),(t=n?o:t)===o?function(e){return jt.test(e)}(e)?function(e){return e.match(wt)||[]}(e):function(e){return e.match(Ne)||[]}(e):e.match(t)||[]}var _l=jr(function(e,t){try{return qt(e,o,t)}catch(e){return js(e)?e:new Je(e)}}),El=So(function(e,t){return Yt(t,function(t){t=ci(t),ka(e,t,ns(e[t],e))}),e});function Ml(e){return function(){return e}}var Ol=ho(),Il=ho(!0);function Sl(e){return e}function Pl(e){return lr("function"==typeof e?e:Aa(e,f))}var kl=jr(function(e,t){return function(n){return ar(n,e,t)}}),Ll=jr(function(e,t){return function(n){return ar(e,n,t)}});function Dl(e,t,n){var a=rl(t),r=Za(t,a);null!=n||Ms(t)&&(r.length||!a.length)||(n=t,t=e,e=this,r=Za(t,rl(t)));var o=!(Ms(n)&&"chain"in n&&!n.chain),i=Cs(e);return Yt(r,function(n){var a=t[n];e[n]=a,i&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=no(this.__actions__)).push({func:a,args:arguments,thisArg:e}),n.__chain__=t,n}return a.apply(e,en([this.value()],arguments))})}),e}function Al(){}var Rl=po(Qt),Hl=po(Zt),Bl=po(an);function Ul(e){return Xo(e)?fn(ci(e)):function(e){return function(t){return $a(t,e)}}(e)}var Nl=yo(),Fl=yo(!0);function zl(){return[]}function Vl(){return!1}var Wl=vo(function(e,t){return e+t},0),ql=To("ceil"),Gl=vo(function(e,t){return e/t},1),Yl=To("floor");var Xl,Zl=vo(function(e,t){return e*t},1),$l=To("round"),Kl=vo(function(e,t){return e-t},0);return ha.after=function(e,t){if("function"!=typeof t)throw new rt(l);return e=Fs(e),function(){if(--e<1)return t.apply(this,arguments)}},ha.ary=es,ha.assign=Gs,ha.assignIn=Ys,ha.assignInWith=Xs,ha.assignWith=Zs,ha.at=$s,ha.before=ts,ha.bind=ns,ha.bindAll=El,ha.bindKey=as,ha.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return ps(e)?e:[e]},ha.chain=Ui,ha.chunk=function(e,t,n){t=(n?Yo(e,t,n):t===o)?1:qn(Fs(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,s=0,l=a(Bn(r/t));i<r;)l[s++]=Sr(e,i,i+=t);return l},ha.compact=function(e){for(var t=-1,n=null==e?0:e.length,a=0,r=[];++t<n;){var o=e[t];o&&(r[a++]=o)}return r},ha.concat=function(){var e=arguments.length;if(!e)return[];for(var t=a(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return en(ps(n)?no(n):[n],Wa(t,1))},ha.cond=function(e){var t=null==e?0:e.length,n=Ro();return e=t?Qt(e,function(e){if("function"!=typeof e[1])throw new rt(l);return[n(e[0]),e[1]]}):[],jr(function(n){for(var a=-1;++a<t;){var r=e[a];if(qt(r[0],this,n))return qt(r[1],this,n)}})},ha.conforms=function(e){return function(e){var t=rl(e);return function(n){return Ra(n,e,t)}}(Aa(e,f))},ha.constant=Ml,ha.countBy=zi,ha.create=function(e,t){var n=ga(e);return null==t?n:Pa(n,t)},ha.curry=function e(t,n,a){var r=_o(t,x,o,o,o,o,o,n=a?o:n);return r.placeholder=e.placeholder,r},ha.curryRight=function e(t,n,a){var r=_o(t,w,o,o,o,o,o,n=a?o:n);return r.placeholder=e.placeholder,r},ha.debounce=rs,ha.defaults=Ks,ha.defaultsDeep=Js,ha.defer=os,ha.delay=is,ha.difference=hi,ha.differenceBy=gi,ha.differenceWith=mi,ha.drop=function(e,t,n){var a=null==e?0:e.length;return a?Sr(e,(t=n||t===o?1:Fs(t))<0?0:t,a):[]},ha.dropRight=function(e,t,n){var a=null==e?0:e.length;return a?Sr(e,0,(t=a-(t=n||t===o?1:Fs(t)))<0?0:t):[]},ha.dropRightWhile=function(e,t){return e&&e.length?Nr(e,Ro(t,3),!0,!0):[]},ha.dropWhile=function(e,t){return e&&e.length?Nr(e,Ro(t,3),!0):[]},ha.fill=function(e,t,n,a){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Yo(e,t,n)&&(n=0,a=r),function(e,t,n,a){var r=e.length;for((n=Fs(n))<0&&(n=-n>r?0:r+n),(a=a===o||a>r?r:Fs(a))<0&&(a+=r),a=n>a?0:zs(a);n<a;)e[n++]=t;return e}(e,t,n,a)):[]},ha.filter=function(e,t){return(ps(e)?$t:Va)(e,Ro(t,3))},ha.flatMap=function(e,t){return Wa($i(e,t),1)},ha.flatMapDeep=function(e,t){return Wa($i(e,t),L)},ha.flatMapDepth=function(e,t,n){return n=n===o?1:Fs(n),Wa($i(e,t),n)},ha.flatten=bi,ha.flattenDeep=function(e){return null!=e&&e.length?Wa(e,L):[]},ha.flattenDepth=function(e,t){return null!=e&&e.length?Wa(e,t=t===o?1:Fs(t)):[]},ha.flip=function(e){return _o(e,E)},ha.flow=Ol,ha.flowRight=Il,ha.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,a={};++t<n;){var r=e[t];a[r[0]]=r[1]}return a},ha.functions=function(e){return null==e?[]:Za(e,rl(e))},ha.functionsIn=function(e){return null==e?[]:Za(e,ol(e))},ha.groupBy=Yi,ha.initial=function(e){return null!=e&&e.length?Sr(e,0,-1):[]},ha.intersection=xi,ha.intersectionBy=wi,ha.intersectionWith=Ti,ha.invert=tl,ha.invertBy=nl,ha.invokeMap=Xi,ha.iteratee=Pl,ha.keyBy=Zi,ha.keys=rl,ha.keysIn=ol,ha.map=$i,ha.mapKeys=function(e,t){var n={};return t=Ro(t,3),Ya(e,function(e,a,r){ka(n,t(e,a,r),e)}),n},ha.mapValues=function(e,t){var n={};return t=Ro(t,3),Ya(e,function(e,a,r){ka(n,a,t(e,a,r))}),n},ha.matches=function(e){return hr(Aa(e,f))},ha.matchesProperty=function(e,t){return gr(e,Aa(t,f))},ha.memoize=ss,ha.merge=il,ha.mergeWith=sl,ha.method=kl,ha.methodOf=Ll,ha.mixin=Dl,ha.negate=ls,ha.nthArg=function(e){return e=Fs(e),jr(function(t){return vr(t,e)})},ha.omit=ll,ha.omitBy=function(e,t){return cl(e,ls(Ro(t)))},ha.once=function(e){return ts(2,e)},ha.orderBy=function(e,t,n,a){return null==e?[]:(ps(t)||(t=null==t?[]:[t]),ps(n=a?o:n)||(n=null==n?[]:[n]),pr(e,t,n))},ha.over=Rl,ha.overArgs=us,ha.overEvery=Hl,ha.overSome=Bl,ha.partial=cs,ha.partialRight=ds,ha.partition=Ki,ha.pick=ul,ha.pickBy=cl,ha.property=Ul,ha.propertyOf=function(e){return function(t){return null==e?o:$a(e,t)}},ha.pull=Ci,ha.pullAll=_i,ha.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?yr(e,t,Ro(n,2)):e},ha.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?yr(e,t,o,n):e},ha.pullAt=Ei,ha.range=Nl,ha.rangeRight=Fl,ha.rearg=fs,ha.reject=function(e,t){return(ps(e)?$t:Va)(e,ls(Ro(t,3)))},ha.remove=function(e,t){var n=[];if(!e||!e.length)return n;var a=-1,r=[],o=e.length;for(t=Ro(t,3);++a<o;){var i=e[a];t(i,a,e)&&(n.push(i),r.push(a))}return xr(e,r),n},ha.rest=function(e,t){if("function"!=typeof e)throw new rt(l);return jr(e,t=t===o?t:Fs(t))},ha.reverse=Mi,ha.sampleSize=function(e,t,n){return t=(n?Yo(e,t,n):t===o)?1:Fs(t),(ps(e)?_a:_r)(e,t)},ha.set=function(e,t,n){return null==e?e:Er(e,t,n)},ha.setWith=function(e,t,n,a){return a="function"==typeof a?a:o,null==e?e:Er(e,t,n,a)},ha.shuffle=function(e){return(ps(e)?Ea:Ir)(e)},ha.slice=function(e,t,n){var a=null==e?0:e.length;return a?(n&&"number"!=typeof n&&Yo(e,t,n)?(t=0,n=a):(t=null==t?0:Fs(t),n=n===o?a:Fs(n)),Sr(e,t,n)):[]},ha.sortBy=Ji,ha.sortedUniq=function(e){return e&&e.length?Dr(e):[]},ha.sortedUniqBy=function(e,t){return e&&e.length?Dr(e,Ro(t,2)):[]},ha.split=function(e,t,n){return n&&"number"!=typeof n&&Yo(e,t,n)&&(t=n=o),(n=n===o?H:n>>>0)?(e=qs(e))&&("string"==typeof t||null!=t&&!ks(t))&&!(t=Rr(t))&&_n(e)?Xr(kn(e),0,n):e.split(t,n):[]},ha.spread=function(e,t){if("function"!=typeof e)throw new rt(l);return t=null==t?0:qn(Fs(t),0),jr(function(n){var a=n[t],r=Xr(n,0,t);return a&&en(r,a),qt(e,this,r)})},ha.tail=function(e){var t=null==e?0:e.length;return t?Sr(e,1,t):[]},ha.take=function(e,t,n){return e&&e.length?Sr(e,0,(t=n||t===o?1:Fs(t))<0?0:t):[]},ha.takeRight=function(e,t,n){var a=null==e?0:e.length;return a?Sr(e,(t=a-(t=n||t===o?1:Fs(t)))<0?0:t,a):[]},ha.takeRightWhile=function(e,t){return e&&e.length?Nr(e,Ro(t,3),!1,!0):[]},ha.takeWhile=function(e,t){return e&&e.length?Nr(e,Ro(t,3)):[]},ha.tap=function(e,t){return t(e),e},ha.throttle=function(e,t,n){var a=!0,r=!0;if("function"!=typeof e)throw new rt(l);return Ms(n)&&(a="leading"in n?!!n.leading:a,r="trailing"in n?!!n.trailing:r),rs(e,t,{leading:a,maxWait:t,trailing:r})},ha.thru=Ni,ha.toArray=Us,ha.toPairs=dl,ha.toPairsIn=fl,ha.toPath=function(e){return ps(e)?Qt(e,ci):As(e)?[e]:no(ui(qs(e)))},ha.toPlainObject=Ws,ha.transform=function(e,t,n){var a=ps(e),r=a||ws(e)||Rs(e);if(t=Ro(t,4),null==n){var o=e&&e.constructor;n=r?a?new o:[]:Ms(e)&&Cs(o)?ga(Pt(e)):{}}return(r?Yt:Ya)(e,function(e,a,r){return t(n,e,a,r)}),n},ha.unary=function(e){return es(e,1)},ha.union=Oi,ha.unionBy=Ii,ha.unionWith=Si,ha.uniq=function(e){return e&&e.length?Hr(e):[]},ha.uniqBy=function(e,t){return e&&e.length?Hr(e,Ro(t,2)):[]},ha.uniqWith=function(e,t){return t="function"==typeof t?t:o,e&&e.length?Hr(e,o,t):[]},ha.unset=function(e,t){return null==e||Br(e,t)},ha.unzip=Pi,ha.unzipWith=ki,ha.update=function(e,t,n){return null==e?e:Ur(e,t,qr(n))},ha.updateWith=function(e,t,n,a){return a="function"==typeof a?a:o,null==e?e:Ur(e,t,qr(n),a)},ha.values=hl,ha.valuesIn=function(e){return null==e?[]:bn(e,ol(e))},ha.without=Li,ha.words=Cl,ha.wrap=function(e,t){return cs(qr(t),e)},ha.xor=Di,ha.xorBy=Ai,ha.xorWith=Ri,ha.zip=Hi,ha.zipObject=function(e,t){return Vr(e||[],t||[],Oa)},ha.zipObjectDeep=function(e,t){return Vr(e||[],t||[],Er)},ha.zipWith=Bi,ha.entries=dl,ha.entriesIn=fl,ha.extend=Ys,ha.extendWith=Xs,Dl(ha,ha),ha.add=Wl,ha.attempt=_l,ha.camelCase=gl,ha.capitalize=ml,ha.ceil=ql,ha.clamp=function(e,t,n){return n===o&&(n=t,t=o),n!==o&&(n=(n=Vs(n))==n?n:0),t!==o&&(t=(t=Vs(t))==t?t:0),Da(Vs(e),t,n)},ha.clone=function(e){return Aa(e,g)},ha.cloneDeep=function(e){return Aa(e,f|g)},ha.cloneDeepWith=function(e,t){return Aa(e,f|g,t="function"==typeof t?t:o)},ha.cloneWith=function(e,t){return Aa(e,g,t="function"==typeof t?t:o)},ha.conformsTo=function(e,t){return null==t||Ra(e,t,rl(t))},ha.deburr=vl,ha.defaultTo=function(e,t){return null==e||e!=e?t:e},ha.divide=Gl,ha.endsWith=function(e,t,n){e=qs(e),t=Rr(t);var a=e.length,r=n=n===o?a:Da(Fs(n),0,a);return(n-=t.length)>=0&&e.slice(n,r)==t},ha.eq=hs,ha.escape=function(e){return(e=qs(e))&&_e.test(e)?e.replace(je,jn):e},ha.escapeRegExp=function(e){return(e=qs(e))&&Le.test(e)?e.replace(ke,"\\$&"):e},ha.every=function(e,t,n){var a=ps(e)?Zt:Fa;return n&&Yo(e,t,n)&&(t=o),a(e,Ro(t,3))},ha.find=Vi,ha.findIndex=vi,ha.findKey=function(e,t){return on(e,Ro(t,3),Ya)},ha.findLast=Wi,ha.findLastIndex=pi,ha.findLastKey=function(e,t){return on(e,Ro(t,3),Xa)},ha.floor=Yl,ha.forEach=qi,ha.forEachRight=Gi,ha.forIn=function(e,t){return null==e?e:qa(e,Ro(t,3),ol)},ha.forInRight=function(e,t){return null==e?e:Ga(e,Ro(t,3),ol)},ha.forOwn=function(e,t){return e&&Ya(e,Ro(t,3))},ha.forOwnRight=function(e,t){return e&&Xa(e,Ro(t,3))},ha.get=Qs,ha.gt=gs,ha.gte=ms,ha.has=function(e,t){return null!=e&&Vo(e,t,er)},ha.hasIn=el,ha.head=yi,ha.identity=Sl,ha.includes=function(e,t,n,a){e=ys(e)?e:hl(e),n=n&&!a?Fs(n):0;var r=e.length;return n<0&&(n=qn(r+n,0)),Ds(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&ln(e,t,n)>-1},ha.indexOf=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var r=null==n?0:Fs(n);return r<0&&(r=qn(a+r,0)),ln(e,t,r)},ha.inRange=function(e,t,n){return t=Ns(t),n===o?(n=t,t=0):n=Ns(n),function(e,t,n){return e>=Gn(t,n)&&e<qn(t,n)}(e=Vs(e),t,n)},ha.invoke=al,ha.isArguments=vs,ha.isArray=ps,ha.isArrayBuffer=bs,ha.isArrayLike=ys,ha.isArrayLikeObject=xs,ha.isBoolean=function(e){return!0===e||!1===e||Os(e)&&Ja(e)==W},ha.isBuffer=ws,ha.isDate=Ts,ha.isElement=function(e){return Os(e)&&1===e.nodeType&&!Ps(e)},ha.isEmpty=function(e){if(null==e)return!0;if(ys(e)&&(ps(e)||"string"==typeof e||"function"==typeof e.splice||ws(e)||Rs(e)||vs(e)))return!e.length;var t=zo(e);if(t==$||t==ne)return!e.size;if(Ko(e))return!ur(e).length;for(var n in e)if(ct.call(e,n))return!1;return!0},ha.isEqual=function(e,t){return or(e,t)},ha.isEqualWith=function(e,t,n){var a=(n="function"==typeof n?n:o)?n(e,t):o;return a===o?or(e,t,o,n):!!a},ha.isError=js,ha.isFinite=function(e){return"number"==typeof e&&zn(e)},ha.isFunction=Cs,ha.isInteger=_s,ha.isLength=Es,ha.isMap=Is,ha.isMatch=function(e,t){return e===t||ir(e,t,Bo(t))},ha.isMatchWith=function(e,t,n){return n="function"==typeof n?n:o,ir(e,t,Bo(t),n)},ha.isNaN=function(e){return Ss(e)&&e!=+e},ha.isNative=function(e){if($o(e))throw new Je(s);return sr(e)},ha.isNil=function(e){return null==e},ha.isNull=function(e){return null===e},ha.isNumber=Ss,ha.isObject=Ms,ha.isObjectLike=Os,ha.isPlainObject=Ps,ha.isRegExp=ks,ha.isSafeInteger=function(e){return _s(e)&&e>=-D&&e<=D},ha.isSet=Ls,ha.isString=Ds,ha.isSymbol=As,ha.isTypedArray=Rs,ha.isUndefined=function(e){return e===o},ha.isWeakMap=function(e){return Os(e)&&zo(e)==ie},ha.isWeakSet=function(e){return Os(e)&&Ja(e)==se},ha.join=function(e,t){return null==e?"":Vn.call(e,t)},ha.kebabCase=pl,ha.last=ji,ha.lastIndexOf=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var r=a;return n!==o&&(r=(r=Fs(n))<0?qn(a+r,0):Gn(r,a-1)),t==t?function(e,t,n){for(var a=n+1;a--;)if(e[a]===t)return a;return a}(e,t,r):sn(e,cn,r,!0)},ha.lowerCase=bl,ha.lowerFirst=yl,ha.lt=Hs,ha.lte=Bs,ha.max=function(e){return e&&e.length?za(e,Sl,Qa):o},ha.maxBy=function(e,t){return e&&e.length?za(e,Ro(t,2),Qa):o},ha.mean=function(e){return dn(e,Sl)},ha.meanBy=function(e,t){return dn(e,Ro(t,2))},ha.min=function(e){return e&&e.length?za(e,Sl,dr):o},ha.minBy=function(e,t){return e&&e.length?za(e,Ro(t,2),dr):o},ha.stubArray=zl,ha.stubFalse=Vl,ha.stubObject=function(){return{}},ha.stubString=function(){return""},ha.stubTrue=function(){return!0},ha.multiply=Zl,ha.nth=function(e,t){return e&&e.length?vr(e,Fs(t)):o},ha.noConflict=function(){return Lt._===this&&(Lt._=mt),this},ha.noop=Al,ha.now=Qi,ha.pad=function(e,t,n){e=qs(e);var a=(t=Fs(t))?Pn(e):0;if(!t||a>=t)return e;var r=(t-a)/2;return bo(Un(r),n)+e+bo(Bn(r),n)},ha.padEnd=function(e,t,n){e=qs(e);var a=(t=Fs(t))?Pn(e):0;return t&&a<t?e+bo(t-a,n):e},ha.padStart=function(e,t,n){e=qs(e);var a=(t=Fs(t))?Pn(e):0;return t&&a<t?bo(t-a,n)+e:e},ha.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Xn(qs(e).replace(Ae,""),t||0)},ha.random=function(e,t,n){if(n&&"boolean"!=typeof n&&Yo(e,t,n)&&(t=n=o),n===o&&("boolean"==typeof t?(n=t,t=o):"boolean"==typeof e&&(n=e,e=o)),e===o&&t===o?(e=0,t=1):(e=Ns(e),t===o?(t=e,e=0):t=Ns(t)),e>t){var a=e;e=t,t=a}if(n||e%1||t%1){var r=Zn();return Gn(e+r*(t-e+It("1e-"+((r+"").length-1))),t)}return wr(e,t)},ha.reduce=function(e,t,n){var a=ps(e)?tn:gn,r=arguments.length<3;return a(e,Ro(t,4),n,r,Ua)},ha.reduceRight=function(e,t,n){var a=ps(e)?nn:gn,r=arguments.length<3;return a(e,Ro(t,4),n,r,Na)},ha.repeat=function(e,t,n){return t=(n?Yo(e,t,n):t===o)?1:Fs(t),Tr(qs(e),t)},ha.replace=function(){var e=arguments,t=qs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},ha.result=function(e,t,n){var a=-1,r=(t=Gr(t,e)).length;for(r||(r=1,e=o);++a<r;){var i=null==e?o:e[ci(t[a])];i===o&&(a=r,i=n),e=Cs(i)?i.call(e):i}return e},ha.round=$l,ha.runInContext=e,ha.sample=function(e){return(ps(e)?Ca:Cr)(e)},ha.size=function(e){if(null==e)return 0;if(ys(e))return Ds(e)?Pn(e):e.length;var t=zo(e);return t==$||t==ne?e.size:ur(e).length},ha.snakeCase=xl,ha.some=function(e,t,n){var a=ps(e)?an:Pr;return n&&Yo(e,t,n)&&(t=o),a(e,Ro(t,3))},ha.sortedIndex=function(e,t){return kr(e,t)},ha.sortedIndexBy=function(e,t,n){return Lr(e,t,Ro(n,2))},ha.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var a=kr(e,t);if(a<n&&hs(e[a],t))return a}return-1},ha.sortedLastIndex=function(e,t){return kr(e,t,!0)},ha.sortedLastIndexBy=function(e,t,n){return Lr(e,t,Ro(n,2),!0)},ha.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=kr(e,t,!0)-1;if(hs(e[n],t))return n}return-1},ha.startCase=wl,ha.startsWith=function(e,t,n){return e=qs(e),n=null==n?0:Da(Fs(n),0,e.length),t=Rr(t),e.slice(n,n+t.length)==t},ha.subtract=Kl,ha.sum=function(e){return e&&e.length?mn(e,Sl):0},ha.sumBy=function(e,t){return e&&e.length?mn(e,Ro(t,2)):0},ha.template=function(e,t,n){var a=ha.templateSettings;n&&Yo(e,t,n)&&(t=o),e=qs(e),t=Xs({},t,a,Eo);var r,i,s=Xs({},t.imports,a.imports,Eo),l=rl(s),u=bn(s,l),c=0,d=t.interpolate||$e,f="__p += '",h=nt((t.escape||$e).source+"|"+d.source+"|"+(d===Oe?ze:$e).source+"|"+(t.evaluate||$e).source+"|$","g"),g="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++_t+"]")+"\n";e.replace(h,function(t,n,a,o,s,l){return a||(a=o),f+=e.slice(c,l).replace(Ke,Cn),n&&(r=!0,f+="' +\n__e("+n+") +\n'"),s&&(i=!0,f+="';\n"+s+";\n__p += '"),a&&(f+="' +\n((__t = ("+a+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),f+="';\n";var m=t.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(i?f.replace(ye,""):f).replace(xe,"$1").replace(we,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=_l(function(){return Qe(l,g+"return "+f).apply(o,u)});if(v.source=f,js(v))throw v;return v},ha.times=function(e,t){if((e=Fs(e))<1||e>D)return[];var n=H,a=Gn(e,H);t=Ro(t),e-=H;for(var r=vn(a,t);++n<e;)t(n);return r},ha.toFinite=Ns,ha.toInteger=Fs,ha.toLength=zs,ha.toLower=function(e){return qs(e).toLowerCase()},ha.toNumber=Vs,ha.toSafeInteger=function(e){return e?Da(Fs(e),-D,D):0===e?e:0},ha.toString=qs,ha.toUpper=function(e){return qs(e).toUpperCase()},ha.trim=function(e,t,n){if((e=qs(e))&&(n||t===o))return e.replace(De,"");if(!e||!(t=Rr(t)))return e;var a=kn(e),r=kn(t);return Xr(a,xn(a,r),wn(a,r)+1).join("")},ha.trimEnd=function(e,t,n){if((e=qs(e))&&(n||t===o))return e.replace(Re,"");if(!e||!(t=Rr(t)))return e;var a=kn(e);return Xr(a,0,wn(a,kn(t))+1).join("")},ha.trimStart=function(e,t,n){if((e=qs(e))&&(n||t===o))return e.replace(Ae,"");if(!e||!(t=Rr(t)))return e;var a=kn(e);return Xr(a,xn(a,kn(t))).join("")},ha.truncate=function(e,t){var n=M,a=O;if(Ms(t)){var r="separator"in t?t.separator:r;n="length"in t?Fs(t.length):n,a="omission"in t?Rr(t.omission):a}var i=(e=qs(e)).length;if(_n(e)){var s=kn(e);i=s.length}if(n>=i)return e;var l=n-Pn(a);if(l<1)return a;var u=s?Xr(s,0,l).join(""):e.slice(0,l);if(r===o)return u+a;if(s&&(l+=u.length-l),ks(r)){if(e.slice(l).search(r)){var c,d=u;for(r.global||(r=nt(r.source,qs(Ve.exec(r))+"g")),r.lastIndex=0;c=r.exec(d);)var f=c.index;u=u.slice(0,f===o?l:f)}}else if(e.indexOf(Rr(r),l)!=l){var h=u.lastIndexOf(r);h>-1&&(u=u.slice(0,h))}return u+a},ha.unescape=function(e){return(e=qs(e))&&Ce.test(e)?e.replace(Te,Ln):e},ha.uniqueId=function(e){var t=++dt;return qs(e)+t},ha.upperCase=Tl,ha.upperFirst=jl,ha.each=qi,ha.eachRight=Gi,ha.first=yi,Dl(ha,(Xl={},Ya(ha,function(e,t){ct.call(ha.prototype,t)||(Xl[t]=e)}),Xl),{chain:!1}),ha.VERSION="4.17.11",Yt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){ha[e].placeholder=ha}),Yt(["drop","take"],function(e,t){pa.prototype[e]=function(n){n=n===o?1:qn(Fs(n),0);var a=this.__filtered__&&!t?new pa(this):this.clone();return a.__filtered__?a.__takeCount__=Gn(n,a.__takeCount__):a.__views__.push({size:Gn(n,H),type:e+(a.__dir__<0?"Right":"")}),a},pa.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Yt(["filter","map","takeWhile"],function(e,t){var n=t+1,a=n==P||3==n;pa.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ro(e,3),type:n}),t.__filtered__=t.__filtered__||a,t}}),Yt(["head","last"],function(e,t){var n="take"+(t?"Right":"");pa.prototype[e]=function(){return this[n](1).value()[0]}}),Yt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");pa.prototype[e]=function(){return this.__filtered__?new pa(this):this[n](1)}}),pa.prototype.compact=function(){return this.filter(Sl)},pa.prototype.find=function(e){return this.filter(e).head()},pa.prototype.findLast=function(e){return this.reverse().find(e)},pa.prototype.invokeMap=jr(function(e,t){return"function"==typeof e?new pa(this):this.map(function(n){return ar(n,e,t)})}),pa.prototype.reject=function(e){return this.filter(ls(Ro(e)))},pa.prototype.slice=function(e,t){e=Fs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new pa(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==o&&(n=(t=Fs(t))<0?n.dropRight(-t):n.take(t-e)),n)},pa.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},pa.prototype.toArray=function(){return this.take(H)},Ya(pa.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),r=ha[a?"take"+("last"==t?"Right":""):t],i=a||/^find/.test(t);r&&(ha.prototype[t]=function(){var t=this.__wrapped__,s=a?[1]:arguments,l=t instanceof pa,u=s[0],c=l||ps(t),d=function(e){var t=r.apply(ha,en([e],s));return a&&f?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var f=this.__chain__,h=!!this.__actions__.length,g=i&&!f,m=l&&!h;if(!i&&c){t=m?t:new pa(this);var v=e.apply(t,s);return v.__actions__.push({func:Ni,args:[d],thisArg:o}),new va(v,f)}return g&&m?e.apply(this,s):(v=this.thru(d),g?a?v.value()[0]:v.value():v)})}),Yt(["pop","push","shift","sort","splice","unshift"],function(e){var t=ot[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);ha.prototype[e]=function(){var e=arguments;if(a&&!this.__chain__){var r=this.value();return t.apply(ps(r)?r:[],e)}return this[n](function(n){return t.apply(ps(n)?n:[],e)})}}),Ya(pa.prototype,function(e,t){var n=ha[t];if(n){var a=n.name+"";(ra[a]||(ra[a]=[])).push({name:t,func:n})}}),ra[go(o,b).name]=[{name:"wrapper",func:o}],pa.prototype.clone=function(){var e=new pa(this.__wrapped__);return e.__actions__=no(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=no(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=no(this.__views__),e},pa.prototype.reverse=function(){if(this.__filtered__){var e=new pa(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},pa.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=ps(e),a=t<0,r=n?e.length:0,o=function(e,t,n){for(var a=-1,r=n.length;++a<r;){var o=n[a],i=o.size;switch(o.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=Gn(t,e+i);break;case"takeRight":e=qn(e,t-i)}}return{start:e,end:t}}(0,r,this.__views__),i=o.start,s=o.end,l=s-i,u=a?s:i-1,c=this.__iteratees__,d=c.length,f=0,h=Gn(l,this.__takeCount__);if(!n||!a&&r==l&&h==l)return Fr(e,this.__actions__);var g=[];e:for(;l--&&f<h;){for(var m=-1,v=e[u+=t];++m<d;){var p=c[m],b=p.iteratee,y=p.type,x=b(v);if(y==k)v=x;else if(!x){if(y==P)continue e;break e}}g[f++]=v}return g},ha.prototype.at=Fi,ha.prototype.chain=function(){return Ui(this)},ha.prototype.commit=function(){return new va(this.value(),this.__chain__)},ha.prototype.next=function(){this.__values__===o&&(this.__values__=Us(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?o:this.__values__[this.__index__++]}},ha.prototype.plant=function(e){for(var t,n=this;n instanceof ma;){var a=fi(n);a.__index__=0,a.__values__=o,t?r.__wrapped__=a:t=a;var r=a;n=n.__wrapped__}return r.__wrapped__=e,t},ha.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof pa){var t=e;return this.__actions__.length&&(t=new pa(this)),(t=t.reverse()).__actions__.push({func:Ni,args:[Mi],thisArg:o}),new va(t,this.__chain__)}return this.thru(Mi)},ha.prototype.toJSON=ha.prototype.valueOf=ha.prototype.value=function(){return Fr(this.__wrapped__,this.__actions__)},ha.prototype.first=ha.prototype.head,Bt&&(ha.prototype[Bt]=function(){return this}),ha}();Lt._=Dn,(r=function(){return Dn}.call(t,n,t,a))===o||(a.exports=r)}).call(this)}).call(this,n(5),n(9)(e))},function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.visible?n("div",{staticClass:"lightbox d-flex"},[n("div",{staticClass:"lightbox__elements flex-fill"},e._l(e.visibleImages,function(t){return n("Projection",{key:t.type_name,staticClass:"lightbox__element",class:{"lightbox__element--half-height":e.totalVisibleImages>2},attrs:{image:t}})}),1),e._v(" "),n("div",{staticClass:"lightbox__btn-wrapper position-relative"},[n("div",{staticClass:"lightbox__close",on:{click:e.hide}},[e._v("")]),e._v(" "),n("div",{staticClass:"lightbox-pictogram"},[n("ProjectionBtn",{on:{openViewer:e.openViewer}}),e._v(" "),n("PictogramBtn",{on:{openViewer:e.openViewer}})],1)])]):n("div",{staticClass:"lightbox-pictogram"},[n("PictogramBtn",{staticClass:"lightbox-pictogram__list--horizontal",on:{openViewer:e.openViewer}})],1)])};a._withStripped=!0;var r=n(3),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(e){e.stopPropagation()}}},[n("div",{staticClass:"lightbox__image"},[n("Buttons",{attrs:{"zoom-value":e.zoomValue,title:e.image.type_name},on:{reset:e.reset,invert:e.invert,rotateLeft:e.rotateLeft,rotateRight:e.rotateRight,zoomIn:e.zoomIn,zoomOut:e.zoomOut,enableDrawer:e.enableDrawer,disableDrawer:e.disableDrawer}}),e._v(" "),n("div",{ref:"image",staticClass:"lightbox__image-canvas",staticStyle:{position:"relative"},attrs:{oncontextmenu:"return false",unselectable:"on",onselectstart:"return false;",onmousedown:"return false;"}})],1)])};o._withStripped=!0;var i=n(6),s=n.n(i),l=n(1),u=n(0),c=n.n(u),d=n(7);const f=c.a.LengthTool,h=c.a.import("drawing/getNewContext"),g=c.a.import("drawing/draw"),m=c.a.import("drawing/setShadow"),v=c.a.import("drawing/drawLine"),p=c.a.import("drawing/drawHandles"),b=c.a.import("drawing/drawLinkedTextBox");class y extends f{reset(){const e=c.a.getToolState(this.element,this.name);void 0===e.data&&(e.data=[]),e.data=[]}toolSelectedCallback(e,t,n="mouse"){const a=c.a.getToolState(e.currentTarget,this.name);e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),setTimeout(()=>{a.data=a.data.filter(e=>!Object.is(t,e));const e=l.getViewport(this.element);l.setViewport(this.element,e)},100)}createNewMeasurement(e){if(!(e&&e.currentPoints&&e.currentPoints.image))return void logger.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`);const{x:t,y:n}=e.currentPoints.image;return{visible:!0,active:!0,color:void 0,handles:{start:{x:t,y:n,highlight:!0,active:!1},end:{x:t,y:n,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}renderToolData(e){const t=e.detail,{handleRadius:n,drawHandlesOnHover:a}=this.configuration,r=c.a.getToolState(e.currentTarget,this.name);if(!r)return;const o=h(t.canvasContext.canvas),{image:i,element:s}=t,l=c.a.external.cornerstone.metaData.get("imagePlaneModule",i.imageId);let u,d;l?(u=l.rowPixelSpacing||l.rowImagePixelSpacing,d=l.columnPixelSpacing||l.colImagePixelSpacing):(u=i.rowPixelSpacing,d=i.columnPixelSpacing);for(let e=0;e<r.data.length;e++){const n=r.data[e];if(!1===n.visible)return;g(o,e=>{m(e,this.configuration);const r=c.a.toolColors.getColorIfActive(n);v(e,s,n.handles.start,n.handles.end,{color:r});const o={color:r,handleRadius:4,drawHandlesIfActive:a};p(e,t,n.handles,o);const i=(n.handles.end.x-n.handles.start.x)*(d||1),l=(n.handles.end.y-n.handles.start.y)*(u||1),h=Math.sqrt(i*i+l*l);if(n.length=h,!n.handles.textBox.hasMoved){const e={x:Math.max(n.handles.start.x,n.handles.end.x)};e.x===n.handles.start.x?e.y=n.handles.start.y:e.y=n.handles.end.y,n.handles.textBox.x=e.x,n.handles.textBox.y=e.y}const g=f(n,u,d);b(e,s,n.handles.textBox,g,n.handles,y,r,2,10,!0)})}function f(e,t,n){return`${(e.length/10).toFixed(1)} mm`}function y(e){const t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}}const x=u.PanTool,w=u.ZoomMouseWheelTool,T=u.WwwcTool;let j=n(10);u.external.cornerstoneMath=d,u.external.cornerstone=l,u.external.$=$,u.external.Hammer=s.a,j.external.cornerstone=l;class C{constructor(e){this.element=e}init(e){l.enable(this.element),l.loadImage(e).then(e=>{l.displayImage(this.element,e),l.reset(this.element),u.addTool(x),u.setToolActive("Pan",{mouseButtonMask:1}),u.addTool(T),u.setToolActive("Wwwc",{mouseButtonMask:2}),u.addTool(w),u.setToolActive("ZoomMouseWheel",{mouseButtonMask:1}),u.addTool(y),this.element.addEventListener("cornerstoneimagerendered",e=>{this.callback&&this.callback({zoomValue:(100*l.getViewport(this.element).scale).toFixed(0)})})})}events(e){this.callback=e}enableDrawer(){u.setToolDisabledForElement(this.element,"Pan"),u.setToolActiveForElement(this.element,"Length",{mouseButtonMask:1})}disableDrawer(){u.setToolDisabledForElement(this.element,"Length"),u.setToolActiveForElement(this.element,"Pan",{mouseButtonMask:1}),this.updateViewport()}rotateLeft(){this.updateViewport(e=>{e.rotation-=90})}rotateRight(){this.updateViewport(e=>{e.rotation+=90})}zoomIn(){this.updateViewport(e=>{e.scale+=.1})}zoomOut(){this.updateViewport(e=>{e.scale-=.1})}updateViewport(e){const t=l.getViewport(this.element);"function"==typeof e&&e(t),l.setViewport(this.element,t)}reset(){l.reset(this.element),u.getToolForElement(this.element,"Length").reset()}invert(){this.updateViewport(e=>{e.invert=!e.invert})}destroy(){l.disable(this.element)}}var E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lightbox__image-btn-group",attrs:{role:"group"}},[n("div",{staticClass:"btn btn-sm btn-outline-success border-0"},[e._v("\n        "+e._s(e.title.toUpperCase())+"\n    ")]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success",attrs:{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:"Reset"},on:{click:e.reset}},[n("i",{staticClass:"fa fa-refresh"})]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success",attrs:{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:"Invert"},on:{click:e.invert}},[n("i",{staticClass:"fa fa-adjust"})]),e._v(" "),n("div",{staticClass:"btn btn-sm btn-outline-success ml-2"},[n("i",{staticClass:"fa fa-search"}),e._v(" "+e._s(e.zoomValue)+"%\n    ")]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success",attrs:{"data-toggle":"tooltip","data-placement":"bottom",title:"Zoom out"},on:{click:e.zoomOut}},[n("i",{staticClass:"fa fa-search-minus"})]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success",attrs:{"data-toggle":"tooltip","data-placement":"bottom",title:"Zoom in"},on:{click:e.zoomIn}},[n("i",{staticClass:"fa fa-search-plus"})]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success ml-2",attrs:{"data-toggle":"tooltip","data-placement":"bottom",title:"Turn left"},on:{click:e.rotateLeft}},[n("i",{staticClass:"fa fa-rotate-left"})]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success",attrs:{"data-toggle":"tooltip","data-placement":"bottom",title:"Turn right"},on:{click:e.rotateRight}},[n("i",{staticClass:"fa fa-rotate-right"})]),e._v(" "),n("button",{staticClass:"btn btn-sm btn-outline-success ml-2",attrs:{"data-toggle":"tooltip","data-placement":"bottom",title:"Toggle line drawer"},on:{click:e.toggleDrawer}},[e.lineDrawer?n("i",{staticClass:"fa fa-compass"}):n("i",{staticClass:"fa fa-pencil"})])])};function M(e,t,n,a,r,o,i,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),a&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),i?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=l):r&&(l=s?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}E._withStripped=!0;var O=M({props:{zoomValue:{default:0},title:String},data:()=>({lineDrawer:!1}),methods:{reset(){this.$emit("reset")},invert(){this.$emit("invert")},rotateLeft(){this.$emit("rotateLeft")},rotateRight(){this.$emit("rotateRight")},zoomIn(){this.$emit("zoomIn")},zoomOut(){this.$emit("zoomOut")},toggleDrawer(){this.lineDrawer=!this.lineDrawer,this.lineDrawer?this.$emit("enableDrawer"):this.$emit("disableDrawer")}}},E,[],!1,null,null,null);O.options.__file="src/partials/Projection/Buttons.vue";var I=O.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"lightbox-pictogram__list mx-n1"},[n("li",{staticClass:"lightbox-pictogram__item  px-1"},[n("button",{staticClass:"lightbox-pictogram__btn",attrs:{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:"All projections"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("all")}}})]),e._v(" "),n("li",{staticClass:"lightbox-pictogram__item  px-1"},[n("button",{staticClass:"lightbox-pictogram__btn",attrs:{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:"Right projections"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("right")}}})]),e._v(" "),n("li",{staticClass:"lightbox-pictogram__item  px-1"},[n("button",{staticClass:"lightbox-pictogram__btn",attrs:{type:"button","data-toggle":"tooltip","data-placement":"bottom",title:"Left projections"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("left")}}})])])};S._withStripped=!0;var P=M({methods:{openViewerItem(e){this.$emit("openViewer",e)}}},S,[],!1,null,null,null);P.options.__file="src/partials/PictogramBtn.vue";var k=P.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"lightbox-pictogram__list"},[n("li",{staticClass:"lightbox-pictogram__item"},[n("button",{staticClass:"btn btn-outline-light w-100",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("rmlo")}}},[e._v("\n            rmlo\n        ")])]),e._v(" "),n("li",{staticClass:"lightbox-pictogram__item"},[n("button",{staticClass:"btn btn-outline-light w-100",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("rcc")}}},[e._v("\n            rcc\n        ")])]),e._v(" "),n("li",{staticClass:"lightbox-pictogram__item"},[n("button",{staticClass:"btn btn-outline-light w-100",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("lmlo")}}},[e._v("\n            lmlo\n        ")])]),e._v(" "),n("li",{staticClass:"lightbox-pictogram__item"},[n("button",{staticClass:"btn btn-outline-light w-100",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.openViewerItem("lcc")}}},[e._v("\n            lcc\n        ")])])])};L._withStripped=!0;var D=M({methods:{openViewerItem(e){this.$emit("openViewer",e)}}},L,[],!1,null,null,null);D.options.__file="src/partials/ProjectionBtn.vue";var A=D.exports,R=M({components:{Buttons:I,ProjectionBtn:A,PictogramBtn:k},props:{image:Object},data:()=>({zoomValue:0}),mounted(){this.$viewerEvents.$on("view.changed",()=>{this.destroy(),this.init()}),this.init()},beforeDestroy(){this.destroy()},methods:{init(){this.$nextTick(()=>{this.$refs.image&&(this.viewer=new C(this.$refs.image),this.viewer.events(e=>{this.zoomValue=e.zoomValue}),this.viewer.init(this.image.url))})},destroy(){this.viewer&&(this.viewer.destroy(),this.viewer=null)},enableDrawer(){this.viewer.enableDrawer()},disableDrawer(){this.viewer.disableDrawer()},reset(){this.viewer.reset()},invert(){this.viewer.invert()},rotateLeft(){this.viewer.rotateLeft()},rotateRight(){this.viewer.rotateRight()},zoomIn(){this.viewer.zoomIn()},zoomOut(){this.viewer.zoomOut()}}},o,[],!1,null,null,null);R.options.__file="src/partials/Projection.vue";var H={components:{Projection:R.exports,PictogramBtn:k,ProjectionBtn:A},props:{images:Object},data:()=>({visible:!1,view:"all",callbacks:[]}),computed:{totalVisibleImages(){return Object.keys(this.visibleImages).length},visibleImages(){let e=Object.assign({rmlo:null,lmlo:null,rcc:null,lcc:null},this.images);switch(this.view){case"left":return Object(r.pick)(e,"lcc","lmlo");case"right":return Object(r.pick)(e,"rcc","rmlo")}return _.has(e,this.view)?Object(r.pick)(e,this.view):e}},methods:{openViewer(e){this.view=e,this.visible=!0,this.$viewerEvents.$emit("view.changed",e)},hide(){this.visible=!1,document.body.style.overflow="auto"}}},B=(n(11),M(H,a,[],!1,null,null,null));B.options.__file="src/Viewer.vue";t.a=B.exports},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var a;!function(r,o,i,s){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),d="function",f=Math.round,h=Math.abs,g=Date.now;function m(e,t,n){return setTimeout(T(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(p(e,n[t],n),!0)}function p(e,t,n){var a;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(a=0;a<e.length;)t.call(n,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)}function b(e,t,n){var a="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,a,n),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(a!==s&&null!==a)for(var r in a)a.hasOwnProperty(r)&&(t[r]=a[r])}return t}:Object.assign;var y=b(function(e,t,n){for(var a=Object.keys(t),r=0;r<a.length;)(!n||n&&e[a[r]]===s)&&(e[a[r]]=t[a[r]]),r++;return e},"extend","Use `assign`."),x=b(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function w(e,t,n){var a,r=t.prototype;(a=e.prototype=Object.create(r)).constructor=e,a._super=r,n&&l(a,n)}function T(e,t){return function(){return e.apply(t,arguments)}}function j(e,t){return typeof e==d?e.apply(t&&t[0]||s,t):e}function C(e,t){return e===s?t:e}function _(e,t,n){p(I(t),function(t){e.addEventListener(t,n,!1)})}function E(e,t,n){p(I(t),function(t){e.removeEventListener(t,n,!1)})}function M(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function O(e,t){return e.indexOf(t)>-1}function I(e){return e.trim().split(/\s+/g)}function S(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){for(var a=[],r=[],o=0;o<e.length;){var i=t?e[o][t]:e[o];S(r,i)<0&&a.push(e[o]),r[o]=i,o++}return n&&(a=t?a.sort(function(e,n){return e[t]>n[t]}):a.sort()),a}function L(e,t){for(var n,a,r=t[0].toUpperCase()+t.slice(1),o=0;o<u.length;){if((a=(n=u[o])?n+r:t)in e)return a;o++}return s}var D=1;function A(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var R="ontouchstart"in r,H=L(r,"PointerEvent")!==s,B=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U=25,N=1,F=2,z=4,V=8,W=1,q=2,G=4,Y=8,X=16,Z=q|G,$=Y|X,K=Z|$,J=["x","y"],Q=["clientX","clientY"];function ee(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){j(e.options.enable,[e])&&n.handler(t)},this.init()}function te(e,t,n){var a=n.pointers.length,r=n.changedPointers.length,o=t&N&&a-r==0,i=t&(z|V)&&a-r==0;n.isFirst=!!o,n.isFinal=!!i,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,a=t.pointers,r=a.length;n.firstInput||(n.firstInput=ne(t));r>1&&!n.firstMultiple?n.firstMultiple=ne(t):1===r&&(n.firstMultiple=!1);var o=n.firstInput,i=n.firstMultiple,l=i?i.center:o.center,u=t.center=ae(a);t.timeStamp=g(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=se(l,u),t.distance=ie(l,u),function(e,t){var n=t.center,a=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};t.eventType!==N&&o.eventType!==z||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},a=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-a.x),t.deltaY=r.y+(n.y-a.y)}(n,t),t.offsetDirection=oe(t.deltaX,t.deltaY);var c=re(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=h(c.x)>h(c.y)?c.x:c.y,t.scale=i?(d=i.pointers,f=a,ie(f[0],f[1],Q)/ie(d[0],d[1],Q)):1,t.rotation=i?function(e,t){return se(t[1],t[0],Q)+se(e[1],e[0],Q)}(i.pointers,a):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,a,r,o,i=e.lastInterval||t,l=t.timeStamp-i.timeStamp;if(t.eventType!=V&&(l>U||i.velocity===s)){var u=t.deltaX-i.deltaX,c=t.deltaY-i.deltaY,d=re(l,u,c);a=d.x,r=d.y,n=h(d.x)>h(d.y)?d.x:d.y,o=oe(u,c),e.lastInterval=t}else n=i.velocity,a=i.velocityX,r=i.velocityY,o=i.direction;t.velocity=n,t.velocityX=a,t.velocityY=r,t.direction=o}(n,t);var d,f;var m=e.element;M(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ne(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:f(e.pointers[n].clientX),clientY:f(e.pointers[n].clientY)},n++;return{timeStamp:g(),pointers:t,center:ae(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ae(e){var t=e.length;if(1===t)return{x:f(e[0].clientX),y:f(e[0].clientY)};for(var n=0,a=0,r=0;r<t;)n+=e[r].clientX,a+=e[r].clientY,r++;return{x:f(n/t),y:f(a/t)}}function re(e,t,n){return{x:t/e||0,y:n/e||0}}function oe(e,t){return e===t?W:h(e)>=h(t)?e<0?q:G:t<0?Y:X}function ie(e,t,n){n||(n=J);var a=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(a*a+r*r)}function se(e,t,n){n||(n=J);var a=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,a)/Math.PI}ee.prototype={handler:function(){},init:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(A(this.element),this.evWin,this.domHandler)}};var le={mousedown:N,mousemove:F,mouseup:z},ue="mousedown",ce="mousemove mouseup";function de(){this.evEl=ue,this.evWin=ce,this.pressed=!1,ee.apply(this,arguments)}w(de,ee,{handler:function(e){var t=le[e.type];t&N&&0===e.button&&(this.pressed=!0),t&F&&1!==e.which&&(t=z),this.pressed&&(t&z&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var fe={pointerdown:N,pointermove:F,pointerup:z,pointercancel:V,pointerout:V},he={2:"touch",3:"pen",4:"mouse",5:"kinect"},ge="pointerdown",me="pointermove pointerup pointercancel";function ve(){this.evEl=ge,this.evWin=me,ee.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(ge="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),w(ve,ee,{handler:function(e){var t=this.store,n=!1,a=e.type.toLowerCase().replace("ms",""),r=fe[a],o=he[e.pointerType]||e.pointerType,i="touch"==o,s=S(t,e.pointerId,"pointerId");r&N&&(0===e.button||i)?s<0&&(t.push(e),s=t.length-1):r&(z|V)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var pe={touchstart:N,touchmove:F,touchend:z,touchcancel:V},be="touchstart",ye="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=be,this.evWin=ye,this.started=!1,ee.apply(this,arguments)}w(xe,ee,{handler:function(e){var t=pe[e.type];if(t===N&&(this.started=!0),this.started){var n=function(e,t){var n=P(e.touches),a=P(e.changedTouches);t&(z|V)&&(n=k(n.concat(a),"identifier",!0));return[n,a]}.call(this,e,t);t&(z|V)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var we={touchstart:N,touchmove:F,touchend:z,touchcancel:V},Te="touchstart touchmove touchend touchcancel";function je(){this.evTarget=Te,this.targetIds={},ee.apply(this,arguments)}w(je,ee,{handler:function(e){var t=we[e.type],n=function(e,t){var n=P(e.touches),a=this.targetIds;if(t&(N|F)&&1===n.length)return a[n[0].identifier]=!0,[n,n];var r,o,i=P(e.changedTouches),s=[],l=this.target;if(o=n.filter(function(e){return M(e.target,l)}),t===N)for(r=0;r<o.length;)a[o[r].identifier]=!0,r++;r=0;for(;r<i.length;)a[i[r].identifier]&&s.push(i[r]),t&(z|V)&&delete a[i[r].identifier],r++;if(!s.length)return;return[k(o.concat(s),"identifier",!0),s]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var Ce=2500,_e=25;function Ee(){ee.apply(this,arguments);var e=T(this.handler,this);this.touch=new je(this.manager,e),this.mouse=new de(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Me(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},Ce)}}w(Ee,ee,{handler:function(e,t,n){var a="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(a)(function(e,t){e&N?(this.primaryTouch=t.changedPointers[0].identifier,Me.call(this,t)):e&(z|V)&&Me.call(this,t)}).call(this,t,n);else if(r&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var r=this.lastTouches[a],o=Math.abs(t-r.x),i=Math.abs(n-r.y);if(o<=_e&&i<=_e)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Oe=L(c.style,"touchAction"),Ie=Oe!==s,Se="auto",Pe="manipulation",ke="none",Le="pan-x",De="pan-y",Ae=function(){if(!Ie)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||r.CSS.supports("touch-action",n)}),e}();function Re(e,t){this.manager=e,this.set(t)}Re.prototype={set:function(e){"compute"==e&&(e=this.compute()),Ie&&this.manager.element.style&&Ae[e]&&(this.manager.element.style[Oe]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,function(t){j(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(O(e,ke))return ke;var t=O(e,Le),n=O(e,De);if(t&&n)return ke;if(t||n)return t?Le:De;if(O(e,Pe))return Pe;return Se}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var a=this.actions,r=O(a,ke)&&!Ae[ke],o=O(a,De)&&!Ae[De],i=O(a,Le)&&!Ae[Le];if(r){var s=1===e.pointers.length,l=e.distance<2,u=e.deltaTime<250;if(s&&l&&u)return}if(!i||!o)return r||o&&n&Z||i&&n&$?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var He=1,Be=2,Ue=4,Ne=8,Fe=Ne,ze=16;function Ve(e){this.options=l({},this.defaults,e||{}),this.id=D++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=He,this.simultaneous={},this.requireFail=[]}function We(e){return e&ze?"cancel":e&Ne?"end":e&Ue?"move":e&Be?"start":""}function qe(e){return e==X?"down":e==Y?"up":e==q?"left":e==G?"right":""}function Ge(e,t){var n=t.manager;return n?n.get(e):e}function Ye(){Ve.apply(this,arguments)}function Xe(){Ye.apply(this,arguments),this.pX=null,this.pY=null}function Ze(){Ye.apply(this,arguments)}function $e(){Ve.apply(this,arguments),this._timer=null,this._input=null}function Ke(){Ye.apply(this,arguments)}function Je(){Ye.apply(this,arguments)}function Qe(){Ve.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function et(e,t){return(t=t||{}).recognizers=C(t.recognizers,et.defaults.preset),new tt(e,t)}Ve.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ge(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)?this:(e=Ge(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===S(t,e=Ge(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Ge(e,this);var t=S(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<Ne&&a(t.options.event+We(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=Ne&&a(t.options.event+We(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|He)))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!j(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(Fe|ze|32)&&(this.state=He),this.state=this.process(t),this.state&(Be|Ue|Ne|ze)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},w(Ye,Ve,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=t&(Be|Ue),r=this.attrTest(e);return a&&(n&V||!r)?t|ze:a||r?n&z?t|Ne:t&Be?t|Ue:Be:32}}),w(Xe,Ye,{defaults:{event:"pan",threshold:10,pointers:1,direction:K},getTouchAction:function(){var e=this.options.direction,t=[];return e&Z&&t.push(De),e&$&&t.push(Le),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,r=e.direction,o=e.deltaX,i=e.deltaY;return r&t.direction||(t.direction&Z?(r=0===o?W:o<0?q:G,n=o!=this.pX,a=Math.abs(e.deltaX)):(r=0===i?W:i<0?Y:X,n=i!=this.pY,a=Math.abs(e.deltaY))),e.direction=r,n&&a>t.threshold&&r&t.direction},attrTest:function(e){return Ye.prototype.attrTest.call(this,e)&&(this.state&Be||!(this.state&Be)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=qe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),w(Ze,Ye,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Be)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),w($e,Ve,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!a||!n||e.eventType&(z|V)&&!r)this.reset();else if(e.eventType&N)this.reset(),this._timer=m(function(){this.state=Fe,this.tryEmit()},t.time,this);else if(e.eventType&z)return Fe;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Fe&&(e&&e.eventType&z?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=g(),this.manager.emit(this.options.event,this._input)))}}),w(Ke,Ye,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Be)}}),w(Je,Ye,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|$,pointers:1},getTouchAction:function(){return Xe.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(Z|$)?t=e.overallVelocity:n&Z?t=e.overallVelocityX:n&$&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&h(t)>this.options.velocity&&e.eventType&z},emit:function(e){var t=qe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),w(Qe,Ve,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&N&&0===this.count)return this.failTimeout();if(a&&r&&n){if(e.eventType!=z)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,i=!this.pCenter||ie(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,i&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=Fe,this.tryEmit()},t.interval,this),Be):Fe}return 32},failTimeout:function(){return this._timer=m(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Fe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),et.VERSION="2.0.7",et.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Ke,{enable:!1}],[Ze,{enable:!1},["rotate"]],[Je,{direction:Z}],[Xe,{direction:Z},["swipe"]],[Qe],[Qe,{event:"doubletap",taps:2},["tap"]],[$e]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function tt(e,t){var n;this.options=l({},et.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(H?ve:B?je:R?Ee:de))(n,te),this.touchAction=new Re(this,this.options.touchAction),nt(this,!0),p(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function nt(e,t){var n,a=e.element;a.style&&(p(e.options.cssProps,function(r,o){n=L(a.style,o),t?(e.oldCssProps[n]=a.style[n],a.style[n]=r):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}tt.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var a=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&Fe)&&(r=t.curRecognizer=null);for(var o=0;o<a.length;)n=a[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&n.state&(Be|Ue|Ne)&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ve)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=S(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return p(I(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==s){var n=this.handlers;return p(I(e),function(e){t?n[e]&&n[e].splice(S(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<n.length;)n[a](t),a++}},destroy:function(){this.element&&nt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(et,{INPUT_START:N,INPUT_MOVE:F,INPUT_END:z,INPUT_CANCEL:V,STATE_POSSIBLE:He,STATE_BEGAN:Be,STATE_CHANGED:Ue,STATE_ENDED:Ne,STATE_RECOGNIZED:Fe,STATE_CANCELLED:ze,STATE_FAILED:32,DIRECTION_NONE:W,DIRECTION_LEFT:q,DIRECTION_RIGHT:G,DIRECTION_UP:Y,DIRECTION_DOWN:X,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:$,DIRECTION_ALL:K,Manager:tt,Input:ee,TouchAction:Re,TouchInput:je,MouseInput:de,PointerEventInput:ve,TouchMouseInput:Ee,SingleTouchInput:xe,Recognizer:Ve,AttrRecognizer:Ye,Tap:Qe,Pan:Xe,Swipe:Je,Pinch:Ze,Rotate:Ke,Press:$e,on:_,off:E,each:p,merge:x,extend:y,assign:l,inherit:w,bindFn:T,prefixed:L}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=et,(a=function(){return et}.call(t,n,t,e))===s||(e.exports=a)}(window,document)},function(e,t,n){window,e.exports=function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e==e?0:NaN:NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i,s,l,u=n(3),c=(a=u)&&a.__esModule?a:{default:a},d=n(0),f=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};f.prototype={constructor:f,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyAxisAngle:(l=void 0,function(e,t){return void 0===l&&(l=new c.default),this.applyQuaternion(l.setFromAxisAngle(e.normalize(),t)),this}),applyMatrix3:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*a,this.y=r[1]*t+r[4]*n+r[7]*a,this.z=r[2]*t+r[5]*n+r[8]*a,this},applyMatrix4:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a+r[12],this.y=r[1]*t+r[5]*n+r[9]*a+r[13],this.z=r[2]*t+r[6]*n+r[10]*a+r[14],this},applyProjection:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*a+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*a+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*a+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*a+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,a=this.z,r=e.x,o=e.y,i=e.z,s=e.w,l=s*t+o*a-i*n,u=s*n+i*t-r*a,c=s*a+r*n-o*t,d=-r*t-o*n-i*a;return this.x=l*s+d*-r+u*-i-c*-o,this.y=u*s+d*-o+c*-r-l*-i,this.z=c*s+d*-i+l*-o-u*-r,this},transformDirection:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a,this.y=r[1]*t+r[5]*n+r[9]*a,this.z=r[2]*t+r[6]*n+r[10]*a,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:(i=void 0,s=void 0,function(e,t){return void 0===i&&(i=new f,s=new f),i.set(e,e,e),s.set(t,t,t),this.clamp(i,s)}),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,a=this.y,r=this.z;return this.x=a*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-a*e.x,this},crossVectors:function(e,t){var n=e.x,a=e.y,r=e.z,o=t.x,i=t.y,s=t.z;return this.x=a*s-r*i,this.y=r*o-n*s,this.z=n*i-a*o,this},projectOnVector:(r=void 0,o=void 0,function(e){return void 0===r&&(r=new f),r.copy(e).normalize(),o=this.dot(r),this.copy(r).multiplyScalar(o)}),projectOnPlane:function(){var e=void 0;return function(t){return void 0===e&&(e=new f),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=void 0;return function(t){return void 0===e&&(e=new f),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,d.clamp)(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),a=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=a,this},setFromMatrixColumn:function(e,t){var n=4*e,a=t.elements;return this.x=a[n],this.y=a[n+1],this.z=a[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new f(this.x,this.y,this.z)}},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);function r(e){return e*e}function o(e,t){return r(e.x-t.x)+r(e.y-t.y)}var i={distanceToPoint:function(e,t){return Math.sqrt(function(e,t){var n=o(e.start,e.end);if(0===n)return o(t,e.start);var a=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return o(t,a<0?e.start:a>1?e.end:{x:e.start.x+a*(e.end.x-e.start.x),y:e.start.y+a*(e.end.y-e.start.y)})}(e,t))},intersectLine:function(e,t){var n,r,o,i,s,l,u,c,d,f,h,g={},m=e.start.x,v=e.start.y,p=e.end.x,b=e.end.y,y=t.start.x,x=t.start.y,w=t.end.x,T=t.end.y,j=void 0;if(f=(n=b-v)*w+(o=m-p)*T+(s=p*v-m*b),(0===(d=n*y+o*x+s)||0===f||(0,a.sign)(d)!==(0,a.sign)(f))&&(c=(r=T-x)*p+(i=y-w)*b+(l=w*x-y*T),0===(u=r*m+i*v+l)||0===c||(0,a.sign)(u)!==(0,a.sign)(c))){h=n*i-r*o,j=o*l-i*s;var C=parseFloat(j/h);j=r*s-n*l;var _=parseFloat(j/h);return g.x=C,g.y=_,g}}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t,n,a){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==a?a:1};a.prototype.setFromAxisAngle=function(e,t){var n=t/2,a=Math.sin(n);return this.x=e.x*a,this.y=e.y*a,this.z=e.z*a,this.w=Math.cos(n),this},a.prototype.multiplyQuaternions=function(e,t){var n=e.x,a=e.y,r=e.z,o=e.w,i=t.x,s=t.y,l=t.z,u=t.w;return this.x=n*u+o*i+a*l-r*s,this.y=a*u+o*s+r*i-n*l,this.z=r*u+o*l+n*s-a*i,this.w=o*u-n*i-a*s-r*l,this},a.prototype.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],a=t[4],r=t[8],o=t[1],i=t[5],s=t[9],l=t[2],u=t[6],c=t[10],d=n+i+c,f=void 0;return d>0?(f=.5/Math.sqrt(d+1),this.w=.25/f,this.x=(u-s)*f,this.y=(r-l)*f,this.z=(o-a)*f):n>i&&n>c?(f=2*Math.sqrt(1+n-i-c),this.w=(u-s)/f,this.x=.25*f,this.y=(a+o)/f,this.z=(r+l)/f):i>c?(f=2*Math.sqrt(1+i-n-c),this.w=(r-l)/f,this.x=(a+o)/f,this.y=.25*f,this.z=(s+u)/f):(f=2*Math.sqrt(1+c-n-i),this.w=(o-a)/f,this.x=(r+l)/f,this.y=(s+u)/f,this.z=.25*f),this},t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(2),o=(a=r)&&a.__esModule?a:{default:a};function i(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}var s={distanceToPoint:function(e,t){var n=655535;return function(e){return[{start:{x:e.left,y:e.top},end:{x:e.left+e.width,y:e.top}},{start:{x:e.left+e.width,y:e.top},end:{x:e.left+e.width,y:e.top+e.height}},{start:{x:e.left+e.width,y:e.top+e.height},end:{x:e.left,y:e.top+e.height}},{start:{x:e.left,y:e.top+e.height},end:{x:e.left,y:e.top}}]}(e).forEach(function(e){var a=o.default.distanceToPoint(e,t);a<n&&(n=a)}),n},getIntersectionRect:function(e,t){var n={topLeft:{},bottomRight:{}};if(function(e,t){var n=void 0,a=void 0,r=i(e),o=i(t);return n=e.width>=0?t.width>=0?!(r.bottomRight.x<=o.topLeft.x||o.bottomRight.x<=r.topLeft.x):!(r.bottomRight.x<=o.bottomRight.x||o.topLeft.x<=r.topLeft.x):t.width>=0?!(r.topLeft.x<=o.topLeft.x||o.bottomRight.x<=r.bottomRight.x):!(r.topLeft.x<=o.bottomRight.x||o.topLeft.x<=r.bottomRight.x),a=e.height>=0?t.height>=0?!(r.bottomRight.y<=o.topLeft.y||o.bottomRight.y<=r.topLeft.y):!(r.bottomRight.y<=o.bottomRight.y||o.topLeft.y<=r.topLeft.y):t.height>=0?!(r.topLeft.y<=o.topLeft.y||o.bottomRight.y<=r.bottomRight.y):!(r.topLeft.y<=o.bottomRight.y||o.top<=r.bottomRight.y),n&&a}(e,t)){var a=i(e),r=i(t);return e.width>=0?t.width>=0?(n.topLeft.x=Math.max(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.bottomRight.x)):(n.topLeft.x=Math.max(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.topLeft.x)):t.width>=0?(n.topLeft.x=Math.min(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.topLeft.x)):(n.topLeft.x=Math.min(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.bottomRight.x)),e.height>=0?t.height>=0?(n.topLeft.y=Math.max(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.bottomRight.y)):(n.topLeft.y=Math.max(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.topLeft.y)):t.height>=0?(n.topLeft.y=Math.min(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.topLeft.y)):(n.topLeft.y=Math.min(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.bottomRight.y)),n}}};t.default=s},function(e,t,n){"use strict";function a(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r(e,t){return Math.sqrt(o(e,t))}function o(e,t){var n=a(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0});var i={subtract:a,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:r,distanceSquared:o,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],a=void 0;return e.forEach(function(e,o){var i=r(e,t);n.push(i),a=0===o?i:Math.min(i,a)}),e[n.indexOf(a)]}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=n(1),s=(a=i)&&a.__esModule?a:{default:a},l=function(e,t){this.normal=void 0!==e?e:new s.default(1,0,0),this.constant=void 0!==t?t:0};l.prototype={constructor:l,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,a){return this.normal.set(e,t,n),this.constant=a,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(r=new s.default,o=new s.default,function(e,t,n){var a=r.subVectors(n,t).cross(o.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new s.default).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectLine:function(){var e=new s.default;return function(t,n){var a=n||new s.default,r=t.delta(e),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(t.start)?a.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/o;return i<0||i>1?void 0:a.copy(r).multiplyScalar(i).add(t.start)}}(),intersectPlane:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new s.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new s.default,n;var a=this.constant,r=e.constant,o=this.normal.clone().dot(e.normal),i=-(a-r*o)/(1-o*o),l=-(r-a*o)/(1-o*o);return n.origin=this.normal.clone().multiplyScalar(i).add(e.normal.clone().multiplyScalar(l)),n},coplanarPoint:function(e){return(e||new s.default).copy(this.normal).multiplyScalar(-this.constant)},translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},clone:function(){return(new l).copy(this)}},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(1),o=(a=r)&&a.__esModule?a:{default:a},i=function(e,t,n,a,r,o,i,s,l,u,c,d,f,h,g,m){this.elements=new Float32Array(16);var v=this.elements;v[0]=void 0!==e?e:1,v[4]=t||0,v[8]=n||0,v[12]=a||0,v[1]=r||0,v[5]=void 0!==o?o:1,v[9]=i||0,v[13]=s||0,v[2]=l||0,v[6]=u||0,v[10]=void 0!==c?c:1,v[14]=d||0,v[3]=f||0,v[7]=h||0,v[11]=g||0,v[15]=void 0!==m?m:1};i.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,n=e.x,a=e.y,r=e.z,o=e.w,i=n+n,s=a+a,l=r+r,u=n*i,c=n*s,d=n*l,f=a*s,h=a*l,g=r*l,m=o*i,v=o*s,p=o*l;return t[0]=1-(f+g),t[4]=c-p,t[8]=d+v,t[1]=c+p,t[5]=1-(u+g),t[9]=h-m,t[2]=d-v,t[6]=h+m,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},i.prototype.multiplyMatrices=function(e,t){var n=e.elements,a=t.elements,r=this.elements,o=n[0],i=n[4],s=n[8],l=n[12],u=n[1],c=n[5],d=n[9],f=n[13],h=n[2],g=n[6],m=n[10],v=n[14],p=n[3],b=n[7],y=n[11],x=n[15],w=a[0],T=a[4],j=a[8],C=a[12],_=a[1],E=a[5],M=a[9],O=a[13],I=a[2],S=a[6],P=a[10],k=a[14],L=a[3],D=a[7],A=a[11],R=a[15];return r[0]=o*w+i*_+s*I+l*L,r[4]=o*T+i*E+s*S+l*D,r[8]=o*j+i*M+s*P+l*A,r[12]=o*C+i*O+s*k+l*R,r[1]=u*w+c*_+d*I+f*L,r[5]=u*T+c*E+d*S+f*D,r[9]=u*j+c*M+d*P+f*A,r[13]=u*C+c*O+d*k+f*R,r[2]=h*w+g*_+m*I+v*L,r[6]=h*T+g*E+m*S+v*D,r[10]=h*j+g*M+m*P+v*A,r[14]=h*C+g*O+m*k+v*R,r[3]=p*w+b*_+y*I+x*L,r[7]=p*T+b*E+y*S+x*D,r[11]=p*j+b*M+y*P+x*A,r[15]=p*C+b*O+y*k+x*R,this},i.prototype.multiply=function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},i.prototype.getInverse=function(e,t){var n=this.elements,a=e.elements,r=a[0],o=a[4],i=a[8],s=a[12],l=a[1],u=a[5],c=a[9],d=a[13],f=a[2],h=a[6],g=a[10],m=a[14],v=a[3],p=a[7],b=a[11],y=a[15];n[0]=c*m*p-d*g*p+d*h*b-u*m*b-c*h*y+u*g*y,n[4]=s*g*p-i*m*p-s*h*b+o*m*b+i*h*y-o*g*y,n[8]=i*d*p-s*c*p+s*u*b-o*d*b-i*u*y+o*c*y,n[12]=s*c*h-i*d*h-s*u*g+o*d*g+i*u*m-o*c*m,n[1]=d*g*v-c*m*v-d*f*b+l*m*b+c*f*y-l*g*y,n[5]=i*m*v-s*g*v+s*f*b-r*m*b-i*f*y+r*g*y,n[9]=s*c*v-i*d*v-s*l*b+r*d*b+i*l*y-r*c*y,n[13]=i*d*f-s*c*f+s*l*g-r*d*g-i*l*m+r*c*m,n[2]=u*m*v-d*h*v+d*f*p-l*m*p-u*f*y+l*h*y,n[6]=s*h*v-o*m*v-s*f*p+r*m*p+o*f*y-r*h*y,n[10]=o*d*v-s*u*v+s*l*p-r*d*p-o*l*y+r*u*y,n[14]=s*u*f-o*d*f-s*l*h+r*d*h+o*l*m-r*u*m,n[3]=c*h*v-u*g*v-c*f*p+l*g*p+u*f*b-l*h*b,n[7]=o*g*v-i*h*v+i*f*p-r*g*p-o*f*b+r*h*b,n[11]=i*u*v-o*c*v-i*l*p+r*c*p+o*l*b-r*u*b,n[15]=o*c*f-i*u*f+i*l*h-r*c*h-o*l*g+r*u*g;var x=r*n[0]+l*n[4]+f*n[8]+v*n[12];if(0===x){var w="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(w);return console.warn(w),this.identity(),this}return this.multiplyScalar(1/x),this},i.prototype.applyToVector3Array=function(){var e=new o.default;return function(t,n,a){void 0===n&&(n=0),void 0===a&&(a=t.length);for(var r=0,o=n;r<a;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}},i.prototype.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},i.prototype.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},i.prototype.set=function(e,t,n,a,r,o,i,s,l,u,c,d,f,h,g,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=a,v[1]=r,v[5]=o,v[9]=i,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=d,v[3]=f,v[7]=h,v[11]=g,v[15]=m,this},i.prototype.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),i=(a=o)&&a.__esModule?a:{default:a},s=n(0),l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=void 0!==t?t:new i.default,this.end=void 0!==n?n:new i.default}return r(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new i.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new i.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new i.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){var n=new i.default,a=new i.default;n.subVectors(e,this.start),a.subVectors(this.end,this.start);var r=a.dot(a),o=a.dot(n)/r;return t&&(o=(0,s.clamp)(o,0,1)),o}},{key:"closestPointToPoint",value:function(e,t,n){var a=this.closestPointToPointParameter(e,t),r=n||new i.default;return this.delta(r).multiplyScalar(a).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),a=e.start.clone().sub(this.start),r=t.clone().cross(n),o=a.clone().cross(n);if(0!==a.dot(t)){var i=o.dot(r)/r.lengthSq();if(!(i>1||isNaN(i))){var s=this.start.clone().add(t.clone().multiplyScalar(i));return s.clone().sub(e.start).lengthSq()+s.clone().sub(e.end).lengthSq()<=e.distanceSq()?s:void 0}}}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=t.rect=t.quaternion=t.point=t.Plane=t.Matrix4=t.sign=t.radToDeg=t.degToRad=t.clamp=t.lineSegment=t.Line3=void 0;var a=f(n(8)),r=f(n(2)),o=n(0),i=f(n(7)),s=f(n(6)),l=f(n(5)),u=f(n(3)),c=f(n(4)),d=f(n(1));function f(e){return e&&e.__esModule?e:{default:e}}var h={Line3:a.default,lineSegment:r.default,clamp:o.clamp,degToRad:o.degToRad,radToDeg:o.radToDeg,sign:o.sign,Matrix4:i.default,Plane:s.default,point:l.default,quaternion:u.default,rect:c.default,Vector3:d.default};t.Line3=a.default,t.lineSegment=r.default,t.clamp=o.clamp,t.degToRad=o.degToRad,t.radToDeg=o.radToDeg,t.sign=o.sign,t.Matrix4=i.default,t.Plane=s.default,t.point=l.default,t.quaternion=u.default,t.rect=c.default,t.Vector3=d.default,t.default=h}])},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"install",function(){return r});var a=n(4);function r(e){r.installed||(r.installed=!0,e.prototype.$viewerEvents=new e,e.component("DicomViewer",a.a))}const o={install:r};let i=null;"undefined"!=typeof window?i=window.Vue:void 0!==e&&(i=e.Vue),i&&i.use(o),t.default=a.a}.call(this,n(5))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){window,e.exports=function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.external=void 0;var a,r=n(4),o=(a=r)&&a.__esModule?a:{default:a},i=void 0,s={set cornerstone(e){i=e,(0,o.default)(i)},get cornerstone(){return i}};t.external=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadImage=function(e){var t=a.external.cornerstone,n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="arraybuffer",s.beforeSend(n),n.onprogress=function(n){if(n.lengthComputable){var a=n.loaded,r=n.total,o=Math.round(a/r*100),i={imageId:e,loaded:a,total:r,percentComplete:o};t.triggerEvent(t.events,"cornerstoneimageloadprogress",i)}},{promise:new Promise(function(t,a){n.onload=function(){(0,r.default)(this.response).then(function(n){var a=(0,o.default)(n,e);t(a)},a)},n.send()}),cancelFn:function(){n.abort()}}},t.configure=function(e){s=e};var a=n(0),r=i(n(3)),o=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var s={beforeSend:function(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.naturalHeight,i=e.naturalWidth;return{imageId:t,minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:128,windowWidth:255,render:a.external.cornerstone.renderWebImage,getPixelData:function(){return(n=void 0,o===t?n=r.getContext("2d"):(r.height=e.naturalHeight,r.width=e.naturalWidth,(n=r.getContext("2d")).drawImage(e,0,0),o=t),n.getImageData(0,0,e.naturalWidth,e.naturalHeight)).data;var n},getCanvas:function(){return o===t?r:(r.height=e.naturalHeight,r.width=e.naturalWidth,r.getContext("2d").drawImage(e,0,0),o=t,r)},getImage:function(){return e},rows:n,columns:i,height:n,width:i,color:!0,rgba:!1,columnPixelSpacing:void 0,rowPixelSpacing:void 0,invert:!1,sizeInBytes:n*i*4}};var a=n(0),r=document.createElement("canvas"),o=void 0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise(function(t,n){var a=new Image,r=new Uint8Array(e),o=new Blob([r]),i=window.URL||window.webkitURL,s=i.createObjectURL(o);a.src=s,a.onload=function(){t(a),i.revokeObjectURL(s)},a.onerror=function(e){i.revokeObjectURL(s),n(e)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("http",a.loadImage),e.registerImageLoader("https",a.loadImage)};var a=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.external=t.configure=t.loadImage=t.createImage=t.arrayBufferToImage=void 0;var a=s(n(3)),r=s(n(2)),o=n(1),i=n(0);function s(e){return e&&e.__esModule?e:{default:e}}var l={arrayBufferToImage:a.default,createImage:r.default,loadImage:o.loadImage,configure:o.configure,external:i.external};t.arrayBufferToImage=a.default,t.createImage=r.default,t.loadImage=o.loadImage,t.configure=o.configure,t.external=i.external,t.default=l}])},function(e,t,n){"use strict";var a=n(2);n.n(a).a},function(e,t,n){t=e.exports=n(13)(!1);var a=n(14),r=a(n(15)),o=a(n(16)),i=a(n(17));t.push([e.i,".lightbox-pictogram__list {\n  list-style: none;\n  padding: 0;\n  margin: 0 auto;\n}\n.lightbox-pictogram__list--horizontal {\n    display: flex;\n    justify-content: flex-start;\n}\n.lightbox__btn-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  width: 100px;\n}\n.lightbox__btn-wrapper .lightbox-pictogram__btn {\n    min-height: 66px;\n    min-width: 78px;\n}\n.lightbox-pictogram__btn {\n  min-height: 106px;\n  border: 1px solid #ffffff;\n  min-width: 118px;\n  background-color: #3490dc;\n  background-image: url("+r+");\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.lightbox-pictogram__btn:focus, .lightbox-pictogram__btn:hover {\n    box-shadow: 0px 0px 8px 1px #3490dc;\n    transition: .3s ease-out;\n}\n.lightbox-pictogram {\n  margin-bottom: 20px;\n  position: relative;\n}\n.lightbox-pictogram__item {\n  padding: 0;\n  margin: 10px;\n}\n.lightbox-pictogram__item:nth-of-type(2) .lightbox-pictogram__btn {\n    background-image: url("+o+");\n}\n.lightbox-pictogram__item:nth-of-type(3) .lightbox-pictogram__btn {\n    background-image: url("+i+");\n}\n.lightbox-pictogram__item button {\n    text-transform: uppercase;\n}\n.lightbox__elements {\n  flex-wrap: wrap;\n  flex-grow: 1;\n  display: flex;\n  align-items: stretch;\n  width: 100%;\n  height: 100%;\n  max-height: 100vh;\n  overflow: hidden;\n  padding-right: 0;\n}\n.lightbox__element {\n  width: 50%;\n  height: 100%;\n  display: flex;\n  flex-grow: 1;\n}\n.lightbox__element--half-height {\n  height: 50%;\n}\n.lightbox {\n  position: fixed;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.8);\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  max-height: 100vh;\n  overflow: hidden;\n}\n.lightbox__close {\n  position: absolute;\n  right: 50%;\n  margin-right: -10px;\n  transform: translateX(30%);\n  top: 15px;\n  padding: 0 10px;\n  font-size: 2.5rem;\n  cursor: pointer;\n  color: #ffffff;\n  z-index: 1000;\n  line-height: 2rem;\n}\n.lightbox__arrow--invisible {\n  visibility: hidden;\n}\n.lightbox__image {\n  border: 3px solid #ffffff;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n  background: #000000;\n  position: relative;\n  overflow: hidden;\n}\n.lightbox__image canvas {\n    margin: 0 auto;\n    object-fit: fill;\n}\n.lightbox__image-canvas {\n  flex-grow: 1;\n}\n.lightbox__image-btn-group {\n  padding: 10px 0;\n  text-align: center;\n  margin: 0 1.5rem;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  position: absolute;\n  top: 0;\n  z-index: 999;\n}\n.lightbox__arrow {\n  padding: 0 2rem;\n  cursor: pointer;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lightbox__arrow svg {\n    fill: #ffffff;\n    pointer-events: none;\n}\n@media screen and (max-width: 720px) {\n.lightbox__arrow {\n    padding: 0 1rem;\n}\n.lightbox-pictogram--absolute {\n    width: 60px;\n}\n.lightbox-pictogram__btn {\n    min-height: 76px;\n    min-width: 88px;\n}\n}\n@media screen and (max-width: 500px) {\n.lightbox__element,\n  .lightbox__btn-wrapper {\n    height: 50%;\n}\n.lightbox__arrow {\n    position: absolute;\n    padding: 0 2rem;\n    height: 100%;\n}\n.lightbox__arrow--right {\n    right: 0;\n    background: linear-gradient(to right, transparent, rgba(0, 0, 0, 0.3));\n}\n.lightbox__arrow--left {\n    left: 0;\n    background: linear-gradient(to left, transparent, rgba(0, 0, 0, 0.3));\n}\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(i=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),o=a.sources.map(function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"});return[n].concat(o).concat([r]).join("\n")}var i;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},r=0;r<this.length;r++){var o=this[r][0];null!=o&&(a[o]=!0)}for(r=0;r<e.length;r++){var i=e[r];null!=i[0]&&a[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),t.push(i))}},t}},function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t,n){e.exports=n.p+"f9d54bcb82ae2499475267891440defa.svg"},function(e,t,n){e.exports=n.p+"3ca869ddfe060f8b5d4f8ea752130eea.svg"},function(e,t,n){e.exports=n.p+"1c00f27b3af6a70f4eebe804426710e3.svg"},function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},r=0;r<t.length;r++){var o=t[r],i=o[0],s={id:e+":"+r,css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):n.push(a[i]={id:i,parts:[s]})}return n}n.r(t),n.d(t,"default",function(){return g});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},i=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,u=!1,c=function(){},d=null,f="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,t,n,r){u=n,d=r||{};var i=a(e,t);return m(i),function(t){for(var n=[],r=0;r<i.length;r++){var s=i[r];(l=o[s.id]).refs--,n.push(l)}t?m(i=a(e,t)):i=[];for(r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete o[l.id]}}}}function m(e){for(var t=0;t<e.length;t++){var n=e[t],a=o[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(p(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var i=[];for(r=0;r<n.parts.length;r++)i.push(p(n.parts[r]));o[n.id]={id:n.id,refs:1,parts:i}}}}function v(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function p(e){var t,n,a=document.querySelector("style["+f+'~="'+e.id+'"]');if(a){if(u)return c;a.parentNode.removeChild(a)}if(h){var r=l++;a=s||(s=v()),t=x.bind(null,a,r,!1),n=x.bind(null,a,r,!0)}else a=v(),t=function(e,t){var n=t.css,a=t.media,r=t.sourceMap;a&&e.setAttribute("media",a);d.ssrId&&e.setAttribute(f,t.id);r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function x(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var o=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}}]);